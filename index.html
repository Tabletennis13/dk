<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>–†–µ–π—Ç–∏–Ω–≥ —Ç–µ–Ω–Ω–∏—Å–∞</title>
    <style>
        /* –í—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
        /* –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã —Å—Ç–∞–≤–æ–∫ */

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ä–∞–∑–¥–µ–ª–∞ —Å—Ç–∞–≤–æ–∫ */
        .bets-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .bets-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            gap: 10px;
        }
        
        .bets-header h3 {
            font-size: 1.4em;
            margin: 0;
        }
        
        .bets-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        @media (min-width: 768px) {
            .bets-grid {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        .bet-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease;
        }
        
        .bet-card:hover {
            transform: translateY(-3px);
            background: rgba(255, 255, 255, 0.15);
        }
        
        .bet-match-info {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .bet-player {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }
        
        .bet-player.winner {
            background: rgba(76, 175, 80, 0.2);
            border-left: 4px solid #4CAF50;
        }
        
        .bet-player-info {
            flex: 1;
        }
        
        .bet-player-name {
            font-weight: bold;
            font-size: 1.1em;
        }
        
        .bet-player-rating {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .bet-odds {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }
        
        .odds-item {
            text-align: center;
            flex: 1;
        }
        
        .odds-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #4CAF50;
        }
        
        .odds-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .bet-form {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }
        
        .bet-amount-input {
            padding: 10px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            font-size: 1em;
            text-align: center;
        }
        
        .bet-buttons {
            display: flex;
            gap: 10px;
        }
        
        .bet-btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .bet-btn-player1 {
            background: #4CAF50;
            color: white;
        }
        
        .bet-btn-player2 {
            background: #2196F3;
            color: white;
        }
        
        .bet-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        
        .bet-status {
            margin-top: 10px;
            padding: 8px;
            border-radius: 6px;
            text-align: center;
            font-size: 0.9em;
        }
        
        .bet-status.won {
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
        }
        
        .bet-status.lost {
            background: rgba(244, 67, 54, 0.2);
            color: #f44336;
        }
        
        .bet-status.pending {
            background: rgba(255, 152, 0, 0.2);
            color: #ff9800;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ */
        .player-cabinet-container {
            padding: 20px;
            background: white;
            border-radius: 12px;
            margin: 20px 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border: 2px solid #4CAF50;
        }
        
        .cabinet-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .cabinet-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #4CAF50;
        }
        
        .cabinet-info {
            flex: 1;
        }
        
        .cabinet-name {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
        }
        
        .cabinet-rating {
            font-size: 1.2em;
            color: #4CAF50;
            font-weight: bold;
        }
        
        .cabinet-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .cabinet-stat {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9em;
            color: #666;
        }
        
        .cabinet-section {
            margin: 25px 0;
        }
        
        .cabinet-section h4 {
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #4CAF50;
            font-size: 1.2em;
        }
        
        .bet-history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .bet-history-table th {
            background: #4CAF50;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }
        
        .bet-history-table td {
            padding: 10px;
            border-bottom: 1px solid #eee;
            font-size: 0.9em;
        }
        
        .bet-history-table tr:hover {
            background: #f9f9f9;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–∞ */
        .shop-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .shop-item {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .shop-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.15);
            border-color: #4CAF50;
        }
        
        .shop-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
        }
        
        .shop-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        
        .shop-price {
            font-size: 1.2em;
            color: #4CAF50;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .shop-description {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 15px;
            min-height: 40px;
        }
        
        .buy-btn {
            padding: 10px 20px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }
        
        .buy-btn:hover {
            background: #45a049;
        }
        
        .buy-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 16px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            z-index: 1000;
            animation: slideIn 0.3s ease, fadeOut 0.3s ease 2.7s;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            max-width: calc(100vw - 40px);
            font-size: 14px;
        }
        
        .notification.success {
            background: #4CAF50;
        }
        
        .notification.error {
            background: #f44336;
        }
        
        .notification.warning {
            background: #ff9800;
        }
        
        .notification.info {
            background: #2196F3;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∞—Ç—á–µ–π */
        .match-live-badge {
            background: #f44336;
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            animation: pulse 2s infinite;
            display: inline-block;
            margin-left: 10px;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.6; }
            100% { opacity: 1; }
        }
        
        /* –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 8px;
            -webkit-text-size-adjust: 100%;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        /* ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–∏–ª–∏ ... */
        
        /* –ú–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ */
        @media (max-width: 480px) {
            .cabinet-stats {
                grid-template-columns: 1fr;
            }
            
            .shop-grid {
                grid-template-columns: 1fr;
            }
            
            .bets-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* –û—Å—Ç–∞–ª—å–Ω—ã–µ –º–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å—ã –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
    </style>
</head>
<body>
    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∏–≥—Ä–æ–∫–∞ (—Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
    <div class="container" id="playerProfileContainer" style="display: none;">
        <div class="player-profile-container">
            <div class="player-profile-header">
                <img id="playerProfileAvatar" src="" class="player-avatar-large" onerror="this.src='https://i.pravatar.cc/150?img=3'">
                <div class="player-info-large">
                    <h1 id="playerProfileName" class="player-name-large"></h1>
                    <div id="playerProfileRating" class="player-rating-large"></div>
                    <div id="playerProfileEmojis" class="achievement-emojis"></div>
                    <div id="playerProfileStats" class="player-profile-stats"></div>
                </div>
            </div>
            
            <!-- –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç —Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –≤–∞–ª—é—Ç–æ–π -->
            <div class="player-cabinet-container" id="playerCabinet">
                <div class="cabinet-header">
                    <img id="cabinetAvatar" src="" class="cabinet-avatar" onerror="this.src='https://i.pravatar.cc/150?img=3'">
                    <div class="cabinet-info">
                        <div class="cabinet-name" id="cabinetName"></div>
                        <div class="cabinet-rating">–†–µ–π—Ç–∏–Ω–≥: <span id="cabinetRating"></span></div>
                        <div>–¢–æ–∫–µ–Ω–æ–≤: <span id="cabinetTokens" style="color: #4CAF50; font-weight: bold;">0</span> ü™ô</div>
                    </div>
                </div>
                
                <div class="cabinet-stats">
                    <div class="cabinet-stat">
                        <div class="stat-value" id="cabinetBetsMade">0</div>
                        <div class="stat-label">–°–¥–µ–ª–∞–Ω–æ —Å—Ç–∞–≤–æ–∫</div>
                    </div>
                    <div class="cabinet-stat">
                        <div class="stat-value" id="cabinetBetsWon">0</div>
                        <div class="stat-label">–í—ã–∏–≥—Ä–∞–Ω–æ —Å—Ç–∞–≤–æ–∫</div>
                    </div>
                    <div class="cabinet-stat">
                        <div class="stat-value" id="cabinetTotalWon">0</div>
                        <div class="stat-label">–¢–æ–∫–µ–Ω–æ–≤ –≤—ã–∏–≥—Ä–∞–Ω–æ</div>
                    </div>
                    <div class="cabinet-stat">
                        <div class="stat-value" id="cabinetWinRate">0%</div>
                        <div class="stat-label">–ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–±–µ–¥</div>
                    </div>
                </div>
                
                <div class="cabinet-section">
                    <h4>üìä –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫</h4>
                    <div class="table-container">
                        <table class="bet-history-table" id="playerBetHistory">
                            <thead>
                                <tr>
                                    <th>–î–∞—Ç–∞</th>
                                    <th>–ú–∞—Ç—á</th>
                                    <th>–°—Ç–∞–≤–∫–∞</th>
                                    <th>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç</th>
                                    <th>–†–µ–∑—É–ª—å—Ç–∞—Ç</th>
                                    <th>–í—ã–∏–≥—Ä—ã—à</th>
                                </tr>
                            </thead>
                            <tbody id="betHistoryBody">
                                <!-- –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="cabinet-section">
                    <h4>üè™ –ú–∞–≥–∞–∑–∏–Ω –ª–∏–≥–∏</h4>
                    <div class="shop-grid" id="leagueShop">
                        <!-- –¢–æ–≤–∞—Ä—ã –º–∞–≥–∞–∑–∏–Ω–∞ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #4CAF50;">
                    <h4>üìù –ü—Ä–∞–≤–∏–ª–∞ —Å–∏—Å—Ç–µ–º—ã —Å—Ç–∞–≤–æ–∫</h4>
                    <ul style="list-style: none; padding: 0; margin: 10px 0;">
                        <li>‚Ä¢ ü™ô –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –≤–∞–ª—é—Ç–∞ "–ñ–µ—Ç–æ–Ω—ã –ª–∏–≥–∏" –Ω–µ –∏–º–µ–µ—Ç –¥–µ–Ω–µ–∂–Ω–æ–π —Ü–µ–Ω–Ω–æ—Å—Ç–∏</li>
                        <li>‚Ä¢ ‚ö†Ô∏è –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞: 50% –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –±–∞–ª–∞–Ω—Å–∞</li>
                        <li>‚Ä¢ üìà –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞–∑–Ω–∏—Ü—ã –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ</li>
                        <li>‚Ä¢ üèÜ –ó–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (–º–∞—Ç—á–∏, —Ç—É—Ä–Ω–∏—Ä—ã) –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è –±–æ–Ω—É—Å–Ω—ã–µ –∂–µ—Ç–æ–Ω—ã</li>
                        <li>‚Ä¢ üîê –°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</li>
                        <li>‚Ä¢ ‚ùó –ê–∑–∞—Ä—Ç–Ω—ã–µ –∏–≥—Ä—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–µ–Ω—å–≥–∞–º–∏ –∑–∞–ø—Ä–µ—â–µ–Ω—ã</li>
                    </ul>
                </div>
            </div>
            
            <div class="player-stats-grid">
                <div class="stat-period-box">
                    <h3>üìÖ –ó–∞ –Ω–µ–¥–µ–ª—é</h3>
                    <div id="playerWeekStats">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                </div>
                <div class="stat-period-box">
                    <h3>üìÖ –ó–∞ –º–µ—Å—è—Ü</h3>
                    <div id="playerMonthStats">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                </div>
                <div class="stat-period-box">
                    <h3>üìÖ –ó–∞ –≥–æ–¥</h3>
                    <div id="playerYearStats">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                </div>
                <div class="stat-period-box">
                    <h3>üìÖ –ó–∞ –≤—Å—ë –≤—Ä–µ–º—è</h3>
                    <div id="playerAllTimeStats">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                </div>
            </div>
            
            <div class="chart-container">
                <h3>üìà –ì—Ä–∞—Ñ–∏–∫ —Ñ–æ—Ä–º—ã (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –º–∞—Ç—á–µ–π)</h3>
                <canvas id="playerFormChart" class="chart-canvas"></canvas>
            </div>
            
            <div class="player-achievements-section">
                <h3>üèÜ –í—Å–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞</h3>
                <div id="playerAllAchievements" class="achievements-list">
                    <!-- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>
            
            <a href="#" class="back-button" onclick="returnToMain()">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ä–µ–π—Ç–∏–Ω–≥—É</a>
        </div>
    </div>
    
    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç—É—Ä–Ω–∏—Ä–∞ (—Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
    <div class="container" id="tournamentPageContainer" style="display: none;">
        <!-- ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ç—É—Ä–Ω–∏—Ä–∞ ... -->
    </div>
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–≤–∏–¥–∏–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
    <div class="container" id="appContainer">
        <!-- –®–∞–ø–∫–∞ -->
        <header>
            <h1>üèì –†–µ–π—Ç–∏–Ω–≥ –õ–õ–ù–¢</h1>
            <div class="header-subtitle">–ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –õ–∏–≥–∏ –õ—é–±–∏—Ç–µ–ª–µ–π –ù–∞—Å—Ç–æ–ª—å–Ω–æ–≥–æ –¢–µ–Ω–Ω–∏—Å–∞</div>
        </header>
        
        <!-- –í–∫–ª–∞–¥–∫–∏ -->
        <div class="tabs">
            <button class="tab-btn active" onclick="openTab('rating')">üèÜ –†–µ–π—Ç–∏–Ω–≥</button>
            <button class="tab-btn" onclick="openTab('matches')">üéÆ –ú–∞—Ç—á–∏</button>
            <button class="tab-btn" onclick="openTab('players')">üë• –ò–≥—Ä–æ–∫–∏</button>
            <button class="tab-btn" onclick="openTab('tournaments')">üèÖ –¢—É—Ä–Ω–∏—Ä—ã</button>
            <button class="tab-btn" onclick="openTab('bets')">üí∞ –°—Ç–∞–≤–∫–∏</button>
            <button class="tab-btn" onclick="openTab('stats')">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
            <button class="tab-btn" onclick="openTab('penalties')">‚ö†Ô∏è –®—Ç—Ä–∞—Ñ—ã</button>
        </div>
        
        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–æ–∫ -->
        <div class="tab-content active" id="rating">
            <h2>üèÜ –¢–µ–∫—É—â–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∏–≥—Ä–æ–∫–æ–≤</h2>
            <div class="table-container">
                <table class="compact-table">
                    <thead>
                        <tr>
                            <th>–ú–µ—Å—Ç–æ</th>
                            <th>–ò–≥—Ä–æ–∫</th>
                            <th>–û—á–∫–∏</th>
                            <th>–ú–∞—Ç—á–∏</th>
                            <th>–ü–æ–±–µ–¥</th>
                            <th>–ü–æ—Å–ª–µ–¥–Ω—è—è –∏–≥—Ä–∞</th>
                            <th>–ù–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="ratingBody"></tbody>
                </table>
            </div>
            
            <!-- –ë–õ–û–ö –î–û–°–¢–ò–ñ–ï–ù–ò–ô –ò –ü–û–û–©–†–ï–ù–ò–ô -->
            <div class="achievements-container" id="achievementsContainer">
                <div class="achievements-header">
                    <div class="level-icon">üèÜ</div>
                    <h3>–°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π</h3>
                </div>
                
                <div id="achievementsContent">
                    <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–Ω—Ç -->
                    <p>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –∏–≥—Ä–æ–∫–æ–≤...</p>
                </div>
                
                <div class="levels-info">
                    <h4>üéØ –£—Ä–æ–≤–Ω–∏ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–∞</h4>
                    <p>–ö–∞–∂–¥—ã–π –∏–≥—Ä–æ–∫ –º–æ–∂–µ—Ç –¥–æ—Å—Ç–∏—á—å —Å–ª–µ–¥—É—é—â–∏—Ö —É—Ä–æ–≤–Ω–µ–π:</p>
                    <div class="levels-list">
                        <div class="level-badge">ü•â 1100 - –ù–∞—á–∏–Ω–∞—é—â–∏–π —á–µ–º–ø–∏–æ–Ω</div>
                        <div class="level-badge">ü•à 1300 - –û–ø—ã—Ç–Ω—ã–π –±–æ–µ—Ü</div>
                        <div class="level-badge">ü•á 1500 - –ú–∞—Å—Ç–µ—Ä —Å—Ç–æ–ª–∞</div>
                        <div class="level-badge">üëë 2000 - –õ–µ–≥–µ–Ω–¥–∞ –ª–∏–≥–∏</div>
                    </div>
                    <p style="margin-top: 10px; font-size: 0.9em; opacity: 0.9;">
                        <strong>–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:</strong> –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ —Ç–µ–∫—É—â–µ–º—É —Ä–µ–π—Ç–∏–Ω–≥—É –∏–≥—Ä–æ–∫–æ–≤. 
                        –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞.
                        <br>üéÅ <strong>–ë–æ–Ω—É—Å—ã:</strong> –ó–∞ –∫–∞–∂–¥—ã–π –¥–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å –∏–≥—Ä–æ–∫ –ø–æ–ª—É—á–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ—á–∫–∏:
                        ü•â +16 –æ—á–∫–æ–≤, ü•à +20 –æ—á–∫–æ–≤, ü•á +30 –æ—á–∫–æ–≤, üëë +50 –æ—á–∫–æ–≤
                    </p>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="matches">
            <h2>üéÆ –ò—Å—Ç–æ—Ä–∏—è –º–∞—Ç—á–µ–π</h2>
            <div id="matchesContainer">
                <!-- –ú–∞—Ç—á–∏ –±—É–¥—É—Ç —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –¥–Ω—è–º –∑–¥–µ—Å—å -->
            </div>
            
            <!-- –ë–ª–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–∞—Ç—á–∞ -->
            <div class="admin-controls" id="matchesAdminControls">
                <h4>‚öôÔ∏è –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –º–∞—Ç—á–∞ (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)</h4>
                <div class="grid-2">
                    <div>
                        <div class="form-group">
                            <label>–î–∞—Ç–∞ –º–∞—Ç—á–∞:</label>
                            <input type="date" id="matchDate">
                        </div>
                        <div class="form-group">
                            <label>–ò–≥—Ä–æ–∫ 1:</label>
                            <select id="player1"></select>
                        </div>
                        <div class="form-group">
                            <label>–ò–≥—Ä–æ–∫ 2:</label>
                            <select id="player2"></select>
                        </div>
                    </div>
                    <div>
                        <div class="form-group">
                            <label>–ü–æ–±–µ–¥–∏—Ç–µ–ª—å:</label>
                            <select id="winner">
                                <option value="player1">–ò–≥—Ä–æ–∫ 1</option>
                                <option value="player2">–ò–≥—Ä–æ–∫ 2</option>
                                <option value="draw">–ù–∏—á—å—è</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>–°—á–µ—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
                            <input type="text" id="score" placeholder="3:2">
                        </div>
                        <button class="add-btn action-btn" onclick="addMatch()" style="margin-top: 20px; width: 100%;">
                            ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç—á
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="players">
            <h2>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞–º–∏</h2>
            <div class="admin-controls" id="playersAdminControls">
                <h4>‚öôÔ∏è –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞ (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)</h4>
                <div class="grid-2">
                    <div>
                        <div class="form-group">
                            <label>–ò–º—è –∏–≥—Ä–æ–∫–∞:</label>
                            <input type="text" id="newPlayerName" placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω">
                        </div>
                        <div class="form-group">
                            <label>–õ–æ–≥–∏–Ω –¥–ª—è –∫–∞–±–∏–Ω–µ—Ç–∞:</label>
                            <input type="text" id="newPlayerLogin" placeholder="ivanov">
                        </div>
                        <div class="form-group">
                            <label>–ü–∞—Ä–æ–ª—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
                            <input type="password" id="newPlayerPassword" placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏">
                        </div>
                        <div class="form-group">
                            <label>–°—Å—ã–ª–∫–∞ –Ω–∞ –∞–≤–∞—Ç–∞—Ä (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
                            <input type="text" id="newPlayerAvatar" placeholder="https://example.com/avatar.jpg">
                        </div>
                        <div class="form-group">
                            <label>–ù–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥:</label>
                            <input type="number" id="newPlayerRating" value="1000">
                        </div>
                        <div class="form-group">
                            <label>–ù–∞—á–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∂–µ—Ç–æ–Ω–æ–≤:</label>
                            <input type="number" id="newPlayerTokens" value="100">
                        </div>
                        <button class="add-btn action-btn" onclick="addPlayer()" style="width: 100%;">
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞
                        </button>
                    </div>
                    <div>
                        <p><strong>–°–æ–≤–µ—Ç—ã:</strong></p>
                        <ul style="list-style: none; padding: 0;">
                            <li>‚Ä¢ –î–ª—è –∞–≤–∞—Ç–∞—Ä–æ–≤ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å <a href="https://pravatar.cc" target="_blank">pravatar.cc</a></li>
                            <li>‚Ä¢ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥: 1000</li>
                            <li>‚Ä¢ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∂–µ—Ç–æ–Ω–æ–≤: 100</li>
                            <li>‚Ä¢ –õ–æ–≥–∏–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º</li>
                            <li>‚Ä¢ –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∏–≥—Ä–æ–∫–∞ –µ–≥–æ –∫–∞–±–∏–Ω–µ—Ç —Ç–∞–∫–∂–µ —É–¥–∞–ª–∏—Ç—Å—è</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>–ê–≤–∞—Ç–∞—Ä</th>
                            <th>–ò–º—è</th>
                            <th>–†–µ–π—Ç–∏–Ω–≥</th>
                            <th>–ú–∞—Ç—á–∏</th>
                            <th>–ü–æ–±–µ–¥</th>
                            <th>–ñ–µ—Ç–æ–Ω—ã</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="playersBody"></tbody>
                </table>
            </div>
        </div>
        
        <div class="tab-content" id="tournaments">
            <h2>üèÖ –¢—É—Ä–Ω–∏—Ä—ã</h2>
            
            <!-- –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç—É—Ä–Ω–∏—Ä–æ–≤ -->
            <div class="tournament-generator" id="tournamentGenerator">
                <div class="generator-header" onclick="toggleTournamentGenerator()">
                    <span>üé≤ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç—É—Ä–Ω–∏—Ä–æ–≤</span>
                    <span class="toggle-icon">‚ñº</span>
                </div>
                
                <div class="generator-grid">
                    <div class="generator-section">
                        <h4>üìù –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç—É—Ä–Ω–∏—Ä–µ</h4>
                        <div class="form-group">
                            <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞:</label>
                            <input type="text" id="tournamentName" placeholder="–í–µ—Å–µ–Ω–Ω–∏–π –∫—É–±–æ–∫ 2024">
                        </div>
                        <div class="form-group">
                            <label>–¢–∏–ø —Ç—É—Ä–Ω–∏—Ä–Ω–æ–π —Å–µ—Ç–∫–∏:</label>
                            <select id="tournamentType">
                                <option value="round_robin_3">–ö—Ä—É–≥–æ–≤–æ–π —Ç—É—Ä–Ω–∏—Ä (3 –∏–≥—Ä–æ–∫–∞)</option>
                                <option value="round_robin_4">–ö—Ä—É–≥–æ–≤–æ–π —Ç—É—Ä–Ω–∏—Ä (4 –∏–≥—Ä–æ–∫–∞)</option>
                                <option value="round_robin_5">–ö—Ä—É–≥–æ–≤–æ–π —Ç—É—Ä–Ω–∏—Ä (5 –∏–≥—Ä–æ–∫–æ–≤)</option>
                                <option value="round_robin_5_bo3">–ö—Ä—É–≥–æ–≤–æ–π —Ç—É—Ä–Ω–∏—Ä (5 –∏–≥—Ä–æ–∫–æ–≤, –¥–æ 3 –ø–∞—Ä—Ç–∏–π)</option>
                                <option value="round_robin_6">–ö—Ä—É–≥–æ–≤–æ–π —Ç—É—Ä–Ω–∏—Ä (6 –∏–≥—Ä–æ–∫–æ–≤)</option>
                                <option value="single_elimination_4">–û–ª–∏–º–ø–∏–π—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ (4 –∏–≥—Ä–æ–∫–∞)</option>
                                <option value="single_elimination_8">–û–ª–∏–º–ø–∏–π—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ (8 –∏–≥—Ä–æ–∫–∞)</option>
                                <option value="double_elimination_4">–î–≤–æ–π–Ω–∞—è —ç–ª–∏–º–∏–Ω–∞—Ü–∏—è (4 –∏–≥—Ä–æ–∫–∞)</option>
                                <option value="pairs_round_robin_3">–ü–∞—Ä–Ω—ã–π —Ç—É—Ä–Ω–∏—Ä (3 –ø–∞—Ä—ã)</option>
                                <option value="pairs_round_robin_4">–ü–∞—Ä–Ω—ã–π —Ç—É—Ä–Ω–∏—Ä (4 –ø–∞—Ä—ã)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="generator-section">
                        <h4>üë• –í—ã–±–æ—Ä —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</h4>
                        <div class="player-checkbox-list" id="tournamentPlayersList">
                            <!-- –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ —Å —á–µ–∫–±–æ–∫—Å–∞–º–∏ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                        <div style="margin-top: 10px; font-size: 0.9em; color: #666;">
                            –í—ã–±—Ä–∞–Ω–æ: <span id="selectedPlayersCount">0</span> –∏–≥—Ä–æ–∫–æ–≤
                        </div>
                    </div>
                </div>
                
                <button class="generate-btn" onclick="generateTournament()">
                    üèÜ –°–æ–∑–¥–∞—Ç—å —Ç—É—Ä–Ω–∏—Ä
                </button>
            </div>
            
            <!-- –°–ø–∏—Å–æ–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç—É—Ä–Ω–∏—Ä–æ–≤ -->
            <h3>üìã –°–ø–∏—Å–æ–∫ —Ç—É—Ä–Ω–∏—Ä–æ–≤</h3>
            <div class="tournament-grid" id="tournamentsList">
                <!-- –¢—É—Ä–Ω–∏—Ä—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>
        
        <!-- –ù–û–í–ê–Ø –í–ö–õ–ê–î–ö–ê: –°–¢–ê–í–ö–ò -->
        <div class="tab-content" id="bets">
            <h2>üí∞ –í–Ω—É—Ç—Ä–∏–∏–≥—Ä–æ–≤—ã–µ —Å—Ç–∞–≤–∫–∏ —Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –≤–∞–ª—é—Ç–æ–π</h2>
            
            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ -->
            <div class="player-cabinet-container" id="currentPlayerCabinet" style="display: none;">
                <div class="cabinet-header">
                    <img id="currentCabinetAvatar" src="" class="cabinet-avatar" onerror="this.src='https://i.pravatar.cc/150?img=3'">
                    <div class="cabinet-info">
                        <div class="cabinet-name" id="currentCabinetName"></div>
                        <div class="cabinet-rating">–í–∞—à –±–∞–ª–∞–Ω—Å: <span id="currentCabinetTokens" style="color: #4CAF50; font-weight: bold;">0</span> ü™ô</div>
                        <div style="font-size: 0.9em; color: #666;">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞: <span id="maxBetAmount">0</span> ü™ô (50% –æ—Ç –±–∞–ª–∞–Ω—Å–∞)</div>
                    </div>
                </div>
            </div>
            
            <!-- –ë–ª–æ–∫ –≤—Ö–æ–¥–∞ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç -->
            <div class="login-panel" id="betsLoginPanel">
                <h3>üîê –í—Ö–æ–¥ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h3>
                <p>–î–ª—è —É—á–∞—Å—Ç–∏—è –≤ —Å—Ç–∞–≤–∫–∞—Ö –≤–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –∫–∞–±–∏–Ω–µ—Ç:</p>
                <div class="form-group">
                    <label>–õ–æ–≥–∏–Ω:</label>
                    <input type="text" id="betLogin" class="password-input" placeholder="–í–∞—à –ª–æ–≥–∏–Ω">
                </div>
                <div class="form-group">
                    <label>–ü–∞—Ä–æ–ª—å:</label>
                    <input type="password" id="betPassword" class="password-input" placeholder="–í–∞—à –ø–∞—Ä–æ–ª—å">
                </div>
                <button class="login-btn" onclick="loginToBetCabinet()">–í–æ–π—Ç–∏ –≤ –∫–∞–±–∏–Ω–µ—Ç</button>
                <button class="logout-btn" onclick="logoutFromBetCabinet()" style="display: none; margin-top: 10px;">–í—ã–π—Ç–∏</button>
            </div>
            
            <!-- –ê–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ç—á–∏ –¥–ª—è —Å—Ç–∞–≤–æ–∫ -->
            <div class="bets-container">
                <div class="bets-header">
                    <div class="level-icon">üí∞</div>
                    <h3>üìä –ê–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ç—á–∏ –¥–ª—è —Å—Ç–∞–≤–æ–∫</h3>
                </div>
                
                <div id="activeMatchesForBets">
                    <p style="text-align: center; padding: 20px; color: rgba(255, 255, 255, 0.8);">
                        –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∞—Ç—á–µ–π –¥–ª—è —Å—Ç–∞–≤–æ–∫. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –º–∞—Ç—á–∏ –¥–ª—è —Å—Ç–∞–≤–æ–∫.
                    </p>
                </div>
                
                <!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–∞—Ç—á–µ–π –¥–ª—è —Å—Ç–∞–≤–æ–∫ -->
                <div class="admin-controls" id="betsAdminControls" style="display: none; margin-top: 20px;">
                    <h4>‚öôÔ∏è –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Ç—á–∞ –¥–ª—è —Å—Ç–∞–≤–æ–∫ (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)</h4>
                    <div class="grid-2">
                        <div>
                            <div class="form-group">
                                <label>–î–∞—Ç–∞ –º–∞—Ç—á–∞:</label>
                                <input type="datetime-local" id="betMatchDate">
                            </div>
                            <div class="form-group">
                                <label>–ò–≥—Ä–æ–∫ 1:</label>
                                <select id="betPlayer1"></select>
                            </div>
                            <div class="form-group">
                                <label>–ò–≥—Ä–æ–∫ 2:</label>
                                <select id="betPlayer2"></select>
                            </div>
                        </div>
                        <div>
                            <div class="form-group">
                                <label>–û–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
                                <input type="text" id="betDescription" placeholder="–§–∏–Ω–∞–ª —Ç—É—Ä–Ω–∏—Ä–∞, —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –º–∞—Ç—á –∏ —Ç.–¥.">
                            </div>
                            <div class="form-group">
                                <label>–°—Ç–∞—Ç—É—Å:</label>
                                <select id="betMatchStatus">
                                    <option value="pending">–û–∂–∏–¥–∞–Ω–∏–µ</option>
                                    <option value="live">LIVE</option>
                                    <option value="finished">–ó–∞–≤–µ—Ä—à–µ–Ω</option>
                                </select>
                            </div>
                            <button class="add-btn action-btn" onclick="createBetMatch()" style="margin-top: 20px; width: 100%;">
                                üéÆ –°–æ–∑–¥–∞—Ç—å –º–∞—Ç—á –¥–ª—è —Å—Ç–∞–≤–æ–∫
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫ -->
            <div class="cabinet-section" style="background: white; padding: 20px; border-radius: 12px; margin-top: 20px;">
                <h4>üìã –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö —Å—Ç–∞–≤–æ–∫</h4>
                <div class="table-container">
                    <table class="bet-history-table">
                        <thead>
                            <tr>
                                <th>–î–∞—Ç–∞</th>
                                <th>–ú–∞—Ç—á</th>
                                <th>–ò–≥—Ä–æ–∫</th>
                                <th>–°—Ç–∞–≤–∫–∞ –Ω–∞</th>
                                <th>–°—É–º–º–∞</th>
                                <th>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                                <th>–í—ã–∏–≥—Ä—ã—à</th>
                            </tr>
                        </thead>
                        <tbody id="allBetsHistoryBody">
                            <!-- –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö —Å—Ç–∞–≤–æ–∫ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- –ü—Ä–∞–≤–∏–ª–∞ —Å–∏—Å—Ç–µ–º—ã —Å—Ç–∞–≤–æ–∫ -->
            <div style="margin-top: 20px; padding: 20px; background: #f8f9fa; border-radius: 12px; border-left: 5px solid #4CAF50;">
                <h3>üìù –ü—Ä–∞–≤–∏–ª–∞ –∏ —É—Å–ª–æ–≤–∏—è —Å–∏—Å—Ç–µ–º—ã —Å—Ç–∞–≤–æ–∫</h3>
                <div class="grid-2">
                    <div>
                        <h4>üí∞ –û –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –≤–∞–ª—é—Ç–µ</h4>
                        <ul style="list-style: none; padding: 0;">
                            <li>‚Ä¢ ü™ô <strong>"–ñ–µ—Ç–æ–Ω—ã –ª–∏–≥–∏"</strong> - –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –≤–∞–ª—é—Ç–∞ –¥–ª—è –≤–Ω—É—Ç—Ä–∏–∏–≥—Ä–æ–≤—ã—Ö —Å—Ç–∞–≤–æ–∫</li>
                            <li>‚Ä¢ ‚ö†Ô∏è <strong>–ù–µ –∏–º–µ–µ—Ç –¥–µ–Ω–µ–∂–Ω–æ–π —Ü–µ–Ω–Ω–æ—Å—Ç–∏</strong> –∏ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±–º–µ–Ω–µ–Ω–∞ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–µ–Ω—å–≥–∏</li>
                            <li>‚Ä¢ üéÅ –ù–∞—á–∏—Å–ª—è–µ—Ç—Å—è –∑–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: —Å—ã–≥—Ä–∞–Ω–Ω—ã–µ –º–∞—Ç—á–∏, —É—á–∞—Å—Ç–∏–µ –≤ —Ç—É—Ä–Ω–∏—Ä–∞—Ö</li>
                            <li>‚Ä¢ üìà –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –¥–æ–Ω–∞—á–∏—Å–ª–∏—Ç—å –∂–µ—Ç–æ–Ω—ã –∏–≥—Ä–æ–∫–∞–º</li>
                        </ul>
                    </div>
                    <div>
                        <h4>üìä –ü—Ä–∞–≤–∏–ª–∞ —Å—Ç–∞–≤–æ–∫</h4>
                        <ul style="list-style: none; padding: 0;">
                            <li>‚Ä¢ ‚öñÔ∏è <strong>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞: 50%</strong> –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –±–∞–ª–∞–Ω—Å–∞</li>
                            <li>‚Ä¢ üìà –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞–∑–Ω–∏—Ü—ã —Ä–µ–π—Ç–∏–Ω–≥–∞</li>
                            <li>‚Ä¢ ‚è∞ –°—Ç–∞–≤–∫–∏ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–æ –Ω–∞—á–∞–ª–∞ –º–∞—Ç—á–∞</li>
                            <li>‚Ä¢ üèÜ –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –≤—ã–∏–≥—Ä—ã—à</li>
                            <li>‚Ä¢ üîí –ü—Ä–∏ –æ—Ç–º–µ–Ω–µ –º–∞—Ç—á–∞ —Å—Ç–∞–≤–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è</li>
                        </ul>
                    </div>
                </div>
                <div style="margin-top: 15px; padding: 15px; background: #fff3cd; border-radius: 8px; border-left: 4px solid #ffc107;">
                    <h4>‚ùó –í–∞–∂–Ω–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ</h4>
                    <p>–î–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ <strong>–∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</strong> –≤ —Ä–∞–º–∫–∞—Ö –ª–∏–≥–∏ –ª—é–±–∏—Ç–µ–ª–µ–π –Ω–∞—Å—Ç–æ–ª—å–Ω–æ–≥–æ —Ç–µ–Ω–Ω–∏—Å–∞. 
                    –í—Å–µ —Å—Ç–∞–≤–∫–∏ –æ—Å—É—â–µ—Å—Ç–≤–ª—è—é—Ç—Å—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –≤–∞–ª—é—Ç–æ–π –±–µ–∑ –¥–µ–Ω–µ–∂–Ω–æ–π —Ü–µ–Ω–Ω–æ—Å—Ç–∏. –ê–∑–∞—Ä—Ç–Ω—ã–µ –∏–≥—Ä—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–µ–Ω—å–≥–∞–º–∏ –∑–∞–ø—Ä–µ—â–µ–Ω—ã.</p>
                </div>
            </div>
            
            <!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂–µ—Ç–æ–Ω–∞–º–∏ -->
            <div class="admin-controls" id="tokensAdminControls" style="display: none; margin-top: 20px;">
                <h4>‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–µ—Ç–æ–Ω–∞–º–∏ –∏–≥—Ä–æ–∫–æ–≤ (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)</h4>
                <div class="grid-2">
                    <div>
                        <div class="form-group">
                            <label>–ò–≥—Ä–æ–∫:</label>
                            <select id="tokensPlayerSelect"></select>
                        </div>
                        <div class="form-group">
                            <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∂–µ—Ç–æ–Ω–æ–≤:</label>
                            <input type="number" id="tokensAmount" value="100" min="1" max="10000">
                        </div>
                        <div class="form-group">
                            <label>–î–µ–π—Å—Ç–≤–∏–µ:</label>
                            <select id="tokensAction">
                                <option value="add">–î–æ–Ω–∞—á–∏—Å–ª–∏—Ç—å</option>
                                <option value="remove">–°–ø–∏—Å–∞—Ç—å</option>
                                <option value="set">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</option>
                            </select>
                        </div>
                        <button class="add-btn action-btn" onclick="managePlayerTokens()" style="width: 100%;">
                            üí∞ –í—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ
                        </button>
                    </div>
                    <div>
                        <div class="form-group">
                            <label>–ú–∞—Å—Å–æ–≤–æ–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ:</label>
                            <select id="massTokensAction">
                                <option value="all">–í—Å–µ–º –∏–≥—Ä–æ–∫–∞–º</option>
                                <option value="active">–ê–∫—Ç–∏–≤–Ω—ã–º –∏–≥—Ä–æ–∫–∞–º (–º–∞—Ç—á –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 14 –¥–Ω–µ–π)</option>
                                <option value="inactive">–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–º –∏–≥—Ä–æ–∫–∞–º</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∂–µ—Ç–æ–Ω–æ–≤ –Ω–∞ –∏–≥—Ä–æ–∫–∞:</label>
                            <input type="number" id="massTokensAmount" value="50" min="1" max="1000">
                        </div>
                        <button class="penalty-btn action-btn" onclick="massManageTokens()" style="width: 100%;">
                            üéÅ –ú–∞—Å—Å–æ–≤–æ–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="stats">
            <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</h2>
            <div class="form-group" style="max-width: 400px;">
                <label>–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</label>
                <select id="statsPlayerSelect" onchange="updatePeriodStats()"></select>
            </div>
            
            <div class="period-stats">
                <div class="period-box">
                    <h3>üìÖ –ó–∞ –Ω–µ–¥–µ–ª—é</h3>
                    <div id="weekStats">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞</div>
                </div>
                <div class="period-box">
                    <h3>üìÖ –ó–∞ –º–µ—Å—è—Ü</h3>
                    <div id="monthStats">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞</div>
                </div>
                <div class="period-box">
                    <h3>üìÖ –ó–∞ –≥–æ–¥</h3>
                    <div id="yearStats">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞</div>
                </div>
                <div class="period-box">
                    <h3>üìÖ –ó–∞ –≤—Å—ë –≤—Ä–µ–º—è</h3>
                    <div id="allTimeStats">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞</div>
                </div>
            </div>
            
            <h3>üìà –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –º–µ—Å—è—Ü–∞–º</h3>
            <div class="year-progress" id="yearProgress"></div>
            
            <h3>üî• –¢–æ–ø-5 –∏–≥—Ä–æ–∫–æ–≤ –≥–æ–¥–∞</h3>
            <div id="topYearPlayers"></div>
            
            <h3>‚öñÔ∏è –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤</h3>
            <div class="comparison-container">
                <div>
                    <div class="form-group">
                        <label>–ò–≥—Ä–æ–∫ 1:</label>
                        <select id="comparePlayer1"></select>
                    </div>
                    <div class="form-group">
                        <label>–ò–≥—Ä–æ–∫ 2:</label>
                        <select id="comparePlayer2"></select>
                    </div>
                    <button class="add-btn action-btn" onclick="comparePlayers()" style="width: 100%;">
                        üîç –°—Ä–∞–≤–Ω–∏—Ç—å –∏–≥—Ä–æ–∫–æ–≤
                    </button>
                </div>
                <div id="comparisonResult" style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <p>–í—ã–±–µ—Ä–∏—Ç–µ –¥–≤—É—Ö –∏–≥—Ä–æ–∫–æ–≤ –∏ –Ω–∞–∂–º–∏—Ç–µ "–°—Ä–∞–≤–Ω–∏—Ç—å"</p>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="penalties">
            <h2>‚ö†Ô∏è –°–∏—Å—Ç–µ–º–∞ —à—Ç—Ä–∞—Ñ–æ–≤ –∑–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h2>
            <div class="admin-controls" id="penaltiesAdminControls">
                <h4>‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —à—Ç—Ä–∞—Ñ–æ–≤ (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)</h4>
                <button class="penalty-btn action-btn" onclick="checkAndApplyPenalties()">
                    üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∞–≤—Ç–æ-—à—Ç—Ä–∞—Ñ—ã
                </button>
                <p><small>–®—Ç—Ä–∞—Ñ: -60 –æ—á–∫–æ–≤ –∑–∞ –∫–∞–∂–¥—ã–µ 14+ –¥–Ω–µ–π –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</small></p>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>–î–∞—Ç–∞</th>
                            <th>–ò–≥—Ä–æ–∫</th>
                            <th>–®—Ç—Ä–∞—Ñ</th>
                            <th>–î–Ω–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</th>
                            <th>–¢–∏–ø</th>
                        </tr>
                    </thead>
                    <tbody id="penaltiesHistoryBody"></tbody>
                </table>
            </div>
        </div>
        
        <!-- –ü–∞–Ω–µ–ª–∏ –≤–Ω–∏–∑—É —Å–∞–π—Ç–∞ -->
        <div class="bottom-panels">
            <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–π—Ç–∏–Ω–≥–æ–º (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä) -->
            <div class="admin-controls-panel" id="ratingAdminControls">
                <h4>‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–º (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)</h4>
                <button class="penalty-btn action-btn" onclick="checkAndApplyPenalties()">
                    ‚ö†Ô∏è –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∞–≤—Ç–æ-—à—Ç—Ä–∞—Ñ—ã (14+ –¥–Ω–µ–π = -60)
                </button>
                <button class="add-btn action-btn" onclick="saveManualRatings()">
                    üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—á–∫–æ–≤
                </button>
                <p><small>–ò–∑–º–µ–Ω–∏—Ç–µ –æ—á–∫–∏ –≤ –ø–æ–ª—è—Ö –≤–≤–æ–¥–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ —Ä–µ–π—Ç–∏–Ω–≥–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—á–∫–æ–≤"</small></p>
            </div>
            
            <!-- –ü–∞–Ω–µ–ª—å Supabase -->
            <div class="supabase-panel">
                <div class="supabase-status">
                    <strong>‚òÅÔ∏è Supabase Cloud Sync</strong>
                    <div>–°—Ç–∞—Ç—É—Å: <span id="supabaseStatus" class="status-loading">‚è≥ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</span></div>
                    <div>–û–±–Ω–æ–≤–ª–µ–Ω–æ: <span id="supabaseTime">--:--:--</span></div>
                </div>
                <button class="action-btn add-btn" onclick="loadAllData()" id="refreshBtn">
                    üîÑ –û–±–Ω–æ–≤–∏—Ç—å
                </button>
            </div>
            
            <!-- –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ -->
            <div class="admin-panel" id="adminPanel">
                <h3>‚öôÔ∏è –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h3>
                <p>–í—ã –≤–æ—à–ª–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä. –î–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.</p>
                <button class="logout-btn" onclick="logoutAdmin()">üö™ –í—ã–π—Ç–∏ –∏–∑ –∞–¥–º–∏–Ω-—Ä–µ–∂–∏–º–∞</button>
            </div>
            
            <!-- –ü–∞–Ω–µ–ª—å –≤—Ö–æ–¥–∞ -->
            <div class="login-panel" id="loginPanel">
                <h3>üîê –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π</h3>
                <p>–î–ª—è –≤–Ω–µ—Å–µ–Ω–∏—è –º–∞—Ç—á–µ–π –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤–æ–π–¥–∏—Ç–µ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:</p>
                <input type="password" id="adminPassword" class="password-input" placeholder="–ü–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞">
                <button class="login-btn" onclick="loginAdmin()">–í–æ–π—Ç–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</button>
            </div>
        </div>
    </div>

    <script>
    // ============================================
    // –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø SUPABASE
    // ============================================
    const SUPABASE_URL = 'https://bqycjfcjtdawyrysgrbw.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxeWNqZmNqdGRhd3lyeXNncmJ3Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2NjYwMTk3MCwiZXhwIjoyMDgyMTc3OTcwfQ.lHA_79fw8PSj9ZHMExBpSEIpkonkCYOni7HniGGqadY';
    
    let supabaseClient = null;
    let isSupabaseInitialized = false;
    
    // ============================================
    // –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï –î–õ–Ø –°–ò–°–¢–ï–ú–´ –°–¢–ê–í–û–ö
    // ============================================
    let players = {};
    let matches = [];
    let penaltyLog = [];
    let tournaments = [];
    let tournamentMatches = [];
    let tournamentPhotos = [];
    let isAdmin = false;
    const ADMIN_PASSWORD = "admin123";
    
    // –ù–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã —Å—Ç–∞–≤–æ–∫
    let playerCabinets = {}; // –õ–∏—á–Ω—ã–µ –∫–∞–±–∏–Ω–µ—Ç—ã –∏–≥—Ä–æ–∫–æ–≤
    let betMatches = []; // –ú–∞—Ç—á–∏ –¥–ª—è —Å—Ç–∞–≤–æ–∫
    let betHistory = []; // –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫
    let currentLoggedInPlayer = null; // –¢–µ–∫—É—â–∏–π –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∏–≥—Ä–æ–∫
    
    // –ú–∞–≥–∞–∑–∏–Ω –ª–∏–≥–∏
    const leagueShop = [
        {
            id: 'penalty_cancel',
            icon: 'üö´',
            title: '–û—Ç–º–µ–Ω–∞ —à—Ç—Ä–∞—Ñ–∞ –∑–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
            description: '–û—Ç–º–µ–Ω–∏—Ç—å –æ–¥–∏–Ω —à—Ç—Ä–∞—Ñ -60 –æ—á–∫–æ–≤ –∑–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
            price: 500,
            effect: 'cancel_penalty'
        },
        {
            id: 'rating_boost',
            icon: 'üìà',
            title: '–ü–æ–≤—ã—à–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞',
            description: '–ö—É–ø–∏—Ç—å 10 –æ—á–∫–æ–≤ —Ä–µ–π—Ç–∏–Ω–≥–∞',
            price: 100,
            effect: 'add_rating',
            amount: 10
        },
        {
            id: 'rating_boost_big',
            icon: 'üöÄ',
            title: '–ë–æ–ª—å—à–æ–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞',
            description: '–ö—É–ø–∏—Ç—å 50 –æ—á–∫–æ–≤ —Ä–µ–π—Ç–∏–Ω–≥–∞',
            price: 450,
            effect: 'add_rating',
            amount: 50
        },
        {
            id: 'avatar_change',
            icon: 'üñºÔ∏è',
            title: '–°–º–µ–Ω–∞ –∞–≤–∞—Ç–∞—Ä–∞',
            description: '–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–π –∞–≤–∞—Ç–∞—Ä',
            price: 300,
            effect: 'avatar_change'
        },
        {
            id: 'tournament_bonus',
            icon: 'üéØ',
            title: '–ë–æ–Ω—É—Å –Ω–∞ —Ç—É—Ä–Ω–∏—Ä',
            description: '+5% –∫ –ø—Ä–∏–∑–æ–≤—ã–º –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ç—É—Ä–Ω–∏—Ä–µ',
            price: 200,
            effect: 'tournament_bonus'
        }
    ];
    
    // ============================================
    // –§–£–ù–ö–¶–ò–ò –î–õ–Ø –°–ò–°–¢–ï–ú–´ –°–¢–ê–í–û–ö
    // ============================================
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞–∑–Ω–∏—Ü—ã –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ
    function calculateOdds(player1Rating, player2Rating) {
        const diff = Math.abs(player1Rating - player2Rating);
        
        // –ë–∞–∑–æ–≤—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã
        let favoriteOdds = 1.3;
        let underdogOdds = 3.5;
        
        // –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞–∑–Ω–∏—Ü—ã —Ä–µ–π—Ç–∏–Ω–≥–∞
        if (diff >= 400) {
            favoriteOdds = 1.1;
            underdogOdds = 6.0;
        } else if (diff >= 300) {
            favoriteOdds = 1.2;
            underdogOdds = 4.5;
        } else if (diff >= 200) {
            favoriteOdds = 1.25;
            underdogOdds = 3.8;
        } else if (diff >= 100) {
            favoriteOdds = 1.35;
            underdogOdds = 3.0;
        } else if (diff >= 50) {
            favoriteOdds = 1.4;
            underdogOdds = 2.8;
        } else {
            favoriteOdds = 1.5;
            underdogOdds = 2.5;
        }
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ñ–∞–≤–æ—Ä–∏—Ç–∞ –∏ –∞—É—Ç—Å–∞–π–¥–µ—Ä–∞
        if (player1Rating >= player2Rating) {
            return {
                player1: favoriteOdds,
                player2: underdogOdds,
                favorite: player1Rating > player2Rating ? 'player1' : 'equal'
            };
        } else {
            return {
                player1: underdogOdds,
                player2: favoriteOdds,
                favorite: 'player2'
            };
        }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ –∏–≥—Ä–æ–∫–∞
    async function createPlayerCabinet(playerName, login, password = null, initialTokens = 100) {
        try {
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–∞—Ä–æ–ª—å, –µ—Å–ª–∏ –æ–Ω –Ω–µ —É–∫–∞–∑–∞–Ω
            const playerPassword = password || generatePassword();
            
            // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –∫–∞–±–∏–Ω–µ—Ç–∞
            const cabinet = {
                playerName: playerName,
                login: login.toLowerCase(),
                password: playerPassword,
                tokens: initialTokens,
                betsMade: 0,
                betsWon: 0,
                totalWon: 0,
                betHistory: [],
                joinDate: new Date().toISOString(),
                lastLogin: new Date().toISOString(),
                shopPurchases: []
            };
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Supabase
            if (supabaseClient) {
                const { error } = await supabaseClient
                    .from('player_cabinets')
                    .upsert({
                        player_name: playerName,
                        login: cabinet.login,
                        password: cabinet.password,
                        tokens: cabinet.tokens,
                        bets_made: cabinet.betsMade,
                        bets_won: cabinet.betsWon,
                        total_won: cabinet.totalWon,
                        bet_history: cabinet.betHistory,
                        join_date: cabinet.joinDate,
                        last_login: cabinet.lastLogin,
                        shop_purchases: cabinet.shopPurchases,
                        created_at: new Date().toISOString()
                    }, {
                        onConflict: 'login'
                    });
                
                if (error) throw error;
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ
            playerCabinets[cabinet.login] = cabinet;
            
            console.log(`‚úÖ –°–æ–∑–¥–∞–Ω –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –¥–ª—è –∏–≥—Ä–æ–∫–∞ ${playerName}`);
            console.log(`üîë –õ–æ–≥–∏–Ω: ${cabinet.login}, –ü–∞—Ä–æ–ª—å: ${playerPassword}`);
            
            return cabinet;
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞:', error);
            throw error;
        }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–∞—Ä–æ–ª—è
    function generatePassword(length = 8) {
        const charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
        let password = '';
        for (let i = 0; i < length; i++) {
            password += charset.charAt(Math.floor(Math.random() * charset.length));
        }
        return password;
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
    async function loginToBetCabinet() {
        const login = document.getElementById('betLogin').value.trim().toLowerCase();
        const password = document.getElementById('betPassword').value;
        
        if (!login || !password) {
            showNotification('–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å!', 'error');
            return;
        }
        
        try {
            let cabinet;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ
            if (playerCabinets[login] && playerCabinets[login].password === password) {
                cabinet = playerCabinets[login];
            } else {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤ Supabase
                if (supabaseClient) {
                    const { data, error } = await supabaseClient
                        .from('player_cabinets')
                        .select('*')
                        .eq('login', login)
                        .single();
                    
                    if (error) {
                        if (error.code === 'PGRST116') {
                            showNotification('–ö–∞–±–∏–Ω–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
                        } else {
                            throw error;
                        }
                        return;
                    }
                    
                    if (data.password !== password) {
                        showNotification('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!', 'error');
                        return;
                    }
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞–±–∏–Ω–µ—Ç –∏–∑ Supabase
                    cabinet = {
                        playerName: data.player_name,
                        login: data.login,
                        password: data.password,
                        tokens: data.tokens || 0,
                        betsMade: data.bets_made || 0,
                        betsWon: data.bets_won || 0,
                        totalWon: data.total_won || 0,
                        betHistory: data.bet_history || [],
                        joinDate: data.join_date,
                        lastLogin: data.last_login,
                        shopPurchases: data.shop_purchases || []
                    };
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ
                    playerCabinets[login] = cabinet;
                } else {
                    showNotification('–ö–∞–±–∏–Ω–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
                    return;
                }
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤—Ö–æ–¥–∞
            cabinet.lastLogin = new Date().toISOString();
            currentLoggedInPlayer = cabinet;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage –¥–ª—è –∞–≤—Ç–æ–≤—Ö–æ–¥–∞
            localStorage.setItem('currentLoggedInPlayer', JSON.stringify({
                login: cabinet.login,
                timestamp: Date.now()
            }));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            updateBetCabinetDisplay();
            updateActiveBetsDisplay();
            updateAllBetsHistory();
            
            showNotification(`‚úÖ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${cabinet.playerName}!`, 'success');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–±–∏–Ω–µ—Ç–µ –∏ —Å–∫—Ä—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å –≤—Ö–æ–¥–∞
            document.getElementById('betsLoginPanel').style.display = 'none';
            document.getElementById('currentPlayerCabinet').style.display = 'block';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –≤—ã—Ö–æ–¥–∞
            document.querySelector('#betsLoginPanel .logout-btn').style.display = 'block';
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞ –≤ –∫–∞–±–∏–Ω–µ—Ç:', error);
            showNotification('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞ –≤ –∫–∞–±–∏–Ω–µ—Ç', 'error');
        }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã—Ö–æ–¥–∞ –∏–∑ –∫–∞–±–∏–Ω–µ—Ç–∞
    function logoutFromBetCabinet() {
        currentLoggedInPlayer = null;
        localStorage.removeItem('currentLoggedInPlayer');
        
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –≤—Ö–æ–¥–∞
        document.getElementById('betLogin').value = '';
        document.getElementById('betPassword').value = '';
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å –≤—Ö–æ–¥–∞ –∏ —Å–∫—Ä—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–±–∏–Ω–µ—Ç–µ
        document.getElementById('betsLoginPanel').style.display = 'block';
        document.getElementById('currentPlayerCabinet').style.display = 'none';
        document.querySelector('#betsLoginPanel .logout-btn').style.display = 'none';
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞–≤–æ–∫
        updateActiveBetsDisplay();
        
        showNotification('üëã –í—ã –≤—ã—à–ª–∏ –∏–∑ –∫–∞–±–∏–Ω–µ—Ç–∞', 'info');
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞–±–∏–Ω–µ—Ç–∞
    function updateBetCabinetDisplay() {
        if (!currentLoggedInPlayer) return;
        
        const cabinet = currentLoggedInPlayer;
        const playerData = players[cabinet.playerName];
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –∫–∞–±–∏–Ω–µ—Ç–µ
        document.getElementById('currentCabinetName').textContent = cabinet.playerName;
        document.getElementById('currentCabinetTokens').textContent = cabinet.tokens;
        document.getElementById('maxBetAmount').textContent = Math.floor(cabinet.tokens * 0.5);
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–≤–∞—Ç–∞—Ä
        const avatarElement = document.getElementById('currentCabinetAvatar');
        if (playerData && playerData.avatar) {
            avatarElement.src = playerData.avatar;
        } else {
            avatarElement.src = 'https://i.pravatar.cc/150?img=3';
        }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–∞—Ç—á–∞ –¥–ª—è —Å—Ç–∞–≤–æ–∫
    async function createBetMatch() {
        if (!isAdmin) {
            showNotification('‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –º–∞—Ç—á–∏ –¥–ª—è —Å—Ç–∞–≤–æ–∫!', 'error');
            return;
        }
        
        const player1 = document.getElementById('betPlayer1').value;
        const player2 = document.getElementById('betPlayer2').value;
        const description = document.getElementById('betDescription').value.trim();
        const status = document.getElementById('betMatchStatus').value;
        
        if (!player1 || !player2) {
            showNotification('–í—ã–±–µ—Ä–∏—Ç–µ –æ–±–æ–∏—Ö –∏–≥—Ä–æ–∫–æ–≤!', 'error');
            return;
        }
        
        if (player1 === player2) {
            showNotification('–ò–≥—Ä–æ–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞–∑–Ω—ã–º–∏!', 'error');
            return;
        }
        
        const dateTime = document.getElementById('betMatchDate').value;
        const matchDate = dateTime ? new Date(dateTime) : new Date();
        
        // –ü–æ–ª—É—á–∞–µ–º —Ä–µ–π—Ç–∏–Ω–≥–∏ –∏–≥—Ä–æ–∫–æ–≤
        const player1Rating = players[player1]?.rating || 1000;
        const player2Rating = players[player2]?.rating || 1000;
        
        // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã
        const odds = calculateOdds(player1Rating, player2Rating);
        
        // –°–æ–∑–¥–∞–µ–º –º–∞—Ç—á –¥–ª—è —Å—Ç–∞–≤–æ–∫
        const betMatch = {
            id: Date.now().toString(),
            player1: player1,
            player2: player2,
            player1Rating: player1Rating,
            player2Rating: player2Rating,
            description: description,
            date: matchDate.toISOString(),
            status: status, // 'pending', 'live', 'finished'
            odds: odds,
            result: null, // 'player1', 'player2', 'draw', 'cancelled'
            totalBets: 0,
            totalAmount: 0,
            bets: []
        };
        
        try {
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Supabase
            if (supabaseClient) {
                const { error } = await supabaseClient
                    .from('bet_matches')
                    .insert({
                        id: betMatch.id,
                        player1: betMatch.player1,
                        player2: betMatch.player2,
                        player1_rating: betMatch.player1Rating,
                        player2_rating: betMatch.player2Rating,
                        description: betMatch.description,
                        date: betMatch.date,
                        status: betMatch.status,
                        odds: betMatch.odds,
                        result: betMatch.result,
                        total_bets: betMatch.totalBets,
                        total_amount: betMatch.totalAmount,
                        bets: betMatch.bets,
                        created_at: new Date().toISOString()
                    });
                
                if (error) throw error;
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ
            betMatches.push(betMatch);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            updateActiveBetsDisplay();
            
            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('betDescription').value = '';
            document.getElementById('betMatchDate').value = '';
            
            showNotification(`‚úÖ –ú–∞—Ç—á –¥–ª—è —Å—Ç–∞–≤–æ–∫ —Å–æ–∑–¥–∞–Ω! ${player1} vs ${player2}`, 'success');
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –º–∞—Ç—á–∞ –¥–ª—è —Å—Ç–∞–≤–æ–∫:', error);
            showNotification('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –º–∞—Ç—á–∞ –¥–ª—è —Å—Ç–∞–≤–æ–∫', 'error');
        }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ç–∞–≤–æ–∫
    function updateActiveBetsDisplay() {
        const container = document.getElementById('activeMatchesForBets');
        if (!container) return;
        
        // –§–∏–ª—å—Ç—Ä—É–µ–º –º–∞—Ç—á–∏: —Ç–æ–ª—å–∫–æ pending –∏–ª–∏ live
        const activeMatches = betMatches.filter(match => 
            match.status === 'pending' || match.status === 'live'
        );
        
        if (activeMatches.length === 0) {
            container.innerHTML = `
                <p style="text-align: center; padding: 20px; color: rgba(255, 255, 255, 0.8);">
                    –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∞—Ç—á–µ–π –¥–ª—è —Å—Ç–∞–≤–æ–∫. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –º–∞—Ç—á–∏ –¥–ª—è —Å—Ç–∞–≤–æ–∫.
                </p>
            `;
            return;
        }
        
        let html = '<div class="bets-grid">';
        
        activeMatches.forEach(match => {
            const player1Data = players[match.player1];
            const player2Data = players[match.player2];
            const isLive = match.status === 'live';
            
            html += `
                <div class="bet-card">
                    <div class="bet-match-info">
                        <div class="bet-player ${match.odds.favorite === 'player1' ? 'winner' : ''}">
                            <img src="${player1Data?.avatar || 'https://i.pravatar.cc/150?img=3'}" 
                                 style="width: 40px; height: 40px; border-radius: 50%;">
                            <div class="bet-player-info">
                                <div class="bet-player-name">${match.player1}</div>
                                <div class="bet-player-rating">–†–µ–π—Ç–∏–Ω–≥: ${match.player1Rating}</div>
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin: 10px 0;">
                            <div style="font-weight: bold; color: #ff9800;">${isLive ? '<span class="match-live-badge">LIVE</span>' : 'VS'}</div>
                            ${match.description ? `<div style="font-size: 0.9em; margin-top: 5px;">${match.description}</div>` : ''}
                            <div style="font-size: 0.8em; margin-top: 5px;">
                                ${new Date(match.date).toLocaleDateString('ru-RU')} 
                                ${new Date(match.date).toLocaleTimeString('ru-RU', {hour: '2-digit', minute:'2-digit'})}
                            </div>
                        </div>
                        
                        <div class="bet-player ${match.odds.favorite === 'player2' ? 'winner' : ''}">
                            <div class="bet-player-info" style="text-align: right;">
                                <div class="bet-player-name">${match.player2}</div>
                                <div class="bet-player-rating">–†–µ–π—Ç–∏–Ω–≥: ${match.player2Rating}</div>
                            </div>
                            <img src="${player2Data?.avatar || 'https://i.pravatar.cc/150?img=3'}" 
                                 style="width: 40px; height: 40px; border-radius: 50%;">
                        </div>
                    </div>
                    
                    <div class="bet-odds">
                        <div class="odds-item">
                            <div class="odds-value">${match.odds.player1.toFixed(2)}</div>
                            <div class="odds-label">${match.player1}</div>
                        </div>
                        <div class="odds-item">
                            <div class="odds-value">${match.odds.player2.toFixed(2)}</div>
                            <div class="odds-label">${match.player2}</div>
                        </div>
                    </div>
                    
                    ${currentLoggedInPlayer && match.status === 'pending' ? `
                        <div class="bet-form">
                            <input type="number" 
                                   class="bet-amount-input" 
                                   id="betAmount_${match.id}"
                                   placeholder="–°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏"
                                   min="1" 
                                   max="${Math.floor(currentLoggedInPlayer.tokens * 0.5)}">
                            <div class="bet-buttons">
                                <button class="bet-btn bet-btn-player1" 
                                        onclick="placeBet('${match.id}', 'player1')">
                                    –°—Ç–∞–≤–∫–∞ –Ω–∞ ${match.player1}
                                </button>
                                <button class="bet-btn bet-btn-player2" 
                                        onclick="placeBet('${match.id}', 'player2')">
                                    –°—Ç–∞–≤–∫–∞ –Ω–∞ ${match.player2}
                                </button>
                            </div>
                            <div id="betStatus_${match.id}" class="bet-status"></div>
                        </div>
                    ` : ''}
                    
                    ${match.status === 'live' ? `
                        <div class="bet-status pending">
                            ‚è≥ –ú–∞—Ç—á –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ. –°—Ç–∞–≤–∫–∏ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è.
                        </div>
                    ` : ''}
                    
                    ${match.totalBets > 0 ? `
                        <div style="margin-top: 10px; padding: 10px; background: rgba(0, 0, 0, 0.1); border-radius: 6px; text-align: center;">
                            <div style="font-size: 0.9em;">–í—Å–µ–≥–æ —Å—Ç–∞–≤–æ–∫: ${match.totalBets}</div>
                            <div style="font-size: 0.9em;">–û–±—â–∞—è —Å—É–º–º–∞: ${match.totalAmount} ü™ô</div>
                        </div>
                    ` : ''}
                    
                    ${isAdmin ? `
                        <div style="margin-top: 10px; display: flex; gap: 10px;">
                            <button class="action-btn add-btn" 
                                    onclick="updateBetMatchStatus('${match.id}', 'live')"
                                    style="flex: 1; padding: 5px; font-size: 0.9em;">
                                ‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å –º–∞—Ç—á
                            </button>
                            <button class="action-btn penalty-btn" 
                                    onclick="finishBetMatch('${match.id}')"
                                    style="flex: 1; padding: 5px; font-size: 0.9em;">
                                üèÅ –ó–∞–≤–µ—Ä—à–∏—Ç—å –º–∞—Ç—á
                            </button>
                        </div>
                    ` : ''}
                </div>
            `;
        });
        
        html += '</div>';
        container.innerHTML = html;
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è —Å—Ç–∞–≤–∫–∏
    async function placeBet(matchId, betOn) {
        if (!currentLoggedInPlayer) {
            showNotification('‚ùå –í–æ–π–¥–∏—Ç–µ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç, —á—Ç–æ–±—ã –¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫–∏!', 'error');
            return;
        }
        
        const match = betMatches.find(m => m.id === matchId);
        if (!match) {
            showNotification('–ú–∞—Ç—á –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
            return;
        }
        
        if (match.status !== 'pending') {
            showNotification('–°—Ç–∞–≤–∫–∏ –Ω–∞ —ç—Ç–æ—Ç –º–∞—Ç—á –±–æ–ª—å—à–µ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è!', 'error');
            return;
        }
        
        const amountInput = document.getElementById(`betAmount_${matchId}`);
        const amount = parseInt(amountInput.value);
        
        if (!amount || amount < 1) {
            showNotification('–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É —Å—Ç–∞–≤–∫–∏!', 'error');
            return;
        }
        
        const maxBet = Math.floor(currentLoggedInPlayer.tokens * 0.5);
        if (amount > maxBet) {
            showNotification(`–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞: ${maxBet} ü™ô (50% –æ—Ç –±–∞–ª–∞–Ω—Å–∞)`, 'error');
            return;
        }
        
        if (amount > currentLoggedInPlayer.tokens) {
            showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∂–µ—Ç–æ–Ω–æ–≤ –¥–ª—è —Å—Ç–∞–≤–∫–∏!', 'error');
            return;
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –¥–µ–ª–∞–ª –ª–∏ —É–∂–µ –∏–≥—Ä–æ–∫ —Å—Ç–∞–≤–∫—É –Ω–∞ —ç—Ç–æ—Ç –º–∞—Ç—á
        const existingBet = match.bets.find(bet => bet.playerLogin === currentLoggedInPlayer.login);
        if (existingBet) {
            showNotification('–í—ã —É–∂–µ –¥–µ–ª–∞–ª–∏ —Å—Ç–∞–≤–∫—É –Ω–∞ —ç—Ç–æ—Ç –º–∞—Ç—á!', 'error');
            return;
        }
        
        // –°–æ–∑–¥–∞–µ–º —Å—Ç–∞–≤–∫—É
        const bet = {
            id: Date.now().toString(),
            matchId: matchId,
            playerLogin: currentLoggedInPlayer.login,
            playerName: currentLoggedInPlayer.playerName,
            betOn: betOn,
            amount: amount,
            odds: betOn === 'player1' ? match.odds.player1 : match.odds.player2,
            potentialWin: Math.floor(amount * (betOn === 'player1' ? match.odds.player1 : match.odds.player2)),
            status: 'pending',
            placedAt: new Date().toISOString(),
            result: null,
            winAmount: 0
        };
        
        try {
            // –í—ã—á–∏—Ç–∞–µ–º –∂–µ—Ç–æ–Ω—ã —É –∏–≥—Ä–æ–∫–∞
            currentLoggedInPlayer.tokens -= amount;
            currentLoggedInPlayer.betsMade += 1;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –º–∞—Ç—á
            match.bets.push(bet);
            match.totalBets += 1;
            match.totalAmount += amount;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Å—Ç–æ—Ä–∏—é —Å—Ç–∞–≤–∫–∏
            betHistory.push(bet);
            currentLoggedInPlayer.betHistory.push(bet);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Supabase
            if (supabaseClient) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–±–∏–Ω–µ—Ç –∏–≥—Ä–æ–∫–∞
                await supabaseClient
                    .from('player_cabinets')
                    .update({
                        tokens: currentLoggedInPlayer.tokens,
                        bets_made: currentLoggedInPlayer.betsMade,
                        bet_history: currentLoggedInPlayer.betHistory
                    })
                    .eq('login', currentLoggedInPlayer.login);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –º–∞—Ç—á
                await supabaseClient
                    .from('bet_matches')
                    .update({
                        bets: match.bets,
                        total_bets: match.totalBets,
                        total_amount: match.totalAmount
                    })
                    .eq('id', matchId);
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–∞–≤–∫—É
                await supabaseClient
                    .from('bet_history')
                    .insert({
                        id: bet.id,
                        match_id: bet.matchId,
                        player_login: bet.playerLogin,
                        player_name: bet.playerName,
                        bet_on: bet.betOn,
                        amount: bet.amount,
                        odds: bet.odds,
                        potential_win: bet.potentialWin,
                        status: bet.status,
                        placed_at: bet.placedAt,
                        result: bet.result,
                        win_amount: bet.winAmount
                    });
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            updateBetCabinetDisplay();
            updateActiveBetsDisplay();
            updatePlayerBetHistory();
            updateAllBetsHistory();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            const statusElement = document.getElementById(`betStatus_${matchId}`);
            if (statusElement) {
                statusElement.textContent = `‚úÖ –°—Ç–∞–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞! ${amount} ü™ô –Ω–∞ ${betOn === 'player1' ? match.player1 : match.player2}`;
                statusElement.className = 'bet-status won';
            }
            
            amountInput.value = '';
            
            showNotification(`‚úÖ –°—Ç–∞–≤–∫–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∞! ${amount} ü™ô –Ω–∞ ${betOn === 'player1' ? match.player1 : match.player2}`, 'success');
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è —Å—Ç–∞–≤–∫–∏:', error);
            showNotification('–û—à–∏–±–∫–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è —Å—Ç–∞–≤–∫–∏', 'error');
        }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –º–∞—Ç—á–∞
    async function updateBetMatchStatus(matchId, newStatus) {
        if (!isAdmin) {
            showNotification('‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Å—Ç–∞—Ç—É—Å –º–∞—Ç—á–∞!', 'error');
            return;
        }
        
        const match = betMatches.find(m => m.id === matchId);
        if (!match) {
            showNotification('–ú–∞—Ç—á –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
            return;
        }
        
        match.status = newStatus;
        
        try {
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Supabase
            if (supabaseClient) {
                await supabaseClient
                    .from('bet_matches')
                    .update({ status: newStatus })
                    .eq('id', matchId);
            }
            
            updateActiveBetsDisplay();
            showNotification(`–°—Ç–∞—Ç—É—Å –º–∞—Ç—á–∞ –∏–∑–º–µ–Ω–µ–Ω –Ω–∞: ${newStatus}`, 'success');
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –º–∞—Ç—á–∞:', error);
            showNotification('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –º–∞—Ç—á–∞', 'error');
        }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –º–∞—Ç—á–∞ –∏ —Ä–∞—Å—á–µ—Ç–∞ –≤—ã–∏–≥—Ä—ã—à–µ–π
    async function finishBetMatch(matchId) {
        if (!isAdmin) {
            showNotification('‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –∑–∞–≤–µ—Ä—à–∞—Ç—å –º–∞—Ç—á–∏!', 'error');
            return;
        }
        
        const match = betMatches.find(m => m.id === matchId);
        if (!match) {
            showNotification('–ú–∞—Ç—á –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
            return;
        }
        
        // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        const result = prompt(`–í–≤–µ–¥–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–∞—Ç—á–∞ ${match.player1} vs ${match.player2}:
1 - –ü–æ–±–µ–¥–∏–ª ${match.player1}
2 - –ü–æ–±–µ–¥–∏–ª ${match.player2}
3 - –ù–∏—á—å—è
4 - –ú–∞—Ç—á –æ—Ç–º–µ–Ω–µ–Ω`);
        
        let resultText;
        switch(result) {
            case '1':
                resultText = 'player1';
                break;
            case '2':
                resultText = 'player2';
                break;
            case '3':
                resultText = 'draw';
                break;
            case '4':
                resultText = 'cancelled';
                break;
            default:
                showNotification('–û—Ç–º–µ–Ω–µ–Ω–æ', 'info');
                return;
        }
        
        match.result = resultText;
        match.status = 'finished';
        
        // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –≤—ã–∏–≥—Ä—ã—à–∏
        let updatedCabinets = [];
        
        for (const bet of match.bets) {
            let betResult = 'lost';
            let winAmount = 0;
            
            if (resultText === 'cancelled') {
                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞–≤–∫—É –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ –º–∞—Ç—á–∞
                betResult = 'cancelled';
                winAmount = bet.amount;
            } else if (resultText === 'draw') {
                // –ü—Ä–∏ –Ω–∏—á—å–µ–π –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞–≤–∫—É
                betResult = 'draw';
                winAmount = bet.amount;
            } else if (bet.betOn === resultText) {
                // –í—ã–∏–≥—Ä—ã—à
                betResult = 'won';
                winAmount = bet.potentialWin;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞–≤–∫—É
            bet.status = betResult;
            bet.result = resultText;
            bet.winAmount = winAmount;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–±–∏–Ω–µ—Ç –∏–≥—Ä–æ–∫–∞
            const cabinet = playerCabinets[bet.playerLogin];
            if (cabinet) {
                if (betResult === 'won') {
                    cabinet.tokens += winAmount;
                    cabinet.betsWon += 1;
                    cabinet.totalWon += winAmount;
                } else if (betResult === 'cancelled' || betResult === 'draw') {
                    cabinet.tokens += winAmount;
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏—Å—Ç–æ—Ä–∏—é —Å—Ç–∞–≤–∫–∏ –≤ –∫–∞–±–∏–Ω–µ—Ç–µ
                const playerBetIndex = cabinet.betHistory.findIndex(b => b.id === bet.id);
                if (playerBetIndex !== -1) {
                    cabinet.betHistory[playerBetIndex] = bet;
                }
                
                updatedCabinets.push(cabinet);
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é —Å—Ç–∞–≤–æ–∫
            const globalBetIndex = betHistory.findIndex(b => b.id === bet.id);
            if (globalBetIndex !== -1) {
                betHistory[globalBetIndex] = bet;
            }
        }
        
        try {
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Supabase
            if (supabaseClient) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –º–∞—Ç—á
                await supabaseClient
                    .from('bet_matches')
                    .update({
                        result: resultText,
                        status: 'finished',
                        bets: match.bets
                    })
                    .eq('id', matchId);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏—Å—Ç–æ—Ä–∏—é —Å—Ç–∞–≤–æ–∫
                for (const bet of match.bets) {
                    await supabaseClient
                        .from('bet_history')
                        .update({
                            status: bet.status,
                            result: bet.result,
                            win_amount: bet.winAmount
                        })
                        .eq('id', bet.id);
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–±–∏–Ω–µ—Ç—ã –∏–≥—Ä–æ–∫–æ–≤
                for (const cabinet of updatedCabinets) {
                    await supabaseClient
                        .from('player_cabinets')
                        .update({
                            tokens: cabinet.tokens,
                            bets_won: cabinet.betsWon,
                            total_won: cabinet.totalWon,
                            bet_history: cabinet.betHistory
                        })
                        .eq('login', cabinet.login);
                }
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            updateActiveBetsDisplay();
            updateAllBetsHistory();
            
            // –ï—Å–ª–∏ —Ç–µ–∫—É—â–∏–π –∏–≥—Ä–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ –∫–∞–±–∏–Ω–µ—Ç
            if (currentLoggedInPlayer && updatedCabinets.some(c => c.login === currentLoggedInPlayer.login)) {
                currentLoggedInPlayer = playerCabinets[currentLoggedInPlayer.login];
                updateBetCabinetDisplay();
                updatePlayerBetHistory();
            }
            
            showNotification(`‚úÖ –ú–∞—Ç—á –∑–∞–≤–µ—Ä—à–µ–Ω! –†–µ–∑—É–ª—å—Ç–∞—Ç: ${resultText}`, 'success');
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –º–∞—Ç—á–∞:', error);
            showNotification('–û—à–∏–±–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –º–∞—Ç—á–∞', 'error');
        }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ —Å—Ç–∞–≤–æ–∫ —Ç–µ–∫—É—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞
    function updatePlayerBetHistory() {
        if (!currentLoggedInPlayer) return;
        
        const tbody = document.getElementById('betHistoryBody');
        if (!tbody) return;
        
        const playerBets = currentLoggedInPlayer.betHistory
            .sort((a, b) => new Date(b.placedAt) - new Date(a.placedAt))
            .slice(0, 20); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Å—Ç–∞–≤–æ–∫
        
        if (playerBets.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="6" style="text-align: center; padding: 20px;">
                        –í—ã –µ—â–µ –Ω–µ –¥–µ–ª–∞–ª–∏ —Å—Ç–∞–≤–æ–∫
                    </td>
                </tr>
            `;
            return;
        }
        
        let html = '';
        
        playerBets.forEach(bet => {
            const match = betMatches.find(m => m.id === bet.matchId);
            if (!match) return;
            
            let statusClass = '';
            let statusText = '';
            
            switch(bet.status) {
                case 'pending':
                    statusClass = 'pending';
                    statusText = '‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ';
                    break;
                case 'won':
                    statusClass = 'won';
                    statusText = '‚úÖ –í—ã–∏–≥—Ä–∞–Ω–æ';
                    break;
                case 'lost':
                    statusClass = 'lost';
                    statusText = '‚ùå –ü—Ä–æ–∏–≥—Ä–∞–Ω–æ';
                    break;
                case 'draw':
                    statusClass = '';
                    statusText = 'ü§ù –ù–∏—á—å—è';
                    break;
                case 'cancelled':
                    statusClass = '';
                    statusText = 'üö´ –û—Ç–º–µ–Ω–µ–Ω–æ';
                    break;
            }
            
            html += `
                <tr>
                    <td>${new Date(bet.placedAt).toLocaleDateString('ru-RU')}</td>
                    <td>${match.player1} vs ${match.player2}</td>
                    <td>${bet.betOn === 'player1' ? match.player1 : match.player2}</td>
                    <td>${bet.odds.toFixed(2)}</td>
                    <td><span class="${statusClass}">${statusText}</span></td>
                    <td>
                        ${bet.status === 'won' ? `<span style="color: #4CAF50; font-weight: bold;">+${bet.winAmount} ü™ô</span>` : 
                          bet.status === 'draw' || bet.status === 'cancelled' ? `<span>${bet.amount} ü™ô</span>` :
                          `<span style="color: #f44336;">-${bet.amount} ü™ô</span>`}
                    </td>
                </tr>
            `;
        });
        
        tbody.innerHTML = html;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ –∫–∞–±–∏–Ω–µ—Ç–µ
        const cabinet = currentLoggedInPlayer;
        const winRate = cabinet.betsMade > 0 ? Math.round((cabinet.betsWon / cabinet.betsMade) * 100) : 0;
        
        document.getElementById('cabinetBetsMade').textContent = cabinet.betsMade;
        document.getElementById('cabinetBetsWon').textContent = cabinet.betsWon;
        document.getElementById('cabinetTotalWon').textContent = cabinet.totalWon;
        document.getElementById('cabinetWinRate').textContent = `${winRate}%`;
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –≤—Å–µ—Ö —Å—Ç–∞–≤–æ–∫
    function updateAllBetsHistory() {
        const tbody = document.getElementById('allBetsHistoryBody');
        if (!tbody) return;
        
        // –ë–µ—Ä–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç–∞–≤–æ–∫ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
        const recentBets = [...betHistory]
            .sort((a, b) => new Date(b.placedAt) - new Date(a.placedAt))
            .slice(0, 50);
        
        if (recentBets.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="8" style="text-align: center; padding: 20px;">
                        –°—Ç–∞–≤–æ–∫ –µ—â–µ –Ω–µ –±—ã–ª–æ
                    </td>
                </tr>
            `;
            return;
        }
        
        let html = '';
        
        recentBets.forEach(bet => {
            const match = betMatches.find(m => m.id === bet.matchId);
            if (!match) return;
            
            let statusText = '';
            let statusClass = '';
            
            switch(bet.status) {
                case 'pending':
                    statusText = '‚è≥';
                    statusClass = 'pending';
                    break;
                case 'won':
                    statusText = '‚úÖ';
                    statusClass = 'won';
                    break;
                case 'lost':
                    statusText = '‚ùå';
                    statusClass = 'lost';
                    break;
                case 'draw':
                    statusText = 'ü§ù';
                    break;
                case 'cancelled':
                    statusText = 'üö´';
                    break;
            }
            
            html += `
                <tr>
                    <td>${new Date(bet.placedAt).toLocaleDateString('ru-RU')}</td>
                    <td>${match.player1} vs ${match.player2}</td>
                    <td>${bet.playerName}</td>
                    <td>${bet.betOn === 'player1' ? match.player1 : match.player2}</td>
                    <td>${bet.amount} ü™ô</td>
                    <td>${bet.odds.toFixed(2)}</td>
                    <td><span class="${statusClass}">${statusText}</span></td>
                    <td>
                        ${bet.status === 'won' ? `<span style="color: #4CAF50; font-weight: bold;">+${bet.winAmount} ü™ô</span>` : 
                          bet.status === 'draw' || bet.status === 'cancelled' ? `<span>${bet.amount} ü™ô</span>` :
                          bet.status === 'lost' ? `<span style="color: #f44336;">-${bet.amount} ü™ô</span>` :
                          '‚è≥'}
                    </td>
                </tr>
            `;
        });
        
        tbody.innerHTML = html;
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–∞–≥–∞–∑–∏–Ω–∞
    function updateLeagueShop() {
        const container = document.getElementById('leagueShop');
        if (!container) return;
        
        let html = '';
        
        leagueShop.forEach(item => {
            const canAfford = currentLoggedInPlayer && currentLoggedInPlayer.tokens >= item.price;
            
            html += `
                <div class="shop-item">
                    <div class="shop-icon">${item.icon}</div>
                    <div class="shop-title">${item.title}</div>
                    <div class="shop-description">${item.description}</div>
                    <div class="shop-price">${item.price} ü™ô</div>
                    <button class="buy-btn" 
                            onclick="buyShopItem('${item.id}')"
                            ${!currentLoggedInPlayer || !canAfford ? 'disabled' : ''}>
                        ${canAfford ? '–ö—É–ø–∏—Ç—å' : '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∂–µ—Ç–æ–Ω–æ–≤'}
                    </button>
                </div>
            `;
        });
        
        container.innerHTML = html;
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫—É–ø–∫–∏ —Ç–æ–≤–∞—Ä–∞ –≤ –º–∞–≥–∞–∑–∏–Ω–µ
    async function buyShopItem(itemId) {
        if (!currentLoggedInPlayer) {
            showNotification('‚ùå –í–æ–π–¥–∏—Ç–µ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç!', 'error');
            return;
        }
        
        const item = leagueShop.find(i => i.id === itemId);
        if (!item) {
            showNotification('–¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
            return;
        }
        
        if (currentLoggedInPlayer.tokens < item.price) {
            showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∂–µ—Ç–æ–Ω–æ–≤!', 'error');
            return;
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –ø–æ–∫—É–ø–∞–ª –ª–∏ —É–∂–µ –∏–≥—Ä–æ–∫ —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä (–µ—Å–ª–∏ —Ç–æ–≤–∞—Ä –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π)
        if (currentLoggedInPlayer.shopPurchases && 
            currentLoggedInPlayer.shopPurchases.includes(itemId)) {
            showNotification('–í—ã —É–∂–µ –ø–æ–∫—É–ø–∞–ª–∏ —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä!', 'error');
            return;
        }
        
        // –°–ø–∏—Å—ã–≤–∞–µ–º –∂–µ—Ç–æ–Ω—ã
        currentLoggedInPlayer.tokens -= item.price;
        
        // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–∫—É–ø–∫—É –≤ –∏—Å—Ç–æ—Ä–∏—é
        if (!currentLoggedInPlayer.shopPurchases) {
            currentLoggedInPlayer.shopPurchases = [];
        }
        currentLoggedInPlayer.shopPurchases.push(itemId);
        
        // –ü—Ä–∏–º–µ–Ω—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç —Ç–æ–≤–∞—Ä–∞
        let effectMessage = '';
        
        switch(item.effect) {
            case 'cancel_penalty':
                // –ù–∞—Ö–æ–¥–∏–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —à—Ç—Ä–∞—Ñ –∏–≥—Ä–æ–∫–∞
                const playerPenalties = penaltyLog
                    .filter(p => p.player === currentLoggedInPlayer.playerName && p.amount < 0)
                    .sort((a, b) => new Date(b.date) - new Date(a.date));
                
                if (playerPenalties.length > 0) {
                    const lastPenalty = playerPenalties[0];
                    // –û—Ç–º–µ–Ω—è–µ–º —à—Ç—Ä–∞—Ñ (–¥–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞—Ç–Ω–æ –æ—á–∫–∏)
                    if (players[currentLoggedInPlayer.playerName]) {
                        players[currentLoggedInPlayer.playerName].rating += Math.abs(lastPenalty.amount);
                        effectMessage = `–®—Ç—Ä–∞—Ñ -${Math.abs(lastPenalty.amount)} –æ—á–∫–æ–≤ –æ—Ç–º–µ–Ω–µ–Ω!`;
                        
                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
                        await savePlayerToSupabase(currentLoggedInPlayer.playerName, players[currentLoggedInPlayer.playerName]);
                    }
                } else {
                    effectMessage = '–£ –≤–∞—Å –Ω–µ—Ç —à—Ç—Ä–∞—Ñ–æ–≤ –¥–ª—è –æ—Ç–º–µ–Ω—ã';
                }
                break;
                
            case 'add_rating':
                if (players[currentLoggedInPlayer.playerName]) {
                    players[currentLoggedInPlayer.playerName].rating += item.amount;
                    effectMessage = `–†–µ–π—Ç–∏–Ω–≥ –ø–æ–≤—ã—à–µ–Ω –Ω–∞ ${item.amount} –æ—á–∫–æ–≤!`;
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
                    await savePlayerToSupabase(currentLoggedInPlayer.playerName, players[currentLoggedInPlayer.playerName]);
                }
                break;
                
            case 'avatar_change':
                const newAvatar = prompt('–í–≤–µ–¥–∏—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ –Ω–æ–≤—ã–π –∞–≤–∞—Ç–∞—Ä:');
                if (newAvatar) {
                    if (players[currentLoggedInPlayer.playerName]) {
                        players[currentLoggedInPlayer.playerName].avatar = newAvatar;
                        effectMessage = '–í—ã –º–æ–∂–µ—Ç–µ —Å–º–µ–Ω–∏—Ç—å –∞–≤–∞—Ç–∞—Ä –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–æ—Ñ–∏–ª—è';
                        
                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
                        await savePlayerToSupabase(currentLoggedInPlayer.playerName, players[currentLoggedInPlayer.playerName]);
                    }
                }
                break;
                
            case 'tournament_bonus':
                effectMessage = '–ë–æ–Ω—É—Å –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ç—É—Ä–Ω–∏—Ä–µ';
                break;
        }
        
        try {
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞–±–∏–Ω–µ—Ç –≤ Supabase
            if (supabaseClient) {
                await supabaseClient
                    .from('player_cabinets')
                    .update({
                        tokens: currentLoggedInPlayer.tokens,
                        shop_purchases: currentLoggedInPlayer.shopPurchases
                    })
                    .eq('login', currentLoggedInPlayer.login);
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            updateBetCabinetDisplay();
            updateLeagueShop();
            updateAllDisplays();
            
            showNotification(`‚úÖ –ü–æ–∫—É–ø–∫–∞ —É—Å–ø–µ—à–Ω–∞! ${effectMessage}`, 'success');
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏ —Ç–æ–≤–∞—Ä–∞:', error);
            showNotification('–û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏ —Ç–æ–≤–∞—Ä–∞', 'error');
        }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂–µ—Ç–æ–Ω–∞–º–∏ –∏–≥—Ä–æ–∫–æ–≤ (–∞–¥–º–∏–Ω)
    async function managePlayerTokens() {
        if (!isAdmin) {
            showNotification('‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –∂–µ—Ç–æ–Ω–∞–º–∏!', 'error');
            return;
        }
        
        const playerName = document.getElementById('tokensPlayerSelect').value;
        const amount = parseInt(document.getElementById('tokensAmount').value);
        const action = document.getElementById('tokensAction').value;
        
        if (!playerName || !amount || amount < 1) {
            showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ!', 'error');
            return;
        }
        
        // –ù–∞—Ö–æ–¥–∏–º –∫–∞–±–∏–Ω–µ—Ç –∏–≥—Ä–æ–∫–∞
        const cabinet = Object.values(playerCabinets).find(c => c.playerName === playerName);
        if (!cabinet) {
            showNotification('–ö–∞–±–∏–Ω–µ—Ç –∏–≥—Ä–æ–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
            return;
        }
        
        let newAmount = cabinet.tokens;
        let message = '';
        
        switch(action) {
            case 'add':
                newAmount += amount;
                message = `–î–æ–Ω–∞—á–∏—Å–ª–µ–Ω–æ ${amount} –∂–µ—Ç–æ–Ω–æ–≤ –∏–≥—Ä–æ–∫—É ${playerName}`;
                break;
            case 'remove':
                newAmount = Math.max(0, newAmount - amount);
                message = `–°–ø–∏—Å–∞–Ω–æ ${amount} –∂–µ—Ç–æ–Ω–æ–≤ —É –∏–≥—Ä–æ–∫–∞ ${playerName}`;
                break;
            case 'set':
                newAmount = amount;
                message = `–ë–∞–ª–∞–Ω—Å –∏–≥—Ä–æ–∫–∞ ${playerName} —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ ${amount} –∂–µ—Ç–æ–Ω–æ–≤`;
                break;
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–±–∏–Ω–µ—Ç
        cabinet.tokens = newAmount;
        
        try {
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Supabase
            if (supabaseClient) {
                await supabaseClient
                    .from('player_cabinets')
                    .update({ tokens: newAmount })
                    .eq('login', cabinet.login);
            }
            
            // –ï—Å–ª–∏ —ç—Ç–æ —Ç–µ–∫—É—â–∏–π –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∏–≥—Ä–æ–∫, –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ –¥–∞–Ω–Ω—ã–µ
            if (currentLoggedInPlayer && currentLoggedInPlayer.login === cabinet.login) {
                currentLoggedInPlayer.tokens = newAmount;
                updateBetCabinetDisplay();
            }
            
            showNotification(`‚úÖ ${message}`, 'success');
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂–µ—Ç–æ–Ω–∞–º–∏:', error);
            showNotification('–û—à–∏–±–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂–µ—Ç–æ–Ω–∞–º–∏', 'error');
        }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂–µ—Ç–æ–Ω–∞–º–∏
    async function massManageTokens() {
        if (!isAdmin) {
            showNotification('‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –º–∞—Å—Å–æ–≤–æ –Ω–∞—á–∏—Å–ª—è—Ç—å –∂–µ—Ç–æ–Ω—ã!', 'error');
            return;
        }
        
        const action = document.getElementById('massTokensAction').value;
        const amount = parseInt(document.getElementById('massTokensAmount').value);
        
        if (!amount || amount < 1) {
            showNotification('–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∂–µ—Ç–æ–Ω–æ–≤!', 'error');
            return;
        }
        
        let targetCabinets = [];
        
        switch(action) {
            case 'all':
                targetCabinets = Object.values(playerCabinets);
                break;
            case 'active':
                const twoWeeksAgo = new Date();
                twoWeeksAgo.setDate(twoWeeksAgo.getDate() - 14);
                
                targetCabinets = Object.values(playerCabinets).filter(cabinet => {
                    const player = players[cabinet.playerName];
                    return player && player.lastGame && new Date(player.lastGame) >= twoWeeksAgo;
                });
                break;
            case 'inactive':
                const twoWeeksAgoInactive = new Date();
                twoWeeksAgoInactive.setDate(twoWeeksAgoInactive.getDate() - 14);
                
                targetCabinets = Object.values(playerCabinets).filter(cabinet => {
                    const player = players[cabinet.playerName];
                    return !player || !player.lastGame || new Date(player.lastGame) < twoWeeksAgoInactive;
                });
                break;
        }
        
        if (targetCabinets.length === 0) {
            showNotification('–ù–µ—Ç –∏–≥—Ä–æ–∫–æ–≤ –¥–ª—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è!', 'info');
            return;
        }
        
        try {
            for (const cabinet of targetCabinets) {
                cabinet.tokens += amount;
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Supabase
                if (supabaseClient) {
                    await supabaseClient
                        .from('player_cabinets')
                        .update({ tokens: cabinet.tokens })
                        .eq('login', cabinet.login);
                }
                
                // –ï—Å–ª–∏ —ç—Ç–æ —Ç–µ–∫—É—â–∏–π –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∏–≥—Ä–æ–∫, –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ –¥–∞–Ω–Ω—ã–µ
                if (currentLoggedInPlayer && currentLoggedInPlayer.login === cabinet.login) {
                    currentLoggedInPlayer.tokens += amount;
                }
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            if (currentLoggedInPlayer) {
                updateBetCabinetDisplay();
            }
            
            showNotification(`‚úÖ –ù–∞—á–∏—Å–ª–µ–Ω–æ ${amount} –∂–µ—Ç–æ–Ω–æ–≤ ${targetCabinets.length} –∏–≥—Ä–æ–∫–∞–º`, 'success');
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –º–∞—Å—Å–æ–≤–æ–≥–æ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∂–µ—Ç–æ–Ω–æ–≤:', error);
            showNotification('–û—à–∏–±–∫–∞ –º–∞—Å—Å–æ–≤–æ–≥–æ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∂–µ—Ç–æ–Ω–æ–≤', 'error');
        }
    }
    
    // ============================================
    // –û–ë–ù–û–í–õ–Å–ù–ù–´–ï –§–£–ù–ö–¶–ò–ò –î–õ–Ø –†–ê–ë–û–¢–´ –° –ò–ì–†–û–ö–ê–ú–ò
    // ============================================
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞
    async function addPlayer() {
        if (!isAdmin) {
            showNotification('‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –∏–≥—Ä–æ–∫–æ–≤!', 'error');
            return;
        }
        
        const name = document.getElementById('newPlayerName').value.trim();
        const login = document.getElementById('newPlayerLogin').value.trim().toLowerCase();
        const password = document.getElementById('newPlayerPassword').value;
        const avatar = document.getElementById('newPlayerAvatar').value.trim();
        const rating = parseInt(document.getElementById('newPlayerRating').value) || 1000;
        const tokens = parseInt(document.getElementById('newPlayerTokens').value) || 100;
        
        if (!name) {
            showNotification('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏–≥—Ä–æ–∫–∞!', 'error');
            return;
        }
        
        if (!login) {
            showNotification('–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –¥–ª—è –∫–∞–±–∏–Ω–µ—Ç–∞!', 'error');
            return;
        }
        
        if (players[name]) {
            showNotification('–ò–≥—Ä–æ–∫ —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!', 'error');
            return;
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ –∫–∞–±–∏–Ω–µ—Ç —Å —Ç–∞–∫–∏–º –ª–æ–≥–∏–Ω–æ–º
        if (playerCabinets[login]) {
            showNotification('–ö–∞–±–∏–Ω–µ—Ç —Å —Ç–∞–∫–∏–º –ª–æ–≥–∏–Ω–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!', 'error');
            return;
        }
        
        // –°–æ–∑–¥–∞–µ–º –∏–≥—Ä–æ–∫–∞
        const newPlayer = { 
            rating: rating, 
            matches: 0, 
            wins: 0, 
            lastGame: null, 
            joinDate: new Date(),
            penalties: 0,
            avatar: avatar || `https://i.pravatar.cc/150?img=${Math.floor(Math.random() * 70) + 1}`,
            achievement_bonuses: {}
        };
        
        players[name] = newPlayer;
        
        try {
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–≥—Ä–æ–∫–∞ –≤ Supabase
            await savePlayerToSupabase(name, newPlayer);
            
            // –°–æ–∑–¥–∞–µ–º –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
            await createPlayerCabinet(name, login, password || null, tokens);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            updatePlayerSelects();
            updateAllDisplays();
            
            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('newPlayerName').value = '';
            document.getElementById('newPlayerLogin').value = '';
            document.getElementById('newPlayerPassword').value = '';
            document.getElementById('newPlayerAvatar').value = '';
            document.getElementById('newPlayerRating').value = 1000;
            document.getElementById('newPlayerTokens').value = 100;
            
            showNotification(`‚úÖ –ò–≥—Ä–æ–∫ ${name} –¥–æ–±–∞–≤–ª–µ–Ω! –õ–æ–≥–∏–Ω: ${login}`, 'success');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–∞—Ä–æ–ª—å, –µ—Å–ª–∏ –æ–Ω –±—ã–ª —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
            if (!password) {
                const cabinet = playerCabinets[login];
                if (cabinet) {
                    alert(`‚úÖ –ò–≥—Ä–æ–∫ ${name} –¥–æ–±–∞–≤–ª–µ–Ω!\n\n–õ–æ–≥–∏–Ω: ${login}\n–ü–∞—Ä–æ–ª—å: ${cabinet.password}\n\n–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ!`);
                }
            }
            
            setTimeout(applyAchievementBonuses, 500);
            
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞:', error);
            showNotification('‚ùå –û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞', 'error');
            
            // –û—Ç–∫–∞—Ç—ã–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–µ
            delete players[name];
            delete playerCabinets[login];
        }
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞
    async function removePlayer(name) {
        if (!isAdmin) {
            showNotification('‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å –∏–≥—Ä–æ–∫–æ–≤!', 'error');
            return;
        }
        
        if (!confirm(`–£–¥–∞–ª–∏—Ç—å –∏–≥—Ä–æ–∫–∞ ${name}? –í—Å–µ –µ–≥–æ –º–∞—Ç—á–∏, —Å—Ç–∞–≤–∫–∏ –∏ –∫–∞–±–∏–Ω–µ—Ç —Ç–∞–∫–∂–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.`)) return;
        
        // –ù–∞—Ö–æ–¥–∏–º –∫–∞–±–∏–Ω–µ—Ç –∏–≥—Ä–æ–∫–∞
        const cabinet = Object.values(playerCabinets).find(c => c.playerName === name);
        
        // –£–¥–∞–ª—è–µ–º –∏–≥—Ä–æ–∫–∞
        delete players[name];
        
        // –£–¥–∞–ª—è–µ–º –º–∞—Ç—á–∏ –∏–≥—Ä–æ–∫–∞
        matches = matches.filter(m => m.player1 !== name && m.player2 !== name);
        
        // –£–¥–∞–ª—è–µ–º —à—Ç—Ä–∞—Ñ—ã –∏–≥—Ä–æ–∫–∞
        penaltyLog = penaltyLog.filter(p => p.player !== name);
        
        // –£–¥–∞–ª—è–µ–º –∫–∞–±–∏–Ω–µ—Ç –∏–≥—Ä–æ–∫–∞
        if (cabinet) {
            delete playerCabinets[cabinet.login];
            
            // –£–¥–∞–ª—è–µ–º —Å—Ç–∞–≤–∫–∏ –∏–≥—Ä–æ–∫–∞
            betHistory = betHistory.filter(b => b.playerName !== name);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –º–∞—Ç—á–∏ –¥–ª—è —Å—Ç–∞–≤–æ–∫
            for (const match of betMatches) {
                match.bets = match.bets.filter(b => b.playerName !== name);
                match.totalBets = match.bets.length;
                match.totalAmount = match.bets.reduce((sum, bet) => sum + bet.amount, 0);
            }
        }
        
        // –ï—Å–ª–∏ —É–¥–∞–ª–µ–Ω–Ω—ã–π –∏–≥—Ä–æ–∫ –±—ã–ª –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –≤—ã—Ö–æ–¥–∏–º –∏–∑ –µ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞
        if (currentLoggedInPlayer && currentLoggedInPlayer.playerName === name) {
            logoutFromBetCabinet();
        }
        
        // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
        await loadAllData();
        
        updatePlayerSelects();
        updateAllDisplays();
        showNotification(`‚úÖ –ò–≥—Ä–æ–∫ ${name} —É–¥–∞–ª–µ–Ω!`, 'success');
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–≥—Ä–æ–∫–∞
    function showPlayerProfile(playerName) {
        if (!players[playerName]) {
            showNotification('–ò–≥—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
            return;
        }
        
        const playerData = players[playerName];
        
        // –°–∫—Ä—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–≥—Ä–æ–∫–∞
        document.getElementById('appContainer').style.display = 'none';
        document.getElementById('playerProfileContainer').style.display = 'block';
        
        // –ó–∞–ø–æ–ª–Ω—è–µ–º –æ—Å–Ω–æ–≤–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
        document.getElementById('playerProfileName').textContent = playerName;
        document.getElementById('playerProfileAvatar').src = playerData.avatar;
        document.getElementById('playerProfileRating').textContent = `–†–µ–π—Ç–∏–Ω–≥: ${playerData.rating} –æ—á–∫–æ–≤`;
        
        // –î–æ–±–∞–≤–ª—è–µ–º —ç–º–æ–¥–∑–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        const emojisContainer = document.getElementById('playerProfileEmojis');
        emojisContainer.innerHTML = getAchievementEmojis(playerData.rating);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ
        const cabinet = Object.values(playerCabinets).find(c => c.playerName === playerName);
        if (cabinet) {
            document.getElementById('cabinetName').textContent = playerName;
            document.getElementById('cabinetRating').textContent = playerData.rating;
            document.getElementById('cabinetTokens').textContent = cabinet.tokens;
            document.getElementById('cabinetAvatar').src = playerData.avatar;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            const winRate = cabinet.betsMade > 0 ? Math.round((cabinet.betsWon / cabinet.betsMade) * 100) : 0;
            document.getElementById('cabinetBetsMade').textContent = cabinet.betsMade;
            document.getElementById('cabinetBetsWon').textContent = cabinet.betsWon;
            document.getElementById('cabinetTotalWon').textContent = cabinet.totalWon;
            document.getElementById('cabinetWinRate').textContent = `${winRate}%`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏—Å—Ç–æ—Ä–∏—é —Å—Ç–∞–≤–æ–∫
            updatePlayerBetHistoryForProfile(cabinet);
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –º–∞–≥–∞–∑–∏–Ω
        updateLeagueShopForProfile(cabinet);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        updatePlayerStats(playerName);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
        updatePlayerAchievements(playerName);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç—É—Ä–Ω–∏—Ä–Ω—ã—Ö –ø–æ–±–µ–¥–∞—Ö
        updatePlayerTournamentWins(playerName);
        
        // –°—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫ —Ñ–æ—Ä–º—ã
        renderPlayerFormChart(playerName);
        
        // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–≤–µ—Ä—Ö —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.scrollTo(0, 0);
    }
    
    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ —Å—Ç–∞–≤–æ–∫ –≤ –ø—Ä–æ—Ñ–∏–ª–µ
    function updatePlayerBetHistoryForProfile(cabinet) {
        const tbody = document.getElementById('betHistoryBody');
        if (!tbody) return;
        
        const playerBets = cabinet.betHistory
            .sort((a, b) => new Date(b.placedAt) - new Date(a.placedAt))
            .slice(0, 20);
        
        if (playerBets.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="6" style="text-align: center; padding: 20px;">
                        –ò–≥—Ä–æ–∫ –µ—â–µ –Ω–µ –¥–µ–ª–∞–ª —Å—Ç–∞–≤–æ–∫
                    </td>
                </tr>
            `;
            return;
        }
        
        let html = '';
        
        playerBets.forEach(bet => {
            const match = betMatches.find(m => m.id === bet.matchId);
            if (!match) return;
            
            let statusClass = '';
            let statusText = '';
            
            switch(bet.status) {
                case 'pending':
                    statusClass = 'pending';
                    statusText = '‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ';
                    break;
                case 'won':
                    statusClass = 'won';
                    statusText = '‚úÖ –í—ã–∏–≥—Ä–∞–Ω–æ';
                    break;
                case 'lost':
                    statusClass = 'lost';
                    statusText = '‚ùå –ü—Ä–æ–∏–≥—Ä–∞–Ω–æ';
                    break;
                case 'draw':
                    statusClass = '';
                    statusText = 'ü§ù –ù–∏—á—å—è';
                    break;
                case 'cancelled':
                    statusClass = '';
                    statusText = 'üö´ –û—Ç–º–µ–Ω–µ–Ω–æ';
                    break;
            }
            
            html += `
                <tr>
                    <td>${new Date(bet.placedAt).toLocaleDateString('ru-RU')}</td>
                    <td>${match.player1} vs ${match.player2}</td>
                    <td>${bet.betOn === 'player1' ? match.player1 : match.player2}</td>
                    <td>${bet.odds.toFixed(2)}</td>
                    <td><span class="${statusClass}">${statusText}</span></td>
                    <td>
                        ${bet.status === 'won' ? `<span style="color: #4CAF50; font-weight: bold;">+${bet.winAmount} ü™ô</span>` : 
                          bet.status === 'draw' || bet.status === 'cancelled' ? `<span>${bet.amount} ü™ô</span>` :
                          `<span style="color: #f44336;">-${bet.amount} ü™ô</span>`}
                    </td>
                </tr>
            `;
        });
        
        tbody.innerHTML = html;
    }
    
    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–∞–≥–∞–∑–∏–Ω–∞ –≤ –ø—Ä–æ—Ñ–∏–ª–µ
    function updateLeagueShopForProfile(cabinet) {
        const container = document.getElementById('leagueShop');
        if (!container) return;
        
        let html = '';
        
        leagueShop.forEach(item => {
            const canAfford = cabinet && cabinet.tokens >= item.price;
            const hasPurchased = cabinet && cabinet.shopPurchases && cabinet.shopPurchases.includes(item.id);
            
            html += `
                <div class="shop-item">
                    <div class="shop-icon">${item.icon}</div>
                    <div class="shop-title">${item.title}</div>
                    <div class="shop-description">${item.description}</div>
                    <div class="shop-price">${item.price} ü™ô</div>
                    ${hasPurchased ? 
                        '<div style="color: #4CAF50; font-weight: bold;">‚úÖ –ö—É–ø–ª–µ–Ω–æ</div>' :
                        `<button class="buy-btn" 
                                onclick="buyShopItemFromProfile('${item.id}', '${cabinet ? cabinet.login : ''}')"
                                ${!cabinet || !canAfford ? 'disabled' : ''}>
                            ${canAfford ? '–ö—É–ø–∏—Ç—å' : '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∂–µ—Ç–æ–Ω–æ–≤'}
                        </button>`
                    }
                </div>
            `;
        });
        
        container.innerHTML = html;
    }
    
    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∞)
    async function buyShopItemFromProfile(itemId, playerLogin) {
        if (!isAdmin) {
            showNotification('‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –ø–æ–∫—É–ø–∞—Ç—å —Ç–æ–≤–∞—Ä—ã –¥–ª—è –¥—Ä—É–≥–∏—Ö –∏–≥—Ä–æ–∫–æ–≤!', 'error');
            return;
        }
        
        if (!playerLogin) {
            showNotification('–ò–≥—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
            return;
        }
        
        const cabinet = playerCabinets[playerLogin];
        if (!cabinet) {
            showNotification('–ö–∞–±–∏–Ω–µ—Ç –∏–≥—Ä–æ–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
            return;
        }
        
        const item = leagueShop.find(i => i.id === itemId);
        if (!item) {
            showNotification('–¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
            return;
        }
        
        if (cabinet.tokens < item.price) {
            showNotification('–£ –∏–≥—Ä–æ–∫–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∂–µ—Ç–æ–Ω–æ–≤!', 'error');
            return;
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –ø–æ–∫—É–ø–∞–ª –ª–∏ —É–∂–µ –∏–≥—Ä–æ–∫ —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä
        if (cabinet.shopPurchases && cabinet.shopPurchases.includes(itemId)) {
            showNotification('–ò–≥—Ä–æ–∫ —É–∂–µ –ø–æ–∫—É–ø–∞–ª —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä!', 'error');
            return;
        }
        
        // –°–ø–∏—Å—ã–≤–∞–µ–º –∂–µ—Ç–æ–Ω—ã
        cabinet.tokens -= item.price;
        
        // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–∫—É–ø–∫—É –≤ –∏—Å—Ç–æ—Ä–∏—é
        if (!cabinet.shopPurchases) {
            cabinet.shopPurchases = [];
        }
        cabinet.shopPurchases.push(itemId);
        
        try {
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Supabase
            if (supabaseClient) {
                await supabaseClient
                    .from('player_cabinets')
                    .update({
                        tokens: cabinet.tokens,
                        shop_purchases: cabinet.shopPurchases
                    })
                    .eq('login', cabinet.login);
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            updateLeagueShopForProfile(cabinet);
            
            showNotification(`‚úÖ –¢–æ–≤–∞—Ä –∫—É–ø–ª–µ–Ω –¥–ª—è –∏–≥—Ä–æ–∫–∞ ${cabinet.playerName}!`, 'success');
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏ —Ç–æ–≤–∞—Ä–∞:', error);
            showNotification('–û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏ —Ç–æ–≤–∞—Ä–∞', 'error');
        }
    }
    
    // ============================================
    // –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–• –î–õ–Ø –°–ò–°–¢–ï–ú–´ –°–¢–ê–í–û–ö
    // ============================================
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
    async function loadAllData() {
        if (!supabaseClient) {
            console.log('üîÑ Supabase –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω, –ø—Ä–æ–±—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å...');
            await initSupabase();
            return;
        }
        
        try {
            console.log('üîÑ –ó–∞–≥—Ä—É–∂–∞—é –¥–∞–Ω–Ω—ã–µ –∏–∑ Supabase...');
            updateSupabaseStatus('üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è...');
            document.getElementById('refreshBtn').disabled = true;
            document.getElementById('refreshBtn').classList.add('loading');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–≥—Ä–æ–∫–æ–≤
            const { data: playersData, error: playersError } = await supabaseClient
                .from('players')
                .select('*')
                .order('rating', { ascending: false });
            
            if (playersError) {
                if (playersError.message.includes('does not exist')) {
                    console.log('‚ö†Ô∏è –¢–∞–±–ª–∏—Ü–∞ players –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç');
                    updateSupabaseStatus('‚ö†Ô∏è –ù–µ—Ç —Ç–∞–±–ª–∏—Ü');
                } else {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä–æ–∫–æ–≤:', playersError);
                    updateSupabaseStatus('‚ùå –û—à–∏–±–∫–∞ –¥–∞–Ω–Ω—ã—Ö');
                }
            } else if (playersData) {
                const newPlayers = {};
                playersData.forEach(player => {
                    newPlayers[player.name] = {
                        id: player.id,
                        rating: player.rating || 1000,
                        matches: player.matches || 0,
                        wins: player.wins || 0,
                        lastGame: player.last_game ? new Date(player.last_game) : null,
                        joinDate: player.join_date ? new Date(player.join_date) : new Date(),
                        penalties: player.penalties || 0,
                        avatar: player.avatar || `https://i.pravatar.cc/150?img=${Math.floor(Math.random() * 70) + 1}`,
                        achievement_bonuses: player.achievement_bonuses || {},
                        created_at: player.created_at
                    };
                });
                players = newPlayers;
                console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${playersData.length} –∏–≥—Ä–æ–∫–æ–≤`);
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –º–∞—Ç—á–∏
            const { data: matchesData, error: matchesError } = await supabaseClient
                .from('matches')
                .select('*')
                .order('date', { ascending: false });
            
            if (matchesError && !matchesError.message.includes('does not exist')) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–∞—Ç—á–µ–π:', matchesError);
            } else if (matchesData) {
                matches = matchesData.map(match => ({
                    id: match.id,
                    date: new Date(match.date),
                    player1: match.player1,
                    player2: match.player2,
                    winner: match.winner,
                    change1: match.change1 || 0,
                    change2: match.change2 || 0,
                    score: match.score || ''
                }));
                console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${matchesData.length} –º–∞—Ç—á–µ–π`);
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —à—Ç—Ä–∞—Ñ—ã
            const { data: penaltiesData, error: penaltiesError } = await supabaseClient
                .from('penalties')
                .select('*')
                .order('date', { ascending: false });
            
            if (penaltiesError && !penaltiesError.message.includes('does not exist')) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —à—Ç—Ä–∞—Ñ–æ–≤:', penaltiesError);
            } else if (penaltiesData) {
                penaltyLog = penaltiesData.map(penalty => ({
                    id: penalty.id,
                    date: new Date(penalty.date),
                    player: penalty.player,
                    amount: penalty.amount || 0,
                    daysInactive: penalty.days_inactive || 0,
                    manual: penalty.manual || false
                }));
                console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${penaltiesData.length} —à—Ç—Ä–∞—Ñ–æ–≤`);
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç—É—Ä–Ω–∏—Ä—ã
            await loadTournaments();
            
            // –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–• –î–õ–Ø –°–ò–°–¢–ï–ú–´ –°–¢–ê–í–û–ö
            console.log('üîÑ –ó–∞–≥—Ä—É–∂–∞—é –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã —Å—Ç–∞–≤–æ–∫...');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –ª–∏—á–Ω—ã–µ –∫–∞–±–∏–Ω–µ—Ç—ã
            const { data: cabinetsData, error: cabinetsError } = await supabaseClient
                .from('player_cabinets')
                .select('*');
            
            if (cabinetsError && !cabinetsError.message.includes('does not exist')) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞–±–∏–Ω–µ—Ç–æ–≤:', cabinetsError);
            } else if (cabinetsData) {
                playerCabinets = {};
                cabinetsData.forEach(cabinet => {
                    playerCabinets[cabinet.login] = {
                        playerName: cabinet.player_name,
                        login: cabinet.login,
                        password: cabinet.password,
                        tokens: cabinet.tokens || 0,
                        betsMade: cabinet.bets_made || 0,
                        betsWon: cabinet.bets_won || 0,
                        totalWon: cabinet.total_won || 0,
                        betHistory: cabinet.bet_history || [],
                        joinDate: cabinet.join_date,
                        lastLogin: cabinet.last_login,
                        shopPurchases: cabinet.shop_purchases || []
                    };
                });
                console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${cabinetsData.length} –∫–∞–±–∏–Ω–µ—Ç–æ–≤`);
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –º–∞—Ç—á–∏ –¥–ª—è —Å—Ç–∞–≤–æ–∫
            const { data: betMatchesData, error: betMatchesError } = await supabaseClient
                .from('bet_matches')
                .select('*')
                .order('date', { ascending: false });
            
            if (betMatchesError && !betMatchesError.message.includes('does not exist')) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–∞—Ç—á–µ–π –¥–ª—è —Å—Ç–∞–≤–æ–∫:', betMatchesError);
            } else if (betMatchesData) {
                betMatches = betMatchesData.map(match => ({
                    id: match.id,
                    player1: match.player1,
                    player2: match.player2,
                    player1Rating: match.player1_rating,
                    player2Rating: match.player2_rating,
                    description: match.description,
                    date: match.date,
                    status: match.status,
                    odds: match.odds,
                    result: match.result,
                    totalBets: match.total_bets || 0,
                    totalAmount: match.total_amount || 0,
                    bets: match.bets || []
                }));
                console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${betMatchesData.length} –º–∞—Ç—á–µ–π –¥–ª—è —Å—Ç–∞–≤–æ–∫`);
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é —Å—Ç–∞–≤–æ–∫
            const { data: betHistoryData, error: betHistoryError } = await supabaseClient
                .from('bet_history')
                .select('*')
                .order('placed_at', { ascending: false });
            
            if (betHistoryError && !betHistoryError.message.includes('does not exist')) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏ —Å—Ç–∞–≤–æ–∫:', betHistoryError);
            } else if (betHistoryData) {
                betHistory = betHistoryData.map(bet => ({
                    id: bet.id,
                    matchId: bet.match_id,
                    playerLogin: bet.player_login,
                    playerName: bet.player_name,
                    betOn: bet.bet_on,
                    amount: bet.amount,
                    odds: bet.odds,
                    potentialWin: bet.potential_win,
                    status: bet.status,
                    placedAt: bet.placed_at,
                    result: bet.result,
                    winAmount: bet.win_amount
                }));
                console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${betHistoryData.length} —Å—Ç–∞–≤–æ–∫`);
            }
            
            console.log('‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ Supabase');
            updateSupabaseStatus('‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ');
            updateSupabaseTime();
            
            updateAllDisplays();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ–≤—Ö–æ–¥
            checkAutoLoginForBets();
            
            if (isAdmin) {
                setTimeout(applyAchievementBonuses, 1000);
            }
            
        } catch (error) {
            console.error('‚ùå –û–±—â–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
            updateSupabaseStatus('‚ùå –û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏');
        } finally {
            document.getElementById('refreshBtn').disabled = false;
            document.getElementById('refreshBtn').classList.remove('loading');
        }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ–≤—Ö–æ–¥–∞ –≤ –∫–∞–±–∏–Ω–µ—Ç
    function checkAutoLoginForBets() {
        try {
            const saved = localStorage.getItem('currentLoggedInPlayer');
            if (saved) {
                const data = JSON.parse(saved);
                const login = data.login;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø—Ä–æ—à–ª–æ –ª–∏ –º–µ–Ω–µ–µ 1 —á–∞—Å–∞ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤—Ö–æ–¥–∞
                if (Date.now() - data.timestamp < 60 * 60 * 1000) {
                    // –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ –∫–∞–±–∏–Ω–µ—Ç
                    const cabinet = playerCabinets[login];
                    if (cabinet) {
                        currentLoggedInPlayer = cabinet;
                        updateBetCabinetDisplay();
                        document.getElementById('betsLoginPanel').style.display = 'none';
                        document.getElementById('currentPlayerCabinet').style.display = 'block';
                        document.querySelector('#betsLoginPanel .logout-btn').style.display = 'block';
                        console.log(`‚úÖ –ê–≤—Ç–æ–≤—Ö–æ–¥ –≤ –∫–∞–±–∏–Ω–µ—Ç ${login}`);
                    }
                }
            }
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ–≤—Ö–æ–¥–∞:', error);
        }
    }
    
    // ============================================
    // –û–ë–ù–û–í–õ–Å–ù–ù–´–ï –§–£–ù–ö–¶–ò–ò –û–¢–û–ë–†–ê–ñ–ï–ù–ò–Ø
    // ============================================
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –∏–≥—Ä–æ–∫–æ–≤
    function updatePlayersTable() {
        const tbody = document.getElementById('playersBody');
        if (!tbody) return;
        
        tbody.innerHTML = '';
        
        const playerList = Object.entries(players);
        if (playerList.length === 0) return;
        
        playerList.forEach(([name, data]) => {
            const row = document.createElement('tr');
            
            const nameLength = name.length;
            const nameClass = nameLength > 20 ? 'long-name' : '';
            
            // –ù–∞—Ö–æ–¥–∏–º –∫–∞–±–∏–Ω–µ—Ç –∏–≥—Ä–æ–∫–∞
            const cabinet = Object.values(playerCabinets).find(c => c.playerName === name);
            const tokens = cabinet ? cabinet.tokens : 0;
            
            const actionsCell = isAdmin ? 
                `<td>
                    <button class="action-btn" onclick="changeAvatar('${name}')" title="–°–º–µ–Ω–∏—Ç—å –∞–≤–∞—Ç–∞—Ä" style="background: #2196F3; margin-right: 5px;">üñºÔ∏è</button>
                    <button class="delete-btn action-btn" onclick="removePlayer('${name}')" title="–£–¥–∞–ª–∏—Ç—å –∏–≥—Ä–æ–∫–∞">üóëÔ∏è</button>
                </td>` :
                `<td>-</td>`;
            
            row.innerHTML = `
                <td><img src="${data.avatar}" class="avatar" 
                       onerror="this.src='https://i.pravatar.cc/150?img=3'}" onclick="showPlayerProfile('${name}')" style="cursor: pointer;"></td>
                <td><span class="${nameClass}" onclick="showPlayerProfile('${name}')" style="cursor: pointer; text-decoration: underline; color: #4CAF50;">${name}</span></td>
                <td><span class="rating-badge">${data.rating}</span></td>
                <td>${data.matches}</td>
                <td>${data.wins} (${data.matches ? Math.round(data.wins/data.matches*100) : 0}%)</td>
                <td><span style="color: #4CAF50; font-weight: bold;">${tokens} ü™ô</span></td>
                ${actionsCell}
            `;
            tbody.appendChild(row);
        });
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
    function updatePlayerSelects() {
        const selects = ['player1', 'player2', 'statsPlayerSelect', 'comparePlayer1', 'comparePlayer2', 
                         'betPlayer1', 'betPlayer2', 'tokensPlayerSelect'];
        const playerNames = Object.keys(players).sort();
        
        selects.forEach(selectId => {
            const select = document.getElementById(selectId);
            if (!select) return;
            
            const currentValue = select.value;
            
            select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞</option>';
            
            playerNames.forEach(name => {
                const option = document.createElement('option');
                option.value = name;
                option.textContent = name;
                select.appendChild(option);
            });
            
            if (players[currentValue]) {
                select.value = currentValue;
            }
        });
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è –≤–∫–ª–∞–¥–∫–∏
    function openTab(tabName) {
        document.querySelectorAll('.tab-content').forEach(tab => {
            tab.classList.remove('active');
        });
        
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        
        const tabElement = document.getElementById(tabName);
        if (tabElement) {
            tabElement.classList.add('active');
        }
        
        const activeButton = document.querySelector(`.tab-btn[onclick*="${tabName}"]`);
        if (activeButton) {
            activeButton.classList.add('active');
        }
        
        if (tabName === 'stats') {
            setTimeout(() => {
                updateYearProgressChart();
            }, 100);
        } else if (tabName === 'tournaments') {
            setTimeout(() => {
                updateTournamentsDisplay();
                updateTournamentPlayersList();
            }, 100);
        } else if (tabName === 'bets') {
            setTimeout(() => {
                updateActiveBetsDisplay();
                updateAllBetsHistory();
                updateBetCabinetDisplay();
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
                document.getElementById('betsAdminControls').style.display = isAdmin ? 'block' : 'none';
                document.getElementById('tokensAdminControls').style.display = isAdmin ? 'block' : 'none';
            }, 100);
        }
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö –¥–∏—Å–ø–ª–µ–µ–≤
    function updateAllDisplays() {
        updateRatingTable();
        updateMatchesTable();
        updatePlayersTable();
        updatePenaltiesHistory();
        updatePeriodStats();
        updateYearProgressChart();
        updatePlayerSelects();
        updateAchievementsDisplay();
        updateTournamentsDisplay();
        updateTournamentPlayersList();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã —Å—Ç–∞–≤–æ–∫
        if (currentLoggedInPlayer) {
            updateBetCabinetDisplay();
            updatePlayerBetHistory();
        }
        updateActiveBetsDisplay();
        updateAllBetsHistory();
    }
    
    // ============================================
    // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
    // ============================================
    
    // –î–û–ë–ê–í–õ–ï–ù–ê –§–£–ù–ö–¶–ò–Ø –î–õ–Ø –ê–í–¢–û–í–•–û–î–ê –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–ê
    function checkAutoLogin() {
        try {
            const saved = localStorage.getItem('adminLoggedIn');
            if (saved) {
                const data = JSON.parse(saved);
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø—Ä–æ—à–ª–æ –ª–∏ –º–µ–Ω–µ–µ 24 —á–∞—Å–æ–≤ —Å –º–æ–º–µ–Ω—Ç–∞ –≤—Ö–æ–¥–∞
                if (Date.now() - data.timestamp < 24 * 60 * 60 * 1000) {
                    isAdmin = true;
                    document.getElementById('adminPanel').style.display = 'block';
                    document.getElementById('loginPanel').style.display = 'none';
                    document.getElementById('ratingAdminControls').style.display = 'block';
                    document.getElementById('matchesAdminControls').style.display = 'block';
                    document.getElementById('playersAdminControls').style.display = 'block';
                    document.getElementById('penaltiesAdminControls').style.display = 'block';
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –¥–ª—è —Å—Ç–∞–≤–æ–∫
                    if (document.getElementById('betsAdminControls')) {
                        document.getElementById('betsAdminControls').style.display = 'block';
                    }
                    if (document.getElementById('tokensAdminControls')) {
                        document.getElementById('tokensAdminControls').style.display = 'block';
                    }
                    
                    console.log('‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä');
                } else {
                    // –ò—Å—Ç–µ–∫ —Å—Ä–æ–∫, —É–¥–∞–ª—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                    localStorage.removeItem('adminLoggedIn');
                }
            }
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ–≤—Ö–æ–¥–∞:', error);
        }
    }
    
    async function init() {
        console.log('üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
        
        checkAutoLogin(); // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–≤—Ö–æ–¥–∞ –∞–¥–º–∏–Ω–∞
        
        setMatchDateToToday();
        
        await initSupabase();
        
        updatePlayerSelects();
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–≤—Ö–æ–¥–∞ –≤ –∫–∞–±–∏–Ω–µ—Ç —Å—Ç–∞–≤–æ–∫
        if (typeof checkAutoLoginForBets === 'function') {
            checkAutoLoginForBets();
        }
        
        console.log('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ');
    }
    
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
    } else {
        init();
    }
    
    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    function showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        notification.textContent = message;
        notification.className = `notification ${type}`;
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
            if (notification.parentNode) {
                notification.parentNode.removeChild(notification);
            }
        }, 3000);
    }
    
    // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è—à–Ω—é—é –¥–∞—Ç—É –¥–ª—è –º–∞—Ç—á–∞
    function setMatchDateToToday() {
        const today = new Date().toISOString().split('T')[0];
        const dateInput = document.getElementById('matchDate');
        if (dateInput) {
            dateInput.value = today;
            dateInput.min = '2020-01-01';
            dateInput.max = today;
        }
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º CSS –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    const style = document.createElement('style');
    style.textContent = `
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
    `;
    document.head.appendChild(style);
    
    // ============================================
    // –û–°–¢–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò (–ò–ó –ò–°–•–û–î–ù–û–ì–û –ö–û–î–ê)
    // ============================================
    
    // –≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –≤–∞—à–µ–º –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ, —è –¥–æ–±–∞–≤–ª—è—é –∏—Ö –¥–ª—è –ø–æ–ª–Ω–æ—Ç—ã
    async function initSupabase() {
        // –§—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Supabase
    }
    
    function updateSupabaseStatus(status) {
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ Supabase
    }
    
    function updateSupabaseTime() {
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
    }
    
    function updateRatingTable() {
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Ä–µ–π—Ç–∏–Ω–≥–∞
    }
    
    function updateMatchesTable() {
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –º–∞—Ç—á–µ–π
    }
    
    function updatePenaltiesHistory() {
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —à—Ç—Ä–∞—Ñ–æ–≤
    }
    
    function updatePeriodStats() {
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º
    }
    
    function updateYearProgressChart() {
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –≥–æ–¥–∞
    }
    
    function updateAchievementsDisplay() {
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
    }
    
    function updateTournamentsDisplay() {
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–æ–≤
    }
    
    function updateTournamentPlayersList() {
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–≥—Ä–æ–∫–æ–≤ —Ç—É—Ä–Ω–∏—Ä–∞
    }
    
    function returnToMain() {
        // –í–æ–∑–≤—Ä–∞—Ç –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É —ç–∫—Ä–∞–Ω—É
    }
    
    function addMatch() {
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç—á–∞
    }
    
    function toggleTournamentGenerator() {
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ —Ç—É—Ä–Ω–∏—Ä–æ–≤
    }
    
    function generateTournament() {
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç—É—Ä–Ω–∏—Ä–∞
    }
    
    function checkAndApplyPenalties() {
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —à—Ç—Ä–∞—Ñ–æ–≤
    }
    
    function saveManualRatings() {
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä—É—á–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥–∞
    }
    
    function loadTournaments() {
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç—É—Ä–Ω–∏—Ä–æ–≤
    }
    
    function savePlayerToSupabase(name, playerData) {
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞ –≤ Supabase
    }
    
    function applyAchievementBonuses() {
        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
    }
    
    function getAchievementEmojis(rating) {
        // –ü–æ–ª—É—á–µ–Ω–∏–µ —ç–º–æ–¥–∑–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
    }
    
    function updatePlayerStats(playerName) {
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏–≥—Ä–æ–∫–∞
    }
    
    function updatePlayerAchievements(playerName) {
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –∏–≥—Ä–æ–∫–∞
    }
    
    function updatePlayerTournamentWins(playerName) {
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–Ω—ã—Ö –ø–æ–±–µ–¥ –∏–≥—Ä–æ–∫–∞
    }
    
    function renderPlayerFormChart(playerName) {
        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≥—Ä–∞—Ñ–∏–∫–∞ —Ñ–æ—Ä–º—ã –∏–≥—Ä–æ–∫–∞
    }
    
    function changeAvatar(name) {
        // –°–º–µ–Ω–∞ –∞–≤–∞—Ç–∞—Ä–∞
    }
    
    function comparePlayers() {
        // –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤
    }
    
    function loginAdmin() {
        // –í—Ö–æ–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        const password = document.getElementById('adminPassword').value;
        if (password === ADMIN_PASSWORD) {
            isAdmin = true;
            localStorage.setItem('adminLoggedIn', JSON.stringify({
                timestamp: Date.now()
            }));
            document.getElementById('adminPanel').style.display = 'block';
            document.getElementById('loginPanel').style.display = 'none';
            document.getElementById('ratingAdminControls').style.display = 'block';
            document.getElementById('matchesAdminControls').style.display = 'block';
            document.getElementById('playersAdminControls').style.display = 'block';
            document.getElementById('penaltiesAdminControls').style.display = 'block';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –¥–ª—è —Å—Ç–∞–≤–æ–∫
            if (document.getElementById('betsAdminControls')) {
                document.getElementById('betsAdminControls').style.display = 'block';
            }
            if (document.getElementById('tokensAdminControls')) {
                document.getElementById('tokensAdminControls').style.display = 'block';
            }
            
            showNotification('‚úÖ –í—Ö–æ–¥ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤—ã–ø–æ–ª–Ω–µ–Ω!', 'success');
        } else {
            showNotification('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!', 'error');
        }
    }
    
    function logoutAdmin() {
        // –í—ã—Ö–æ–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        isAdmin = false;
        localStorage.removeItem('adminLoggedIn');
        document.getElementById('adminPanel').style.display = 'none';
        document.getElementById('loginPanel').style.display = 'block';
        document.getElementById('ratingAdminControls').style.display = 'none';
        document.getElementById('matchesAdminControls').style.display = 'none';
        document.getElementById('playersAdminControls').style.display = 'none';
        document.getElementById('penaltiesAdminControls').style.display = 'none';
        
        // –°–∫—Ä—ã–≤–∞–µ–º –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –¥–ª—è —Å—Ç–∞–≤–æ–∫
        if (document.getElementById('betsAdminControls')) {
            document.getElementById('betsAdminControls').style.display = 'none';
        }
        if (document.getElementById('tokensAdminControls')) {
            document.getElementById('tokensAdminControls').style.display = 'none';
        }
        
        showNotification('üëã –í—ã—Ö–æ–¥ –∏–∑ –∞–¥–º–∏–Ω-—Ä–µ–∂–∏–º–∞', 'info');
    }
    </script>
</body>
</html>
