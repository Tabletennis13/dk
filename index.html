<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>–†–µ–π—Ç–∏–Ω–≥ —Ç–µ–Ω–Ω–∏—Å–∞</title>
    <style>
        /* –í—Å–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π - —Å–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π CSS */
        .bets-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .bets-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            gap: 10px;
        }
        
        .bets-header h3 {
            font-size: 1.4em;
            margin: 0;
        }
        
        .bets-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        @media (min-width: 768px) {
            .bets-grid {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        .bet-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease;
        }
        
        .bet-card:hover {
            transform: translateY(-3px);
            background: rgba(255, 255, 255, 0.15);
        }
        
        .bet-match-info {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .bet-player {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }
        
        .bet-player.winner {
            background: rgba(76, 175, 80, 0.2);
            border-left: 4px solid #4CAF50;
        }
        
        .bet-player-info {
            flex: 1;
        }
        
        .bet-player-name {
            font-weight: bold;
            font-size: 1.1em;
        }
        
        .bet-player-rating {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .bet-odds {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }
        
        .odds-item {
            text-align: center;
            flex: 1;
        }
        
        .odds-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #4CAF50;
        }
        
        .odds-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .bet-form {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }
        
        .bet-amount-input {
            padding: 10px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            font-size: 1em;
            text-align: center;
        }
        
        .bet-buttons {
            display: flex;
            gap: 10px;
        }
        
        .bet-btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .bet-btn-player1 {
            background: #4CAF50;
            color: white;
        }
        
        .bet-btn-player2 {
            background: #2196F3;
            color: white;
        }
        
        .bet-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        
        .bet-status {
            margin-top: 10px;
            padding: 8px;
            border-radius: 6px;
            text-align: center;
            font-size: 0.9em;
        }
        
        .bet-status.won {
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
        }
        
        .bet-status.lost {
            background: rgba(244, 67, 54, 0.2);
            color: #f44336;
        }
        
        .bet-status.pending {
            background: rgba(255, 152, 0, 0.2);
            color: #ff9800;
        }
        
        .player-cabinet-container {
            padding: 20px;
            background: white;
            border-radius: 12px;
            margin: 20px 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border: 2px solid #4CAF50;
        }
        
        .cabinet-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .cabinet-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #4CAF50;
        }
        
        .cabinet-info {
            flex: 1;
        }
        
        .cabinet-name {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
        }
        
        .cabinet-rating {
            font-size: 1.2em;
            color: #4CAF50;
            font-weight: bold;
        }
        
        .cabinet-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .cabinet-stat {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9em;
            color: #666;
        }
        
        .cabinet-section {
            margin: 25px 0;
        }
        
        .cabinet-section h4 {
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #4CAF50;
            font-size: 1.2em;
        }
        
        .bet-history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .bet-history-table th {
            background: #4CAF50;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }
        
        .bet-history-table td {
            padding: 10px;
            border-bottom: 1px solid #eee;
            font-size: 0.9em;
        }
        
        .bet-history-table tr:hover {
            background: #f9f9f9;
        }
        
        .shop-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .shop-item {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .shop-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.15);
            border-color: #4CAF50;
        }
        
        .shop-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
        }
        
        .shop-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        
        .shop-price {
            font-size: 1.2em;
            color: #4CAF50;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .shop-description {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 15px;
            min-height: 40px;
        }
        
        .buy-btn {
            padding: 10px 20px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }
        
        .buy-btn:hover {
            background: #45a049;
        }
        
        .buy-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 16px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            z-index: 1000;
            animation: slideIn 0.3s ease, fadeOut 0.3s ease 2.7s;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            max-width: calc(100vw - 40px);
            font-size: 14px;
        }
        
        .notification.success {
            background: #4CAF50;
        }
        
        .notification.error {
            background: #f44336;
        }
        
        .notification.warning {
            background: #ff9800;
        }
        
        .notification.info {
            background: #2196F3;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        
        .match-live-badge {
            background: #f44336;
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            animation: pulse 2s infinite;
            display: inline-block;
            margin-left: 10px;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.6; }
            100% { opacity: 1; }
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 8px;
            -webkit-text-size-adjust: 100%;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        h1 {
            margin: 0;
            font-size: 2em;
        }
        
        .header-subtitle {
            opacity: 0.9;
            margin-top: 5px;
        }
        
        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            overflow-x: auto;
        }
        
        .tab-btn {
            padding: 12px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 0.95em;
            white-space: nowrap;
            transition: all 0.3s;
        }
        
        .tab-btn.active {
            background: white;
            border-bottom: 3px solid #4CAF50;
            font-weight: bold;
        }
        
        .tab-btn:hover {
            background: #e9ecef;
        }
        
        .tab-content {
            padding: 20px;
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .table-container {
            overflow-x: auto;
            margin: 20px 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        th {
            background: #f8f9fa;
            font-weight: 600;
        }
        
        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }
        
        .rating-badge {
            background: #4CAF50;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-weight: bold;
        }
        
        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.3s;
        }
        
        .add-btn {
            background: #4CAF50;
            color: white;
        }
        
        .delete-btn {
            background: #f44336;
            color: white;
        }
        
        .penalty-btn {
            background: #ff9800;
            color: white;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1em;
        }
        
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .bottom-panels {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-top: 1px solid #dee2e6;
        }
        
        @media (max-width: 768px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
            
            .cabinet-stats {
                grid-template-columns: 1fr;
            }
            
            .shop-grid {
                grid-template-columns: 1fr;
            }
            
            .bets-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∏–≥—Ä–æ–∫–∞ (—Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
    <div class="container" id="playerProfileContainer" style="display: none;">
        <div class="player-profile-container">
            <div class="player-profile-header">
                <img id="playerProfileAvatar" src="" class="player-avatar-large" onerror="this.src='https://i.pravatar.cc/150?img=3'">
                <div class="player-info-large">
                    <h1 id="playerProfileName" class="player-name-large"></h1>
                    <div id="playerProfileRating" class="player-rating-large"></div>
                    <div id="playerProfileEmojis" class="achievement-emojis"></div>
                    <div id="playerProfileStats" class="player-profile-stats"></div>
                </div>
            </div>
            
            <!-- –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç —Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –≤–∞–ª—é—Ç–æ–π -->
            <div class="player-cabinet-container" id="playerCabinet">
                <div class="cabinet-header">
                    <img id="cabinetAvatar" src="" class="cabinet-avatar" onerror="this.src='https://i.pravatar.cc/150?img=3'">
                    <div class="cabinet-info">
                        <div class="cabinet-name" id="cabinetName"></div>
                        <div class="cabinet-rating">–†–µ–π—Ç–∏–Ω–≥: <span id="cabinetRating"></span></div>
                        <div>–¢–æ–∫–µ–Ω–æ–≤: <span id="cabinetTokens" style="color: #4CAF50; font-weight: bold;">0</span> ü™ô</div>
                    </div>
                </div>
                
                <div class="cabinet-stats">
                    <div class="cabinet-stat">
                        <div class="stat-value" id="cabinetBetsMade">0</div>
                        <div class="stat-label">–°–¥–µ–ª–∞–Ω–æ —Å—Ç–∞–≤–æ–∫</div>
                    </div>
                    <div class="cabinet-stat">
                        <div class="stat-value" id="cabinetBetsWon">0</div>
                        <div class="stat-label">–í—ã–∏–≥—Ä–∞–Ω–æ —Å—Ç–∞–≤–æ–∫</div>
                    </div>
                    <div class="cabinet-stat">
                        <div class="stat-value" id="cabinetTotalWon">0</div>
                        <div class="stat-label">–¢–æ–∫–µ–Ω–æ–≤ –≤—ã–∏–≥—Ä–∞–Ω–æ</div>
                    </div>
                    <div class="cabinet-stat">
                        <div class="stat-value" id="cabinetWinRate">0%</div>
                        <div class="stat-label">–ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–±–µ–¥</div>
                    </div>
                </div>
                
                <div class="cabinet-section">
                    <h4>üìä –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫</h4>
                    <div class="table-container">
                        <table class="bet-history-table" id="playerBetHistory">
                            <thead>
                                <tr>
                                    <th>–î–∞—Ç–∞</th>
                                    <th>–ú–∞—Ç—á</th>
                                    <th>–°—Ç–∞–≤–∫–∞</th>
                                    <th>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç</th>
                                    <th>–†–µ–∑—É–ª—å—Ç–∞—Ç</th>
                                    <th>–í—ã–∏–≥—Ä—ã—à</th>
                                </tr>
                            </thead>
                            <tbody id="betHistoryBody">
                                <!-- –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="cabinet-section">
                    <h4>üè™ –ú–∞–≥–∞–∑–∏–Ω –ª–∏–≥–∏</h4>
                    <div class="shop-grid" id="leagueShop">
                        <!-- –¢–æ–≤–∞—Ä—ã –º–∞–≥–∞–∑–∏–Ω–∞ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
            </div>
            
            <div style="margin: 20px; text-align: center;">
                <a href="#" class="action-btn add-btn" onclick="returnToMain()" style="padding: 10px 20px; text-decoration: none; display: inline-block;">
                    ‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ä–µ–π—Ç–∏–Ω–≥—É
                </a>
            </div>
        </div>
    </div>
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–≤–∏–¥–∏–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
    <div class="container" id="appContainer">
        <!-- –®–∞–ø–∫–∞ -->
        <header>
            <h1>üèì –†–µ–π—Ç–∏–Ω–≥ –õ–õ–ù–¢</h1>
            <div class="header-subtitle">–ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –õ–∏–≥–∏ –õ—é–±–∏—Ç–µ–ª–µ–π –ù–∞—Å—Ç–æ–ª—å–Ω–æ–≥–æ –¢–µ–Ω–Ω–∏—Å–∞</div>
        </header>
        
        <!-- –í–∫–ª–∞–¥–∫–∏ -->
        <div class="tabs">
            <button class="tab-btn active" onclick="openTab('rating')">üèÜ –†–µ–π—Ç–∏–Ω–≥</button>
            <button class="tab-btn" onclick="openTab('matches')">üéÆ –ú–∞—Ç—á–∏</button>
            <button class="tab-btn" onclick="openTab('players')">üë• –ò–≥—Ä–æ–∫–∏</button>
            <button class="tab-btn" onclick="openTab('bets')">üí∞ –°—Ç–∞–≤–∫–∏</button>
        </div>
        
        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–æ–∫ -->
        <div class="tab-content active" id="rating">
            <h2>üèÜ –¢–µ–∫—É—â–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∏–≥—Ä–æ–∫–æ–≤</h2>
            <div class="table-container">
                <table class="compact-table">
                    <thead>
                        <tr>
                            <th>–ú–µ—Å—Ç–æ</th>
                            <th>–ò–≥—Ä–æ–∫</th>
                            <th>–û—á–∫–∏</th>
                            <th>–ú–∞—Ç—á–∏</th>
                            <th>–ü–æ–±–µ–¥</th>
                            <th>–ü–æ—Å–ª–µ–¥–Ω—è—è –∏–≥—Ä–∞</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="ratingBody"></tbody>
                </table>
            </div>
        </div>
        
        <div class="tab-content" id="matches">
            <h2>üéÆ –ò—Å—Ç–æ—Ä–∏—è –º–∞—Ç—á–µ–π</h2>
            <div id="matchesContainer">
                <!-- –ú–∞—Ç—á–∏ –±—É–¥—É—Ç —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –¥–Ω—è–º –∑–¥–µ—Å—å -->
            </div>
            
            <!-- –ë–ª–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–∞—Ç—á–∞ -->
            <div class="admin-controls" id="matchesAdminControls" style="display: none;">
                <h4>‚öôÔ∏è –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –º–∞—Ç—á–∞ (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)</h4>
                <div class="grid-2">
                    <div>
                        <div class="form-group">
                            <label>–î–∞—Ç–∞ –º–∞—Ç—á–∞:</label>
                            <input type="date" id="matchDate">
                        </div>
                        <div class="form-group">
                            <label>–ò–≥—Ä–æ–∫ 1:</label>
                            <select id="player1"></select>
                        </div>
                        <div class="form-group">
                            <label>–ò–≥—Ä–æ–∫ 2:</label>
                            <select id="player2"></select>
                        </div>
                    </div>
                    <div>
                        <div class="form-group">
                            <label>–ü–æ–±–µ–¥–∏—Ç–µ–ª—å:</label>
                            <select id="winner">
                                <option value="player1">–ò–≥—Ä–æ–∫ 1</option>
                                <option value="player2">–ò–≥—Ä–æ–∫ 2</option>
                                <option value="draw">–ù–∏—á—å—è</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>–°—á–µ—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
                            <input type="text" id="score" placeholder="3:2">
                        </div>
                        <button class="add-btn action-btn" onclick="addMatch()" style="margin-top: 20px; width: 100%;">
                            ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç—á
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="players">
            <h2>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞–º–∏</h2>
            <div class="admin-controls" id="playersAdminControls" style="display: none;">
                <h4>‚öôÔ∏è –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞ (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)</h4>
                <div class="grid-2">
                    <div>
                        <div class="form-group">
                            <label>–ò–º—è –∏–≥—Ä–æ–∫–∞:</label>
                            <input type="text" id="newPlayerName" placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω">
                        </div>
                        <div class="form-group">
                            <label>–õ–æ–≥–∏–Ω –¥–ª—è –∫–∞–±–∏–Ω–µ—Ç–∞:</label>
                            <input type="text" id="newPlayerLogin" placeholder="ivanov">
                        </div>
                        <div class="form-group">
                            <label>–ü–∞—Ä–æ–ª—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
                            <input type="password" id="newPlayerPassword" placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏">
                        </div>
                        <div class="form-group">
                            <label>–°—Å—ã–ª–∫–∞ –Ω–∞ –∞–≤–∞—Ç–∞—Ä (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
                            <input type="text" id="newPlayerAvatar" placeholder="https://example.com/avatar.jpg">
                        </div>
                        <div class="form-group">
                            <label>–ù–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥:</label>
                            <input type="number" id="newPlayerRating" value="1000">
                        </div>
                        <div class="form-group">
                            <label>–ù–∞—á–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∂–µ—Ç–æ–Ω–æ–≤:</label>
                            <input type="number" id="newPlayerTokens" value="100">
                        </div>
                        <button class="add-btn action-btn" onclick="addPlayer()" style="width: 100%;">
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞
                        </button>
                    </div>
                    <div>
                        <p><strong>–°–æ–≤–µ—Ç—ã:</strong></p>
                        <ul style="list-style: none; padding: 0;">
                            <li>‚Ä¢ –î–ª—è –∞–≤–∞—Ç–∞—Ä–æ–≤ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å <a href="https://pravatar.cc" target="_blank">pravatar.cc</a></li>
                            <li>‚Ä¢ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥: 1000</li>
                            <li>‚Ä¢ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∂–µ—Ç–æ–Ω–æ–≤: 100</li>
                            <li>‚Ä¢ –õ–æ–≥–∏–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º</li>
                            <li>‚Ä¢ –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∏–≥—Ä–æ–∫–∞ –µ–≥–æ –∫–∞–±–∏–Ω–µ—Ç —Ç–∞–∫–∂–µ —É–¥–∞–ª–∏—Ç—Å—è</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>–ê–≤–∞—Ç–∞—Ä</th>
                            <th>–ò–º—è</th>
                            <th>–†–µ–π—Ç–∏–Ω–≥</th>
                            <th>–ú–∞—Ç—á–∏</th>
                            <th>–ü–æ–±–µ–¥</th>
                            <th>–ñ–µ—Ç–æ–Ω—ã</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="playersBody"></tbody>
                </table>
            </div>
        </div>
        
        <!-- –í–ö–õ–ê–î–ö–ê: –°–¢–ê–í–ö–ò -->
        <div class="tab-content" id="bets">
            <h2>üí∞ –í–Ω—É—Ç—Ä–∏–∏–≥—Ä–æ–≤—ã–µ —Å—Ç–∞–≤–∫–∏ —Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –≤–∞–ª—é—Ç–æ–π</h2>
            
            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ -->
            <div class="player-cabinet-container" id="currentPlayerCabinet" style="display: none;">
                <div class="cabinet-header">
                    <img id="currentCabinetAvatar" src="" class="cabinet-avatar" onerror="this.src='https://i.pravatar.cc/150?img=3'">
                    <div class="cabinet-info">
                        <div class="cabinet-name" id="currentCabinetName"></div>
                        <div class="cabinet-rating">–í–∞—à –±–∞–ª–∞–Ω—Å: <span id="currentCabinetTokens" style="color: #4CAF50; font-weight: bold;">0</span> ü™ô</div>
                        <div style="font-size: 0.9em; color: #666;">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞: <span id="maxBetAmount">0</span> ü™ô (50% –æ—Ç –±–∞–ª–∞–Ω—Å–∞)</div>
                    </div>
                </div>
            </div>
            
            <!-- –ë–ª–æ–∫ –≤—Ö–æ–¥–∞ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç -->
            <div class="login-panel" id="betsLoginPanel">
                <h3>üîê –í—Ö–æ–¥ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h3>
                <p>–î–ª—è —É—á–∞—Å—Ç–∏—è –≤ —Å—Ç–∞–≤–∫–∞—Ö –≤–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –∫–∞–±–∏–Ω–µ—Ç:</p>
                <div class="form-group">
                    <label>–õ–æ–≥–∏–Ω:</label>
                    <input type="text" id="betLogin" class="password-input" placeholder="–í–∞—à –ª–æ–≥–∏–Ω">
                </div>
                <div class="form-group">
                    <label>–ü–∞—Ä–æ–ª—å:</label>
                    <input type="password" id="betPassword" class="password-input" placeholder="–í–∞—à –ø–∞—Ä–æ–ª—å">
                </div>
                <button class="add-btn action-btn" onclick="loginToBetCabinet()" style="width: 100%;">–í–æ–π—Ç–∏ –≤ –∫–∞–±–∏–Ω–µ—Ç</button>
                <button class="delete-btn action-btn" onclick="logoutFromBetCabinet()" style="display: none; margin-top: 10px; width: 100%;">–í—ã–π—Ç–∏</button>
            </div>
            
            <!-- –ê–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ç—á–∏ –¥–ª—è —Å—Ç–∞–≤–æ–∫ -->
            <div class="bets-container">
                <div class="bets-header">
                    <div class="level-icon">üí∞</div>
                    <h3>üìä –ê–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Ç—á–∏ –¥–ª—è —Å—Ç–∞–≤–æ–∫</h3>
                </div>
                
                <div id="activeMatchesForBets">
                    <p style="text-align: center; padding: 20px; color: rgba(255, 255, 255, 0.8);">
                        –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∞—Ç—á–µ–π –¥–ª—è —Å—Ç–∞–≤–æ–∫. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –º–∞—Ç—á–∏ –¥–ª—è —Å—Ç–∞–≤–æ–∫.
                    </p>
                </div>
                
                <!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–∞—Ç—á–µ–π –¥–ª—è —Å—Ç–∞–≤–æ–∫ -->
                <div class="admin-controls" id="betsAdminControls" style="display: none; margin-top: 20px;">
                    <h4>‚öôÔ∏è –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Ç—á–∞ –¥–ª—è —Å—Ç–∞–≤–æ–∫ (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)</h4>
                    <div class="grid-2">
                        <div>
                            <div class="form-group">
                                <label>–î–∞—Ç–∞ –º–∞—Ç—á–∞:</label>
                                <input type="datetime-local" id="betMatchDate">
                            </div>
                            <div class="form-group">
                                <label>–ò–≥—Ä–æ–∫ 1:</label>
                                <select id="betPlayer1"></select>
                            </div>
                            <div class="form-group">
                                <label>–ò–≥—Ä–æ–∫ 2:</label>
                                <select id="betPlayer2"></select>
                            </div>
                        </div>
                        <div>
                            <div class="form-group">
                                <label>–û–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
                                <input type="text" id="betDescription" placeholder="–§–∏–Ω–∞–ª —Ç—É—Ä–Ω–∏—Ä–∞, —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –º–∞—Ç—á –∏ —Ç.–¥.">
                            </div>
                            <div class="form-group">
                                <label>–°—Ç–∞—Ç—É—Å:</label>
                                <select id="betMatchStatus">
                                    <option value="pending">–û–∂–∏–¥–∞–Ω–∏–µ</option>
                                    <option value="live">LIVE</option>
                                    <option value="finished">–ó–∞–≤–µ—Ä—à–µ–Ω</option>
                                </select>
                            </div>
                            <button class="add-btn action-btn" onclick="createBetMatch()" style="margin-top: 20px; width: 100%;">
                                üéÆ –°–æ–∑–¥–∞—Ç—å –º–∞—Ç—á –¥–ª—è —Å—Ç–∞–≤–æ–∫
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫ -->
            <div class="cabinet-section" style="background: white; padding: 20px; border-radius: 12px; margin-top: 20px;">
                <h4>üìã –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö —Å—Ç–∞–≤–æ–∫</h4>
                <div class="table-container">
                    <table class="bet-history-table">
                        <thead>
                            <tr>
                                <th>–î–∞—Ç–∞</th>
                                <th>–ú–∞—Ç—á</th>
                                <th>–ò–≥—Ä–æ–∫</th>
                                <th>–°—Ç–∞–≤–∫–∞ –Ω–∞</th>
                                <th>–°—É–º–º–∞</th>
                                <th>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                                <th>–í—ã–∏–≥—Ä—ã—à</th>
                            </tr>
                        </thead>
                        <tbody id="allBetsHistoryBody">
                            <!-- –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö —Å—Ç–∞–≤–æ–∫ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂–µ—Ç–æ–Ω–∞–º–∏ -->
            <div class="admin-controls" id="tokensAdminControls" style="display: none; margin-top: 20px;">
                <h4>‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–µ—Ç–æ–Ω–∞–º–∏ –∏–≥—Ä–æ–∫–æ–≤ (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)</h4>
                <div class="grid-2">
                    <div>
                        <div class="form-group">
                            <label>–ò–≥—Ä–æ–∫:</label>
                            <select id="tokensPlayerSelect"></select>
                        </div>
                        <div class="form-group">
                            <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∂–µ—Ç–æ–Ω–æ–≤:</label>
                            <input type="number" id="tokensAmount" value="100" min="1" max="10000">
                        </div>
                        <div class="form-group">
                            <label>–î–µ–π—Å—Ç–≤–∏–µ:</label>
                            <select id="tokensAction">
                                <option value="add">–î–æ–Ω–∞—á–∏—Å–ª–∏—Ç—å</option>
                                <option value="remove">–°–ø–∏—Å–∞—Ç—å</option>
                                <option value="set">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</option>
                            </select>
                        </div>
                        <button class="add-btn action-btn" onclick="managePlayerTokens()" style="width: 100%;">
                            üí∞ –í—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ü–∞–Ω–µ–ª–∏ –≤–Ω–∏–∑—É —Å–∞–π—Ç–∞ -->
        <div class="bottom-panels">
            <!-- –ü–∞–Ω–µ–ª—å Supabase -->
            <div class="supabase-panel" style="display: flex; justify-content: space-between; align-items: center; padding: 15px; background: white; border-radius: 8px; margin-bottom: 10px;">
                <div class="supabase-status">
                    <strong>‚òÅÔ∏è Supabase Cloud Sync</strong>
                    <div>–°—Ç–∞—Ç—É—Å: <span id="supabaseStatus" class="status-loading">‚è≥ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</span></div>
                </div>
                <button class="action-btn add-btn" onclick="loadAllData()" id="refreshBtn">
                    üîÑ –û–±–Ω–æ–≤–∏—Ç—å
                </button>
            </div>
            
            <!-- –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ -->
            <div class="admin-panel" id="adminPanel" style="display: none; padding: 15px; background: white; border-radius: 8px; margin-bottom: 10px;">
                <h3>‚öôÔ∏è –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h3>
                <p>–í—ã –≤–æ—à–ª–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä. –î–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.</p>
                <button class="delete-btn action-btn" onclick="logoutAdmin()">üö™ –í—ã–π—Ç–∏ –∏–∑ –∞–¥–º–∏–Ω-—Ä–µ–∂–∏–º–∞</button>
            </div>
            
            <!-- –ü–∞–Ω–µ–ª—å –≤—Ö–æ–¥–∞ -->
            <div class="login-panel" id="loginPanel" style="padding: 15px; background: white; border-radius: 8px;">
                <h3>üîê –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π</h3>
                <p>–î–ª—è –≤–Ω–µ—Å–µ–Ω–∏—è –º–∞—Ç—á–µ–π –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤–æ–π–¥–∏—Ç–µ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:</p>
                <input type="password" id="adminPassword" class="password-input" placeholder="–ü–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞" style="width: 100%; padding: 10px; margin: 10px 0;">
                <button class="add-btn action-btn" onclick="loginAdmin()" style="width: 100%;">–í–æ–π—Ç–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</button>
            </div>
        </div>
    </div>

    <script>
    // ============================================
    // –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ò –ë–ê–ó–û–í–´–ï –§–£–ù–ö–¶–ò–ò
    // ============================================
    const SUPABASE_URL = 'https://bqycjfcjtdawyrysgrbw.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxeWNqZmNqdGRhd3lyeXNncmJ3Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2NjYwMTk3MCwiZXhwIjoyMDgyMTc3OTcwfQ.lHA_79fw8PSj9ZHMExBpSEIpkonkCYOni7HniGGqadY';
    
    let supabaseClient = null;
    let players = {};
    let matches = [];
    let penaltyLog = [];
    let tournaments = [];
    let isAdmin = false;
    const ADMIN_PASSWORD = "admin123";
    
    // –ù–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã —Å—Ç–∞–≤–æ–∫
    let playerCabinets = {};
    let betMatches = [];
    let betHistory = [];
    let currentLoggedInPlayer = null;
    
    // –ú–∞–≥–∞–∑–∏–Ω –ª–∏–≥–∏
    const leagueShop = [
        {
            id: 'penalty_cancel',
            icon: 'üö´',
            title: '–û—Ç–º–µ–Ω–∞ —à—Ç—Ä–∞—Ñ–∞ –∑–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
            description: '–û—Ç–º–µ–Ω–∏—Ç—å –æ–¥–∏–Ω —à—Ç—Ä–∞—Ñ -60 –æ—á–∫–æ–≤ –∑–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
            price: 500,
            effect: 'cancel_penalty'
        },
        {
            id: 'rating_boost',
            icon: 'üìà',
            title: '–ü–æ–≤—ã—à–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞',
            description: '–ö—É–ø–∏—Ç—å 10 –æ—á–∫–æ–≤ —Ä–µ–π—Ç–∏–Ω–≥–∞',
            price: 100,
            effect: 'add_rating',
            amount: 10
        }
    ];
    
    // ============================================
    // –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–ò
    // ============================================
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    function showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        notification.textContent = message;
        notification.className = `notification ${type}`;
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
            if (notification.parentNode) {
                notification.parentNode.removeChild(notification);
            }
        }, 3000);
    }
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Supabase
    async function initSupabase() {
        try {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç—É–ø–µ–Ω –ª–∏ Supabase
            if (typeof supabase === 'undefined') {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º Supabase –∫–ª–∏–µ–Ω—Ç
                const script = document.createElement('script');
                script.src = 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2';
                script.async = true;
                document.head.appendChild(script);
                
                // –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫–∏
                await new Promise((resolve) => {
                    script.onload = resolve;
                });
            }
            
            // –°–æ–∑–¥–∞–µ–º –∫–ª–∏–µ–Ω—Ç
            supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
            console.log('‚úÖ Supabase –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
            updateSupabaseStatus('‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ');
            return true;
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Supabase:', error);
            updateSupabaseStatus('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è');
            return false;
        }
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ Supabase
    function updateSupabaseStatus(status) {
        const statusElement = document.getElementById('supabaseStatus');
        if (statusElement) {
            statusElement.textContent = status;
        }
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–≤—Ö–æ–¥–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
    function checkAutoLogin() {
        try {
            const saved = localStorage.getItem('adminLoggedIn');
            if (saved) {
                const data = JSON.parse(saved);
                if (Date.now() - data.timestamp < 24 * 60 * 60 * 1000) {
                    isAdmin = true;
                    document.getElementById('adminPanel').style.display = 'block';
                    document.getElementById('loginPanel').style.display = 'none';
                    document.getElementById('matchesAdminControls').style.display = 'block';
                    document.getElementById('playersAdminControls').style.display = 'block';
                    document.getElementById('betsAdminControls').style.display = 'block';
                    document.getElementById('tokensAdminControls').style.display = 'block';
                    console.log('‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä');
                } else {
                    localStorage.removeItem('adminLoggedIn');
                }
            }
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ–≤—Ö–æ–¥–∞:', error);
        }
    }
    
    // –í—Ö–æ–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
    function loginAdmin() {
        const password = document.getElementById('adminPassword').value;
        if (password === ADMIN_PASSWORD) {
            isAdmin = true;
            localStorage.setItem('adminLoggedIn', JSON.stringify({
                timestamp: Date.now()
            }));
            document.getElementById('adminPanel').style.display = 'block';
            document.getElementById('loginPanel').style.display = 'none';
            document.getElementById('matchesAdminControls').style.display = 'block';
            document.getElementById('playersAdminControls').style.display = 'block';
            document.getElementById('betsAdminControls').style.display = 'block';
            document.getElementById('tokensAdminControls').style.display = 'block';
            
            showNotification('‚úÖ –í—Ö–æ–¥ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤—ã–ø–æ–ª–Ω–µ–Ω!', 'success');
        } else {
            showNotification('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!', 'error');
        }
    }
    
    // –í—ã—Ö–æ–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
    function logoutAdmin() {
        isAdmin = false;
        localStorage.removeItem('adminLoggedIn');
        document.getElementById('adminPanel').style.display = 'none';
        document.getElementById('loginPanel').style.display = 'block';
        document.getElementById('matchesAdminControls').style.display = 'none';
        document.getElementById('playersAdminControls').style.display = 'none';
        document.getElementById('betsAdminControls').style.display = 'none';
        document.getElementById('tokensAdminControls').style.display = 'none';
        
        showNotification('üëã –í—ã—Ö–æ–¥ –∏–∑ –∞–¥–º–∏–Ω-—Ä–µ–∂–∏–º–∞', 'info');
    }
    
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
    function openTab(tabName) {
        document.querySelectorAll('.tab-content').forEach(tab => {
            tab.classList.remove('active');
        });
        
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        
        const tabElement = document.getElementById(tabName);
        if (tabElement) {
            tabElement.classList.add('active');
        }
        
        const activeButton = document.querySelector(`.tab-btn[onclick*="${tabName}"]`);
        if (activeButton) {
            activeButton.classList.add('active');
        }
        
        if (tabName === 'bets') {
            updateActiveBetsDisplay();
            updateAllBetsHistory();
        }
    }
    
    // –í–æ–∑–≤—Ä–∞—Ç –∫ –≥–ª–∞–≤–Ω–æ–º—É —ç–∫—Ä–∞–Ω—É
    function returnToMain() {
        document.getElementById('appContainer').style.display = 'block';
        document.getElementById('playerProfileContainer').style.display = 'none';
        return false;
    }
    
    // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è—à–Ω—é—é –¥–∞—Ç—É
    function setMatchDateToToday() {
        const today = new Date().toISOString().split('T')[0];
        const dateInput = document.getElementById('matchDate');
        if (dateInput) {
            dateInput.value = today;
        }
    }
    
    // ============================================
    // –§–£–ù–ö–¶–ò–ò –î–õ–Ø –°–ò–°–¢–ï–ú–´ –°–¢–ê–í–û–ö
    // ============================================
    
    // –†–∞—Å—á–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
    function calculateOdds(player1Rating, player2Rating) {
        const diff = Math.abs(player1Rating - player2Rating);
        
        let favoriteOdds = 1.3;
        let underdogOdds = 3.5;
        
        if (diff >= 400) {
            favoriteOdds = 1.1;
            underdogOdds = 6.0;
        } else if (diff >= 300) {
            favoriteOdds = 1.2;
            underdogOdds = 4.5;
        } else if (diff >= 200) {
            favoriteOdds = 1.25;
            underdogOdds = 3.8;
        } else if (diff >= 100) {
            favoriteOdds = 1.35;
            underdogOdds = 3.0;
        } else if (diff >= 50) {
            favoriteOdds = 1.4;
            underdogOdds = 2.8;
        } else {
            favoriteOdds = 1.5;
            underdogOdds = 2.5;
        }
        
        if (player1Rating >= player2Rating) {
            return {
                player1: favoriteOdds,
                player2: underdogOdds,
                favorite: player1Rating > player2Rating ? 'player1' : 'equal'
            };
        } else {
            return {
                player1: underdogOdds,
                player2: favoriteOdds,
                favorite: 'player2'
            };
        }
    }
    
    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è
    function generatePassword(length = 8) {
        const charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
        let password = '';
        for (let i = 0; i < length; i++) {
            password += charset.charAt(Math.floor(Math.random() * charset.length));
        }
        return password;
    }
    
    // –°–æ–∑–¥–∞–Ω–∏–µ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞
    async function createPlayerCabinet(playerName, login, password = null, initialTokens = 100) {
        try {
            const playerPassword = password || generatePassword();
            
            const cabinet = {
                playerName: playerName,
                login: login.toLowerCase(),
                password: playerPassword,
                tokens: initialTokens,
                betsMade: 0,
                betsWon: 0,
                totalWon: 0,
                betHistory: [],
                joinDate: new Date().toISOString(),
                lastLogin: new Date().toISOString(),
                shopPurchases: []
            };
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ
            playerCabinets[cabinet.login] = cabinet;
            
            console.log(`‚úÖ –°–æ–∑–¥–∞–Ω –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –¥–ª—è –∏–≥—Ä–æ–∫–∞ ${playerName}`);
            console.log(`üîë –õ–æ–≥–∏–Ω: ${cabinet.login}, –ü–∞—Ä–æ–ª—å: ${playerPassword}`);
            
            return cabinet;
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞:', error);
            throw error;
        }
    }
    
    // –í—Ö–æ–¥ –≤ –∫–∞–±–∏–Ω–µ—Ç
    async function loginToBetCabinet() {
        const login = document.getElementById('betLogin').value.trim().toLowerCase();
        const password = document.getElementById('betPassword').value;
        
        if (!login || !password) {
            showNotification('–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å!', 'error');
            return;
        }
        
        try {
            let cabinet = playerCabinets[login];
            
            if (!cabinet || cabinet.password !== password) {
                showNotification('–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å!', 'error');
                return;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –≤—Ö–æ–¥–∞
            cabinet.lastLogin = new Date().toISOString();
            currentLoggedInPlayer = cabinet;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            localStorage.setItem('currentLoggedInPlayer', JSON.stringify({
                login: cabinet.login,
                timestamp: Date.now()
            }));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            updateBetCabinetDisplay();
            updateActiveBetsDisplay();
            updateAllBetsHistory();
            
            showNotification(`‚úÖ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${cabinet.playerName}!`, 'success');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª–∏
            document.getElementById('betsLoginPanel').style.display = 'none';
            document.getElementById('currentPlayerCabinet').style.display = 'block';
            document.querySelector('#betsLoginPanel .delete-btn').style.display = 'block';
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞ –≤ –∫–∞–±–∏–Ω–µ—Ç:', error);
            showNotification('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞ –≤ –∫–∞–±–∏–Ω–µ—Ç', 'error');
        }
    }
    
    // –í—ã—Ö–æ–¥ –∏–∑ –∫–∞–±–∏–Ω–µ—Ç–∞
    function logoutFromBetCabinet() {
        currentLoggedInPlayer = null;
        localStorage.removeItem('currentLoggedInPlayer');
        
        document.getElementById('betLogin').value = '';
        document.getElementById('betPassword').value = '';
        
        document.getElementById('betsLoginPanel').style.display = 'block';
        document.getElementById('currentPlayerCabinet').style.display = 'none';
        document.querySelector('#betsLoginPanel .delete-btn').style.display = 'none';
        
        updateActiveBetsDisplay();
        
        showNotification('üëã –í—ã –≤—ã—à–ª–∏ –∏–∑ –∫–∞–±–∏–Ω–µ—Ç–∞', 'info');
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞–±–∏–Ω–µ—Ç–∞
    function updateBetCabinetDisplay() {
        if (!currentLoggedInPlayer) return;
        
        const cabinet = currentLoggedInPlayer;
        
        document.getElementById('currentCabinetName').textContent = cabinet.playerName;
        document.getElementById('currentCabinetTokens').textContent = cabinet.tokens;
        document.getElementById('maxBetAmount').textContent = Math.floor(cabinet.tokens * 0.5);
        
        const avatarElement = document.getElementById('currentCabinetAvatar');
        const playerData = players[cabinet.playerName];
        if (playerData && playerData.avatar) {
            avatarElement.src = playerData.avatar;
        } else {
            avatarElement.src = 'https://i.pravatar.cc/150?img=3';
        }
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–≤—Ö–æ–¥–∞ –≤ –∫–∞–±–∏–Ω–µ—Ç
    function checkAutoLoginForBets() {
        try {
            const saved = localStorage.getItem('currentLoggedInPlayer');
            if (saved) {
                const data = JSON.parse(saved);
                const login = data.login;
                
                if (Date.now() - data.timestamp < 60 * 60 * 1000) {
                    const cabinet = playerCabinets[login];
                    if (cabinet) {
                        currentLoggedInPlayer = cabinet;
                        updateBetCabinetDisplay();
                        document.getElementById('betsLoginPanel').style.display = 'none';
                        document.getElementById('currentPlayerCabinet').style.display = 'block';
                        document.querySelector('#betsLoginPanel .delete-btn').style.display = 'block';
                        console.log(`‚úÖ –ê–≤—Ç–æ–≤—Ö–æ–¥ –≤ –∫–∞–±–∏–Ω–µ—Ç ${login}`);
                    }
                }
            }
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ–≤—Ö–æ–¥–∞:', error);
        }
    }
    
    // ============================================
    // –û–ë–ù–û–í–õ–ï–ù–ò–ï –û–¢–û–ë–†–ê–ñ–ï–ù–ò–Ø
    // ============================================
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Ä–µ–π—Ç–∏–Ω–≥–∞
    function updateRatingTable() {
        const tbody = document.getElementById('ratingBody');
        if (!tbody) return;
        
        tbody.innerHTML = '';
        
        const playerList = Object.entries(players);
        if (playerList.length === 0) {
            tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 20px;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ–± –∏–≥—Ä–æ–∫–∞—Ö</td></tr>';
            return;
        }
        
        playerList.sort((a, b) => b[1].rating - a[1].rating);
        
        playerList.forEach(([name, data], index) => {
            const row = document.createElement('tr');
            
            row.innerHTML = `
                <td>${index + 1}</td>
                <td><span onclick="showPlayerProfile('${name}')" style="cursor: pointer; text-decoration: underline; color: #4CAF50;">${name}</span></td>
                <td><span class="rating-badge">${data.rating}</span></td>
                <td>${data.matches}</td>
                <td>${data.wins} (${data.matches ? Math.round(data.wins/data.matches*100) : 0}%)</td>
                <td>${data.lastGame ? data.lastGame.toLocaleDateString('ru-RU') : '–ù–µ—Ç'}</td>
                <td>
                    <button class="action-btn" onclick="showPlayerProfile('${name}')">üëÅÔ∏è –ü—Ä–æ—Ñ–∏–ª—å</button>
                </td>
            `;
            tbody.appendChild(row);
        });
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∏–≥—Ä–æ–∫–æ–≤
    function updatePlayersTable() {
        const tbody = document.getElementById('playersBody');
        if (!tbody) return;
        
        tbody.innerHTML = '';
        
        const playerList = Object.entries(players);
        if (playerList.length === 0) return;
        
        playerList.forEach(([name, data]) => {
            const row = document.createElement('tr');
            
            const cabinet = Object.values(playerCabinets).find(c => c.playerName === name);
            const tokens = cabinet ? cabinet.tokens : 0;
            
            const actionsCell = isAdmin ? 
                `<td>
                    <button class="action-btn" onclick="changeAvatar('${name}')" title="–°–º–µ–Ω–∏—Ç—å –∞–≤–∞—Ç–∞—Ä" style="background: #2196F3; margin-right: 5px;">üñºÔ∏è</button>
                    <button class="delete-btn action-btn" onclick="removePlayer('${name}')" title="–£–¥–∞–ª–∏—Ç—å –∏–≥—Ä–æ–∫–∞">üóëÔ∏è</button>
                </td>` :
                `<td>-</td>`;
            
            row.innerHTML = `
                <td><img src="${data.avatar}" class="avatar" 
                       onerror="this.src='https://i.pravatar.cc/150?img=3'}" onclick="showPlayerProfile('${name}')" style="cursor: pointer;"></td>
                <td><span onclick="showPlayerProfile('${name}')" style="cursor: pointer; text-decoration: underline; color: #4CAF50;">${name}</span></td>
                <td><span class="rating-badge">${data.rating}</span></td>
                <td>${data.matches}</td>
                <td>${data.wins} (${data.matches ? Math.round(data.wins/data.matches*100) : 0}%)</td>
                <td><span style="color: #4CAF50; font-weight: bold;">${tokens} ü™ô</span></td>
                ${actionsCell}
            `;
            tbody.appendChild(row);
        });
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
    function updatePlayerSelects() {
        const selects = ['player1', 'player2', 'betPlayer1', 'betPlayer2', 'tokensPlayerSelect'];
        const playerNames = Object.keys(players).sort();
        
        selects.forEach(selectId => {
            const select = document.getElementById(selectId);
            if (!select) return;
            
            const currentValue = select.value;
            
            select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞</option>';
            
            playerNames.forEach(name => {
                const option = document.createElement('option');
                option.value = name;
                option.textContent = name;
                select.appendChild(option);
            });
            
            if (players[currentValue]) {
                select.value = currentValue;
            }
        });
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –º–∞—Ç—á–µ–π
    function updateMatchesTable() {
        const container = document.getElementById('matchesContainer');
        if (!container) return;
        
        if (matches.length === 0) {
            container.innerHTML = '<p style="text-align: center; padding: 20px;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –º–∞—Ç—á–∞—Ö</p>';
            return;
        }
        
        // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –º–∞—Ç—á–∏ –ø–æ –¥–Ω—è–º
        const matchesByDate = {};
        matches.forEach(match => {
            const dateKey = match.date.toLocaleDateString('ru-RU');
            if (!matchesByDate[dateKey]) {
                matchesByDate[dateKey] = [];
            }
            matchesByDate[dateKey].push(match);
        });
        
        let html = '';
        Object.keys(matchesByDate).sort((a, b) => new Date(b) - new Date(a)).forEach(date => {
            html += `<h3>${date}</h3>`;
            matchesByDate[date].forEach(match => {
                html += `
                    <div style="padding: 10px; margin: 10px 0; background: #f8f9fa; border-radius: 8px;">
                        <strong>${match.player1}</strong> vs <strong>${match.player2}</strong><br>
                        –ü–æ–±–µ–¥–∏—Ç–µ–ª—å: ${match.winner === 'player1' ? match.player1 : match.winner === 'player2' ? match.player2 : '–ù–∏—á—å—è'}
                        ${match.score ? ` (${match.score})` : ''}
                    </div>
                `;
            });
        });
        
        container.innerHTML = html;
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ç–∞–≤–æ–∫
    function updateActiveBetsDisplay() {
        const container = document.getElementById('activeMatchesForBets');
        if (!container) return;
        
        const activeMatches = betMatches.filter(match => 
            match.status === 'pending' || match.status === 'live'
        );
        
        if (activeMatches.length === 0) {
            container.innerHTML = `
                <p style="text-align: center; padding: 20px; color: rgba(255, 255, 255, 0.8);">
                    –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∞—Ç—á–µ–π –¥–ª—è —Å—Ç–∞–≤–æ–∫. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –º–∞—Ç—á–∏ –¥–ª—è —Å—Ç–∞–≤–æ–∫.
                </p>
            `;
            return;
        }
        
        let html = '<div class="bets-grid">';
        
        activeMatches.forEach(match => {
            const player1Data = players[match.player1];
            const player2Data = players[match.player2];
            const isLive = match.status === 'live';
            
            html += `
                <div class="bet-card">
                    <div class="bet-match-info">
                        <div class="bet-player ${match.odds.favorite === 'player1' ? 'winner' : ''}">
                            <img src="${player1Data?.avatar || 'https://i.pravatar.cc/150?img=3'}" 
                                 style="width: 40px; height: 40px; border-radius: 50%;">
                            <div class="bet-player-info">
                                <div class="bet-player-name">${match.player1}</div>
                                <div class="bet-player-rating">–†–µ–π—Ç–∏–Ω–≥: ${match.player1Rating}</div>
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin: 10px 0;">
                            <div style="font-weight: bold; color: #ff9800;">${isLive ? '<span class="match-live-badge">LIVE</span>' : 'VS'}</div>
                            ${match.description ? `<div style="font-size: 0.9em; margin-top: 5px;">${match.description}</div>` : ''}
                            <div style="font-size: 0.8em; margin-top: 5px;">
                                ${new Date(match.date).toLocaleDateString('ru-RU')} 
                            </div>
                        </div>
                        
                        <div class="bet-player ${match.odds.favorite === 'player2' ? 'winner' : ''}">
                            <div class="bet-player-info" style="text-align: right;">
                                <div class="bet-player-name">${match.player2}</div>
                                <div class="bet-player-rating">–†–µ–π—Ç–∏–Ω–≥: ${match.player2Rating}</div>
                            </div>
                            <img src="${player2Data?.avatar || 'https://i.pravatar.cc/150?img=3'}" 
                                 style="width: 40px; height: 40px; border-radius: 50%;">
                        </div>
                    </div>
                    
                    <div class="bet-odds">
                        <div class="odds-item">
                            <div class="odds-value">${match.odds.player1.toFixed(2)}</div>
                            <div class="odds-label">${match.player1}</div>
                        </div>
                        <div class="odds-item">
                            <div class="odds-value">${match.odds.player2.toFixed(2)}</div>
                            <div class="odds-label">${match.player2}</div>
                        </div>
                    </div>
                    
                    ${currentLoggedInPlayer && match.status === 'pending' ? `
                        <div class="bet-form">
                            <input type="number" 
                                   class="bet-amount-input" 
                                   id="betAmount_${match.id}"
                                   placeholder="–°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏"
                                   min="1" 
                                   max="${Math.floor(currentLoggedInPlayer.tokens * 0.5)}">
                            <div class="bet-buttons">
                                <button class="bet-btn bet-btn-player1" 
                                        onclick="placeBet('${match.id}', 'player1')">
                                    –°—Ç–∞–≤–∫–∞ –Ω–∞ ${match.player1}
                                </button>
                                <button class="bet-btn bet-btn-player2" 
                                        onclick="placeBet('${match.id}', 'player2')">
                                    –°—Ç–∞–≤–∫–∞ –Ω–∞ ${match.player2}
                                </button>
                            </div>
                            <div id="betStatus_${match.id}" class="bet-status"></div>
                        </div>
                    ` : ''}
                    
                    ${isAdmin ? `
                        <div style="margin-top: 10px; display: flex; gap: 10px;">
                            <button class="action-btn add-btn" 
                                    onclick="updateBetMatchStatus('${match.id}', 'live')"
                                    style="flex: 1; padding: 5px; font-size: 0.9em;">
                                ‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å –º–∞—Ç—á
                            </button>
                            <button class="action-btn delete-btn" 
                                    onclick="finishBetMatch('${match.id}')"
                                    style="flex: 1; padding: 5px; font-size: 0.9em;">
                                üèÅ –ó–∞–≤–µ—Ä—à–∏—Ç—å –º–∞—Ç—á
                            </button>
                        </div>
                    ` : ''}
                </div>
            `;
        });
        
        html += '</div>';
        container.innerHTML = html;
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –≤—Å–µ—Ö —Å—Ç–∞–≤–æ–∫
    function updateAllBetsHistory() {
        const tbody = document.getElementById('allBetsHistoryBody');
        if (!tbody) return;
        
        if (betHistory.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="8" style="text-align: center; padding: 20px;">
                        –°—Ç–∞–≤–æ–∫ –µ—â–µ –Ω–µ –±—ã–ª–æ
                    </td>
                </tr>
            `;
            return;
        }
        
        let html = '';
        
        betHistory.slice(0, 20).forEach(bet => {
            const match = betMatches.find(m => m.id === bet.matchId);
            if (!match) return;
            
            let statusText = '';
            let statusClass = '';
            
            switch(bet.status) {
                case 'pending':
                    statusText = '‚è≥';
                    statusClass = 'pending';
                    break;
                case 'won':
                    statusText = '‚úÖ';
                    statusClass = 'won';
                    break;
                case 'lost':
                    statusText = '‚ùå';
                    statusClass = 'lost';
                    break;
                case 'draw':
                    statusText = 'ü§ù';
                    break;
                case 'cancelled':
                    statusText = 'üö´';
                    break;
            }
            
            html += `
                <tr>
                    <td>${new Date(bet.placedAt).toLocaleDateString('ru-RU')}</td>
                    <td>${match.player1} vs ${match.player2}</td>
                    <td>${bet.playerName}</td>
                    <td>${bet.betOn === 'player1' ? match.player1 : match.player2}</td>
                    <td>${bet.amount} ü™ô</td>
                    <td>${bet.odds.toFixed(2)}</td>
                    <td><span class="${statusClass}">${statusText}</span></td>
                    <td>
                        ${bet.status === 'won' ? `<span style="color: #4CAF50; font-weight: bold;">+${bet.winAmount} ü™ô</span>` : 
                          bet.status === 'draw' || bet.status === 'cancelled' ? `<span>${bet.amount} ü™ô</span>` :
                          bet.status === 'lost' ? `<span style="color: #f44336;">-${bet.amount} ü™ô</span>` :
                          '‚è≥'}
                    </td>
                </tr>
            `;
        });
        
        tbody.innerHTML = html;
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∏—Å–ø–ª–µ–µ–≤
    function updateAllDisplays() {
        updateRatingTable();
        updateMatchesTable();
        updatePlayersTable();
        updatePlayerSelects();
        
        if (currentLoggedInPlayer) {
            updateBetCabinetDisplay();
        }
        updateActiveBetsDisplay();
        updateAllBetsHistory();
    }
    
    // ============================================
    // –û–°–ù–û–í–ù–´–ï –û–ü–ï–†–ê–¶–ò–ò
    // ============================================
    
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
    async function addPlayer() {
        if (!isAdmin) {
            showNotification('‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –∏–≥—Ä–æ–∫–æ–≤!', 'error');
            return;
        }
        
        const name = document.getElementById('newPlayerName').value.trim();
        const login = document.getElementById('newPlayerLogin').value.trim().toLowerCase();
        const password = document.getElementById('newPlayerPassword').value;
        const avatar = document.getElementById('newPlayerAvatar').value.trim();
        const rating = parseInt(document.getElementById('newPlayerRating').value) || 1000;
        const tokens = parseInt(document.getElementById('newPlayerTokens').value) || 100;
        
        if (!name) {
            showNotification('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏–≥—Ä–æ–∫–∞!', 'error');
            return;
        }
        
        if (!login) {
            showNotification('–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –¥–ª—è –∫–∞–±–∏–Ω–µ—Ç–∞!', 'error');
            return;
        }
        
        if (players[name]) {
            showNotification('–ò–≥—Ä–æ–∫ —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!', 'error');
            return;
        }
        
        if (playerCabinets[login]) {
            showNotification('–ö–∞–±–∏–Ω–µ—Ç —Å —Ç–∞–∫–∏–º –ª–æ–≥–∏–Ω–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!', 'error');
            return;
        }
        
        const newPlayer = { 
            rating: rating, 
            matches: 0, 
            wins: 0, 
            lastGame: null, 
            joinDate: new Date(),
            penalties: 0,
            avatar: avatar || `https://i.pravatar.cc/150?img=${Math.floor(Math.random() * 70) + 1}`,
            achievement_bonuses: {}
        };
        
        players[name] = newPlayer;
        
        try {
            await createPlayerCabinet(name, login, password || null, tokens);
            
            updatePlayerSelects();
            updateAllDisplays();
            
            document.getElementById('newPlayerName').value = '';
            document.getElementById('newPlayerLogin').value = '';
            document.getElementById('newPlayerPassword').value = '';
            document.getElementById('newPlayerAvatar').value = '';
            document.getElementById('newPlayerRating').value = 1000;
            document.getElementById('newPlayerTokens').value = 100;
            
            showNotification(`‚úÖ –ò–≥—Ä–æ–∫ ${name} –¥–æ–±–∞–≤–ª–µ–Ω!`, 'success');
            
            if (!password) {
                const cabinet = playerCabinets[login];
                if (cabinet) {
                    alert(`‚úÖ –ò–≥—Ä–æ–∫ ${name} –¥–æ–±–∞–≤–ª–µ–Ω!\n\n–õ–æ–≥–∏–Ω: ${login}\n–ü–∞—Ä–æ–ª—å: ${cabinet.password}\n\n–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ!`);
                }
            }
            
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞:', error);
            showNotification('‚ùå –û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞', 'error');
            delete players[name];
            delete playerCabinets[login];
        }
    }
    
    // –£–¥–∞–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
    async function removePlayer(name) {
        if (!isAdmin) {
            showNotification('‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å –∏–≥—Ä–æ–∫–æ–≤!', 'error');
            return;
        }
        
        if (!confirm(`–£–¥–∞–ª–∏—Ç—å –∏–≥—Ä–æ–∫–∞ ${name}?`)) return;
        
        delete players[name];
        
        const cabinet = Object.values(playerCabinets).find(c => c.playerName === name);
        if (cabinet) {
            delete playerCabinets[cabinet.login];
        }
        
        if (currentLoggedInPlayer && currentLoggedInPlayer.playerName === name) {
            logoutFromBetCabinet();
        }
        
        updatePlayerSelects();
        updateAllDisplays();
        showNotification(`‚úÖ –ò–≥—Ä–æ–∫ ${name} —É–¥–∞–ª–µ–Ω!`, 'success');
    }
    
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç—á–∞
    async function addMatch() {
        if (!isAdmin) {
            showNotification('‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –º–∞—Ç—á–∏!', 'error');
            return;
        }
        
        const player1 = document.getElementById('player1').value;
        const player2 = document.getElementById('player2').value;
        const winner = document.getElementById('winner').value;
        const score = document.getElementById('score').value;
        
        if (!player1 || !player2) {
            showNotification('–í—ã–±–µ—Ä–∏—Ç–µ –æ–±–æ–∏—Ö –∏–≥—Ä–æ–∫–æ–≤!', 'error');
            return;
        }
        
        if (player1 === player2) {
            showNotification('–ò–≥—Ä–æ–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞–∑–Ω—ã–º–∏!', 'error');
            return;
        }
        
        if (winner === 'player1' || winner === 'player2') {
            const winnerName = winner === 'player1' ? player1 : player2;
            const loserName = winner === 'player1' ? player2 : player1;
            
            if (players[winnerName]) players[winnerName].wins += 1;
            if (players[winnerName]) players[winnerName].matches += 1;
            if (players[loserName]) players[loserName].matches += 1;
            
            // –ü—Ä–æ—Å—Ç–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞
            if (players[winnerName]) players[winnerName].rating += 20;
            if (players[loserName]) players[loserName].rating = Math.max(0, players[loserName].rating - 20);
        }
        
        const match = {
            id: Date.now().toString(),
            date: new Date(document.getElementById('matchDate').value || new Date()),
            player1: player1,
            player2: player2,
            winner: winner,
            score: score
        };
        
        matches.push(match);
        
        updateAllDisplays();
        showNotification('‚úÖ –ú–∞—Ç—á –¥–æ–±–∞–≤–ª–µ–Ω!', 'success');
    }
    
    // –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Ç—á–∞ –¥–ª—è —Å—Ç–∞–≤–æ–∫
    async function createBetMatch() {
        if (!isAdmin) {
            showNotification('‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –º–∞—Ç—á–∏ –¥–ª—è —Å—Ç–∞–≤–æ–∫!', 'error');
            return;
        }
        
        const player1 = document.getElementById('betPlayer1').value;
        const player2 = document.getElementById('betPlayer2').value;
        const description = document.getElementById('betDescription').value.trim();
        const status = document.getElementById('betMatchStatus').value;
        
        if (!player1 || !player2) {
            showNotification('–í—ã–±–µ—Ä–∏—Ç–µ –æ–±–æ–∏—Ö –∏–≥—Ä–æ–∫–æ–≤!', 'error');
            return;
        }
        
        if (player1 === player2) {
            showNotification('–ò–≥—Ä–æ–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞–∑–Ω—ã–º–∏!', 'error');
            return;
        }
        
        const player1Rating = players[player1]?.rating || 1000;
        const player2Rating = players[player2]?.rating || 1000;
        const odds = calculateOdds(player1Rating, player2Rating);
        
        const betMatch = {
            id: Date.now().toString(),
            player1: player1,
            player2: player2,
            player1Rating: player1Rating,
            player2Rating: player2Rating,
            description: description,
            date: new Date().toISOString(),
            status: status,
            odds: odds,
            result: null,
            totalBets: 0,
            totalAmount: 0,
            bets: []
        };
        
        betMatches.push(betMatch);
        updateActiveBetsDisplay();
        
        document.getElementById('betDescription').value = '';
        
        showNotification(`‚úÖ –ú–∞—Ç—á –¥–ª—è —Å—Ç–∞–≤–æ–∫ —Å–æ–∑–¥–∞–Ω! ${player1} vs ${player2}`, 'success');
    }
    
    // –†–∞–∑–º–µ—â–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏
    async function placeBet(matchId, betOn) {
        if (!currentLoggedInPlayer) {
            showNotification('‚ùå –í–æ–π–¥–∏—Ç–µ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç, —á—Ç–æ–±—ã –¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫–∏!', 'error');
            return;
        }
        
        const match = betMatches.find(m => m.id === matchId);
        if (!match) {
            showNotification('–ú–∞—Ç—á –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
            return;
        }
        
        if (match.status !== 'pending') {
            showNotification('–°—Ç–∞–≤–∫–∏ –Ω–∞ —ç—Ç–æ—Ç –º–∞—Ç—á –±–æ–ª—å—à–µ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è!', 'error');
            return;
        }
        
        const amountInput = document.getElementById(`betAmount_${matchId}`);
        const amount = parseInt(amountInput.value);
        
        if (!amount || amount < 1) {
            showNotification('–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É —Å—Ç–∞–≤–∫–∏!', 'error');
            return;
        }
        
        const maxBet = Math.floor(currentLoggedInPlayer.tokens * 0.5);
        if (amount > maxBet) {
            showNotification(`–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞: ${maxBet} ü™ô`, 'error');
            return;
        }
        
        if (amount > currentLoggedInPlayer.tokens) {
            showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∂–µ—Ç–æ–Ω–æ–≤!', 'error');
            return;
        }
        
        const existingBet = match.bets.find(bet => bet.playerLogin === currentLoggedInPlayer.login);
        if (existingBet) {
            showNotification('–í—ã —É–∂–µ –¥–µ–ª–∞–ª–∏ —Å—Ç–∞–≤–∫—É –Ω–∞ —ç—Ç–æ—Ç –º–∞—Ç—á!', 'error');
            return;
        }
        
        const bet = {
            id: Date.now().toString(),
            matchId: matchId,
            playerLogin: currentLoggedInPlayer.login,
            playerName: currentLoggedInPlayer.playerName,
            betOn: betOn,
            amount: amount,
            odds: betOn === 'player1' ? match.odds.player1 : match.odds.player2,
            potentialWin: Math.floor(amount * (betOn === 'player1' ? match.odds.player1 : match.odds.player2)),
            status: 'pending',
            placedAt: new Date().toISOString(),
            result: null,
            winAmount: 0
        };
        
        currentLoggedInPlayer.tokens -= amount;
        currentLoggedInPlayer.betsMade += 1;
        
        match.bets.push(bet);
        match.totalBets += 1;
        match.totalAmount += amount;
        
        betHistory.push(bet);
        currentLoggedInPlayer.betHistory.push(bet);
        
        updateBetCabinetDisplay();
        updateActiveBetsDisplay();
        updateAllBetsHistory();
        
        const statusElement = document.getElementById(`betStatus_${matchId}`);
        if (statusElement) {
            statusElement.textContent = `‚úÖ –°—Ç–∞–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞! ${amount} ü™ô`;
            statusElement.className = 'bet-status won';
        }
        
        amountInput.value = '';
        
        showNotification(`‚úÖ –°—Ç–∞–≤–∫–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∞!`, 'success');
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –º–∞—Ç—á–∞
    async function updateBetMatchStatus(matchId, newStatus) {
        if (!isAdmin) {
            showNotification('‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Å—Ç–∞—Ç—É—Å –º–∞—Ç—á–∞!', 'error');
            return;
        }
        
        const match = betMatches.find(m => m.id === matchId);
        if (!match) {
            showNotification('–ú–∞—Ç—á –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
            return;
        }
        
        match.status = newStatus;
        updateActiveBetsDisplay();
        showNotification(`–°—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–µ–Ω –Ω–∞: ${newStatus}`, 'success');
    }
    
    // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –º–∞—Ç—á–∞
    async function finishBetMatch(matchId) {
        if (!isAdmin) {
            showNotification('‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –∑–∞–≤–µ—Ä—à–∞—Ç—å –º–∞—Ç—á–∏!', 'error');
            return;
        }
        
        const match = betMatches.find(m => m.id === matchId);
        if (!match) {
            showNotification('–ú–∞—Ç—á –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
            return;
        }
        
        const result = prompt(`–í–≤–µ–¥–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–∞—Ç—á–∞ ${match.player1} vs ${match.player2}:
1 - –ü–æ–±–µ–¥–∏–ª ${match.player1}
2 - –ü–æ–±–µ–¥–∏–ª ${match.player2}
3 - –ù–∏—á—å—è
4 - –ú–∞—Ç—á –æ—Ç–º–µ–Ω–µ–Ω`);
        
        let resultText;
        switch(result) {
            case '1':
                resultText = 'player1';
                break;
            case '2':
                resultText = 'player2';
                break;
            case '3':
                resultText = 'draw';
                break;
            case '4':
                resultText = 'cancelled';
                break;
            default:
                showNotification('–û—Ç–º–µ–Ω–µ–Ω–æ', 'info');
                return;
        }
        
        match.result = resultText;
        match.status = 'finished';
        
        for (const bet of match.bets) {
            let betResult = 'lost';
            let winAmount = 0;
            
            if (resultText === 'cancelled') {
                betResult = 'cancelled';
                winAmount = bet.amount;
            } else if (resultText === 'draw') {
                betResult = 'draw';
                winAmount = bet.amount;
            } else if (bet.betOn === resultText) {
                betResult = 'won';
                winAmount = bet.potentialWin;
            }
            
            bet.status = betResult;
            bet.result = resultText;
            bet.winAmount = winAmount;
            
            const cabinet = playerCabinets[bet.playerLogin];
            if (cabinet) {
                if (betResult === 'won') {
                    cabinet.tokens += winAmount;
                    cabinet.betsWon += 1;
                    cabinet.totalWon += winAmount;
                } else if (betResult === 'cancelled' || betResult === 'draw') {
                    cabinet.tokens += winAmount;
                }
                
                const playerBetIndex = cabinet.betHistory.findIndex(b => b.id === bet.id);
                if (playerBetIndex !== -1) {
                    cabinet.betHistory[playerBetIndex] = bet;
                }
            }
            
            const globalBetIndex = betHistory.findIndex(b => b.id === bet.id);
            if (globalBetIndex !== -1) {
                betHistory[globalBetIndex] = bet;
            }
        }
        
        updateActiveBetsDisplay();
        updateAllBetsHistory();
        
        if (currentLoggedInPlayer) {
            updateBetCabinetDisplay();
        }
        
        showNotification(`‚úÖ –ú–∞—Ç—á –∑–∞–≤–µ—Ä—à–µ–Ω! –†–µ–∑—É–ª—å—Ç–∞—Ç: ${resultText}`, 'success');
    }
    
    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–µ—Ç–æ–Ω–∞–º–∏
    async function managePlayerTokens() {
        if (!isAdmin) {
            showNotification('‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –∂–µ—Ç–æ–Ω–∞–º–∏!', 'error');
            return;
        }
        
        const playerName = document.getElementById('tokensPlayerSelect').value;
        const amount = parseInt(document.getElementById('tokensAmount').value);
        const action = document.getElementById('tokensAction').value;
        
        if (!playerName || !amount || amount < 1) {
            showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!', 'error');
            return;
        }
        
        const cabinet = Object.values(playerCabinets).find(c => c.playerName === playerName);
        if (!cabinet) {
            showNotification('–ö–∞–±–∏–Ω–µ—Ç –∏–≥—Ä–æ–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
            return;
        }
        
        let newAmount = cabinet.tokens;
        let message = '';
        
        switch(action) {
            case 'add':
                newAmount += amount;
                message = `–î–æ–Ω–∞—á–∏—Å–ª–µ–Ω–æ ${amount} –∂–µ—Ç–æ–Ω–æ–≤`;
                break;
            case 'remove':
                newAmount = Math.max(0, newAmount - amount);
                message = `–°–ø–∏—Å–∞–Ω–æ ${amount} –∂–µ—Ç–æ–Ω–æ–≤`;
                break;
            case 'set':
                newAmount = amount;
                message = `–ë–∞–ª–∞–Ω—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ ${amount} –∂–µ—Ç–æ–Ω–æ–≤`;
                break;
        }
        
        cabinet.tokens = newAmount;
        
        if (currentLoggedInPlayer && currentLoggedInPlayer.login === cabinet.login) {
            currentLoggedInPlayer.tokens = newAmount;
            updateBetCabinetDisplay();
        }
        
        showNotification(`‚úÖ ${message} –∏–≥—Ä–æ–∫—É ${playerName}`, 'success');
    }
    
    // –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –∏–≥—Ä–æ–∫–∞
    function showPlayerProfile(playerName) {
        if (!players[playerName]) {
            showNotification('–ò–≥—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
            return;
        }
        
        const playerData = players[playerName];
        
        document.getElementById('appContainer').style.display = 'none';
        document.getElementById('playerProfileContainer').style.display = 'block';
        
        document.getElementById('playerProfileName').textContent = playerName;
        document.getElementById('playerProfileAvatar').src = playerData.avatar;
        document.getElementById('playerProfileRating').textContent = `–†–µ–π—Ç–∏–Ω–≥: ${playerData.rating} –æ—á–∫–æ–≤`;
        
        const cabinet = Object.values(playerCabinets).find(c => c.playerName === playerName);
        if (cabinet) {
            document.getElementById('cabinetName').textContent = playerName;
            document.getElementById('cabinetRating').textContent = playerData.rating;
            document.getElementById('cabinetTokens').textContent = cabinet.tokens;
            document.getElementById('cabinetAvatar').src = playerData.avatar;
            
            const winRate = cabinet.betsMade > 0 ? Math.round((cabinet.betsWon / cabinet.betsMade) * 100) : 0;
            document.getElementById('cabinetBetsMade').textContent = cabinet.betsMade;
            document.getElementById('cabinetBetsWon').textContent = cabinet.betsWon;
            document.getElementById('cabinetTotalWon').textContent = cabinet.totalWon;
            document.getElementById('cabinetWinRate').textContent = `${winRate}%`;
        }
    }
    
    // –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
    async function loadAllData() {
        console.log('üîÑ –ó–∞–≥—Ä—É–∂–∞—é –¥–∞–Ω–Ω—ã–µ...');
        updateSupabaseStatus('üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è...');
        
        try {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –µ—Å–ª–∏ –Ω–µ—Ç Supabase
            if (!supabaseClient || !isSupabaseInitialized) {
                console.log('‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É—é —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ');
                
                // –¢–µ—Å—Ç–æ–≤—ã–µ –∏–≥—Ä–æ–∫–∏
                if (Object.keys(players).length === 0) {
                    players = {
                        '–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤': {
                            rating: 1200,
                            matches: 10,
                            wins: 6,
                            lastGame: new Date('2024-01-15'),
                            joinDate: new Date('2023-01-01'),
                            penalties: 0,
                            avatar: 'https://i.pravatar.cc/150?img=1',
                            achievement_bonuses: {}
                        },
                        '–ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤': {
                            rating: 1150,
                            matches: 8,
                            wins: 4,
                            lastGame: new Date('2024-01-10'),
                            joinDate: new Date('2023-02-01'),
                            penalties: 0,
                            avatar: 'https://i.pravatar.cc/150?img=2',
                            achievement_bonuses: {}
                        },
                        '–°–∏–¥–æ—Ä –°–∏–¥–æ—Ä–æ–≤': {
                            rating: 1100,
                            matches: 12,
                            wins: 7,
                            lastGame: new Date('2024-01-05'),
                            joinDate: new Date('2023-03-01'),
                            penalties: 0,
                            avatar: 'https://i.pravatar.cc/150?img=3',
                            achievement_bonuses: {}
                        }
                    };
                }
                
                // –¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞–±–∏–Ω–µ—Ç—ã
                if (Object.keys(playerCabinets).length === 0) {
                    playerCabinets = {
                        'ivan': {
                            playerName: '–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤',
                            login: 'ivan',
                            password: '123456',
                            tokens: 500,
                            betsMade: 5,
                            betsWon: 3,
                            totalWon: 200,
                            betHistory: [],
                            joinDate: new Date().toISOString(),
                            lastLogin: new Date().toISOString(),
                            shopPurchases: []
                        },
                        'petr': {
                            playerName: '–ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤',
                            login: 'petr',
                            password: '123456',
                            tokens: 300,
                            betsMade: 3,
                            betsWon: 1,
                            totalWon: 50,
                            betHistory: [],
                            joinDate: new Date().toISOString(),
                            lastLogin: new Date().toISOString(),
                            shopPurchases: []
                        }
                    };
                }
                
                // –¢–µ—Å—Ç–æ–≤—ã–µ –º–∞—Ç—á–∏
                if (matches.length === 0) {
                    matches = [
                        {
                            id: '1',
                            date: new Date('2024-01-15'),
                            player1: '–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤',
                            player2: '–ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤',
                            winner: 'player1',
                            score: '3:2'
                        },
                        {
                            id: '2',
                            date: new Date('2024-01-10'),
                            player1: '–ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤',
                            player2: '–°–∏–¥–æ—Ä –°–∏–¥–æ—Ä–æ–≤',
                            winner: 'player2',
                            score: '3:1'
                        }
                    ];
                }
            }
            
            updateAllDisplays();
            updateSupabaseStatus('‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
            updateSupabaseStatus('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏');
        }
    }
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    async function init() {
        console.log('üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–≤—Ö–æ–¥–∞
        checkAutoLogin();
        checkAutoLoginForBets();
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–∞—Ç—ã
        setMatchDateToToday();
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Supabase
        await initSupabase();
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        await loadAllData();
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
        updatePlayerSelects();
        
        console.log('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ');
    }
    
    // –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
    } else {
        init();
    }
    </script>
</body>
</html>
