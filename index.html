<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>–†–µ–π—Ç–∏–Ω–≥ —Ç–µ–Ω–Ω–∏—Å–∞</title>
    <style>
        /* –í—Å–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 8px;
            -webkit-text-size-adjust: 100%;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        /* ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ... */
        
    </style>
</head>
<body>
    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∏–≥—Ä–æ–∫–∞ (—Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
    <div class="container" id="playerProfileContainer" style="display: none;">
        <div class="player-profile-container">
            <!-- ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ... -->
        </div>
    </div>
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–≤–∏–¥–∏–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
    <div class="container" id="appContainer">
        <!-- –®–∞–ø–∫–∞ -->
        <header>
            <h1>üèì –†–µ–π—Ç–∏–Ω–≥ –õ–õ–ù–¢</h1>
            <div class="header-subtitle">–ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –õ–∏–≥–∏ –õ—é–±–∏—Ç–µ–ª–µ–π –ù–∞—Å—Ç–æ–ª—å–Ω–æ–≥–æ –¢–µ–Ω–Ω–∏—Å–∞</div>
        </header>
        
        <!-- –í–∫–ª–∞–¥–∫–∏ -->
        <div class="tabs">
            <button class="tab-btn active" onclick="openTab('rating')">üèÜ –†–µ–π—Ç–∏–Ω–≥</button>
            <button class="tab-btn" onclick="openTab('matches')">üéÆ –ú–∞—Ç—á–∏</button>
            <button class="tab-btn" onclick="openTab('players')">üë• –ò–≥—Ä–æ–∫–∏</button>
            <button class="tab-btn" onclick="openTab('stats')">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
            <button class="tab-btn" onclick="openTab('penalties')">‚ö†Ô∏è –®—Ç—Ä–∞—Ñ—ã</button>
        </div>
        
        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–æ–∫ -->
        <div class="tab-content active" id="rating">
            <h2>üèÜ –¢–µ–∫—É—â–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∏–≥—Ä–æ–∫–æ–≤</h2>
            <div class="table-container">
                <table class="compact-table">
                    <thead>
                        <tr>
                            <th>–ú–µ—Å—Ç–æ</th>
                            <th>–ò–≥—Ä–æ–∫</th>
                            <th>–û—á–∫–∏</th>
                            <th>–ú–∞—Ç—á–∏</th>
                            <th>–ü–æ–±–µ–¥</th>
                            <th>–ü–æ—Å–ª–µ–¥–Ω—è—è –∏–≥—Ä–∞</th>
                            <th>–ù–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="ratingBody"></tbody>
                </table>
            </div>
            
            <!-- –ë–õ–û–ö –î–û–°–¢–ò–ñ–ï–ù–ò–ô –ò –ü–û–û–©–†–ï–ù–ò–ô - –ù–û–í–´–ô –ö–û–î -->
            <div class="achievements-container" id="achievementsContainer">
                <div class="achievements-header">
                    <div class="level-icon">üèÜ</div>
                    <h3>–°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π</h3>
                </div>
                
                <div id="achievementsContent">
                    <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫–æ–Ω—Ç–µ–Ω—Ç -->
                    <p>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –∏–≥—Ä–æ–∫–æ–≤...</p>
                </div>
                
                <!-- –î–û–ë–ê–í–õ–ï–ù–ê –ö–ù–û–ü–ö–ê –î–õ–Ø –†–£–ß–ù–û–ì–û –ü–†–ò–ú–ï–ù–ï–ù–ò–Ø –ë–û–ù–£–°–û–í -->
                <div style="margin-top: 20px; text-align: center;">
                    <button class="add-btn action-btn" onclick="applyAchievementBonuses()" id="applyBonusesBtn" style="padding: 10px 20px; font-size: 14px;">
                        üéÅ –ü—Ä–∏–º–µ–Ω–∏—Ç—å –±–æ–Ω—É—Å—ã –∑–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
                    </button>
                    <p style="font-size: 0.85em; margin-top: 8px; opacity: 0.9;">
                        <strong>–í–Ω–∏–º–∞–Ω–∏–µ:</strong> –ë–æ–Ω—É—Å—ã –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –∑–∞ –∫–∞–∂–¥—ã–π –¥–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å.
                        –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —É –∏–≥—Ä–æ–∫–æ–≤ –µ—Å—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π —Ä–µ–π—Ç–∏–Ω–≥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–æ–Ω—É—Å–æ–≤.
                    </p>
                </div>
                
                <div class="levels-info">
                    <h4>üéØ –£—Ä–æ–≤–Ω–∏ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–∞</h4>
                    <p>–ö–∞–∂–¥—ã–π –∏–≥—Ä–æ–∫ –º–æ–∂–µ—Ç –¥–æ—Å—Ç–∏—á—å —Å–ª–µ–¥—É—é—â–∏—Ö —É—Ä–æ–≤–Ω–µ–π:</p>
                    <div class="levels-list">
                        <div class="level-badge">ü•â 1100 - –ù–∞—á–∏–Ω–∞—é—â–∏–π —á–µ–º–ø–∏–æ–Ω</div>
                        <div class="level-badge">ü•à 1300 - –û–ø—ã—Ç–Ω—ã–π –±–æ–µ—Ü</div>
                        <div class="level-badge">ü•á 1500 - –ú–∞—Å—Ç–µ—Ä —Å—Ç–æ–ª–∞</div>
                        <div class="level-badge">üëë 2000 - –õ–µ–≥–µ–Ω–¥–∞ –ª–∏–≥–∏</div>
                    </div>
                    <p style="margin-top: 10px; font-size: 0.9em; opacity: 0.9;">
                        <strong>–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:</strong> –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ —Ç–µ–∫—É—â–µ–º—É —Ä–µ–π—Ç–∏–Ω–≥—É –∏–≥—Ä–æ–∫–æ–≤. 
                        –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞.
                        <br>üéÅ <strong>–ë–æ–Ω—É—Å—ã:</strong> –ó–∞ –∫–∞–∂–¥—ã–π –¥–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å –∏–≥—Ä–æ–∫ –ø–æ–ª—É—á–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ—á–∫–∏:
                        ü•â +16 –æ—á–∫–æ–≤, ü•à +20 –æ—á–∫–æ–≤, ü•á +30 –æ—á–∫–æ–≤, üëë +50 –æ—á–∫–æ–≤
                    </p>
                </div>
            </div>
        </div>
        
        <!-- ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –≤–∫–ª–∞–¥–∫–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ... -->
        
        <!-- –ü–∞–Ω–µ–ª–∏ –≤–Ω–∏–∑—É —Å–∞–π—Ç–∞ -->
        <div class="bottom-panels">
            <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–π—Ç–∏–Ω–≥–æ–º (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä) -->
            <div class="admin-controls-panel" id="ratingAdminControls">
                <h4>‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–º (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)</h4>
                <button class="penalty-btn action-btn" onclick="checkAndApplyPenalties()">
                    ‚ö†Ô∏è –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∞–≤—Ç–æ-—à—Ç—Ä–∞—Ñ—ã (14+ –¥–Ω–µ–π = -60)
                </button>
                <button class="add-btn action-btn" onclick="saveManualRatings()">
                    üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—á–∫–æ–≤
                </button>
                <p><small>–ò–∑–º–µ–Ω–∏—Ç–µ –æ—á–∫–∏ –≤ –ø–æ–ª—è—Ö –≤–≤–æ–¥–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ —Ä–µ–π—Ç–∏–Ω–≥–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—á–∫–æ–≤"</small></p>
            </div>
            
            <!-- –ü–∞–Ω–µ–ª—å Supabase -->
            <div class="supabase-panel">
                <div class="supabase-status">
                    <strong>‚òÅÔ∏è Supabase Cloud Sync</strong>
                    <div>–°—Ç–∞—Ç—É—Å: <span id="supabaseStatus" class="status-loading">‚è≥ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</span></div>
                    <div>–û–±–Ω–æ–≤–ª–µ–Ω–æ: <span id="supabaseTime">--:--:--</span></div>
                </div>
                <button class="action-btn add-btn" onclick="loadAllData()" id="refreshBtn">
                    üîÑ –û–±–Ω–æ–≤–∏—Ç—å
                </button>
            </div>
            
            <!-- –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ -->
            <div class="admin-panel" id="adminPanel">
                <h3>‚öôÔ∏è –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h3>
                <p>–í—ã –≤–æ—à–ª–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä. –î–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.</p>
                <button class="logout-btn" onclick="logoutAdmin()">üö™ –í—ã–π—Ç–∏ –∏–∑ –∞–¥–º–∏–Ω-—Ä–µ–∂–∏–º–∞</button>
            </div>
            
            <!-- –ü–∞–Ω–µ–ª—å –≤—Ö–æ–¥–∞ -->
            <div class="login-panel" id="loginPanel">
                <h3>üîê –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π</h3>
                <p>–î–ª—è –≤–Ω–µ—Å–µ–Ω–∏—è –º–∞—Ç—á–µ–π –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤–æ–π–¥–∏—Ç–µ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:</p>
                <input type="password" id="adminPassword" class="password-input" placeholder="–ü–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞">
                <button class="login-btn" onclick="loginAdmin()">–í–æ–π—Ç–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</button>
            </div>
        </div>
    </div>

    <script>
    // ============================================
    // –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø SUPABASE
    // ============================================
    const SUPABASE_URL = 'https://bqycjfcjtdawyrysgrbw.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxeWNqZmNqdGRhd3lyeXNncmJ3Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2NjYwMTk3MCwiZXhwIjoyMDgyMTc3OTcwfQ.lHA_79fw8PSj9ZHMExBpSEIpkonkCYOni7HniGGqadY';
    
    let supabaseClient = null;
    let isSupabaseInitialized = false;
    
    // ============================================
    // –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
    // ============================================
    let players = {};
    let matches = [];
    let penaltyLog = [];
    let isAdmin = false;
    const ADMIN_PASSWORD = "admin123";
    
    // ============================================
    // –°–ò–°–¢–ï–ú–ê –î–û–°–¢–ò–ñ–ï–ù–ò–ô - –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –ö–û–î
    // ============================================
    
    // –£—Ä–æ–≤–Ω–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π —Å –±–æ–Ω—É—Å–∞–º–∏
    const ACHIEVEMENT_LEVELS = [
        { threshold: 1100, name: "–ù–∞—á–∏–Ω–∞—é—â–∏–π —á–µ–º–ø–∏–æ–Ω", icon: "ü•â", color: "#CD7F32", 
          description: "–û—Ç–ª–∏—á–Ω—ã–π —Å—Ç–∞—Ä—Ç! –¢—ã —É–∂–µ –æ–ø–µ—Ä–µ–∂–∞–µ—à—å –º–Ω–æ–≥–∏—Ö –∏–≥—Ä–æ–∫–æ–≤ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—à—å –±–æ–ª—å—à–æ–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª.",
          bonus: 16, pointsText: "+16 –æ—á–∫–æ–≤ –∫ –æ–±—â–µ–º—É —Ä–µ–π—Ç–∏–Ω–≥—É" },
        { threshold: 1300, name: "–û–ø—ã—Ç–Ω—ã–π –±–æ–µ—Ü", icon: "ü•à", color: "#C0C0C0", 
          description: "–°–µ—Ä—å–µ–∑–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å! –¢—ã –ø–æ–∫–∞–∑—ã–≤–∞–µ—à—å —Å—Ç–∞–±–∏–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –∫–∞–∂–¥–æ–π –∏–≥—Ä–µ.",
          bonus: 20, pointsText: "+20 –æ—á–∫–æ–≤ –∫ –æ–±—â–µ–º—É —Ä–µ–π—Ç–∏–Ω–≥—É" },
        { threshold: 1500, name: "–ú–∞—Å—Ç–µ—Ä —Å—Ç–æ–ª–∞", icon: "ü•á", color: "#FF9800", 
          description: "–í–µ–ª–∏–∫–æ–ª–µ–ø–Ω–∞—è –∏–≥—Ä–∞! –¢–≤–æ–∏ –Ω–∞–≤—ã–∫–∏ –ø–æ—Ä–∞–∂–∞—é—Ç –≤—Å–µ—Ö —Å–æ–ø–µ—Ä–Ω–∏–∫–æ–≤ –Ω–∞ —Å—Ç–æ–ª–µ.",
          bonus: 30, pointsText: "+30 –æ—á–∫–æ–≤ –∫ –æ–±—â–µ–º—É —Ä–µ–π—Ç–∏–Ω–≥—É" },
        { threshold: 2000, name: "–õ–µ–≥–µ–Ω–¥–∞ –ª–∏–≥–∏", icon: "üëë", color: "#FFD700", 
          description: "–ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ–µ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ! –¢—ã –≤–æ—à–µ–ª –≤ –∏—Å—Ç–æ—Ä–∏—é –ª–∏–≥–∏ –∫–∞–∫ –∏—Å—Ç–∏–Ω–Ω–∞—è –ª–µ–≥–µ–Ω–¥–∞ –Ω–∞—Å—Ç–æ–ª—å–Ω–æ–≥–æ —Ç–µ–Ω–Ω–∏—Å–∞.",
          bonus: 50, pointsText: "+50 –æ—á–∫–æ–≤ –∫ –æ–±—â–µ–º—É —Ä–µ–π—Ç–∏–Ω–≥—É" }
    ];
    
    // ============================================
    // –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò SUPABASE - –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï
    // ============================================
    
    // 1. –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ - –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø
    async function loadAllData() {
        if (!supabaseClient) {
            console.log('üîÑ Supabase –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω, –ø—Ä–æ–±—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å...');
            await initSupabase();
            return;
        }
        
        try {
            console.log('üîÑ –ó–∞–≥—Ä—É–∂–∞—é –¥–∞–Ω–Ω—ã–µ –∏–∑ Supabase...');
            updateSupabaseStatus('üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è...');
            document.getElementById('refreshBtn').disabled = true;
            document.getElementById('refreshBtn').classList.add('loading');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–≥—Ä–æ–∫–æ–≤
            const { data: playersData, error: playersError } = await supabaseClient
                .from('players')
                .select('*')
                .order('rating', { ascending: false });
            
            if (playersError) {
                if (playersError.message.includes('does not exist')) {
                    console.log('‚ö†Ô∏è –¢–∞–±–ª–∏—Ü–∞ players –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç');
                    updateSupabaseStatus('‚ö†Ô∏è –ù–µ—Ç —Ç–∞–±–ª–∏—Ü');
                } else {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä–æ–∫–æ–≤:', playersError);
                    updateSupabaseStatus('‚ùå –û—à–∏–±–∫–∞ –¥–∞–Ω–Ω—ã—Ö');
                }
            } else if (playersData) {
                const newPlayers = {};
                playersData.forEach(player => {
                    // –í–ê–ñ–ù–û: –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—ã–¥–∞–Ω–Ω—ã—Ö –±–æ–Ω—É—Å–∞—Ö –∏–∑ JSONB –ø–æ–ª—è
                    let achievementBonuses = {};
                    try {
                        if (player.achievement_bonuses && typeof player.achievement_bonuses === 'object') {
                            achievementBonuses = player.achievement_bonuses;
                        } else if (typeof player.achievement_bonuses === 'string' && player.achievement_bonuses.trim() !== '') {
                            achievementBonuses = JSON.parse(player.achievement_bonuses);
                        }
                    } catch (e) {
                        console.warn(`‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ achievement_bonuses –¥–ª—è ${player.name}:`, e);
                        achievementBonuses = {};
                    }
                    
                    newPlayers[player.name] = {
                        id: player.id,
                        rating: player.rating || 1000,
                        matches: player.matches || 0,
                        wins: player.wins || 0,
                        lastGame: player.last_game ? new Date(player.last_game) : null,
                        joinDate: player.join_date ? new Date(player.join_date) : new Date(),
                        penalties: player.penalties || 0,
                        avatar: player.avatar || `https://i.pravatar.cc/150?img=${Math.floor(Math.random() * 70) + 1}`,
                        created_at: player.created_at,
                        // –í–ê–ñ–ù–û: –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—ã–¥–∞–Ω–Ω—ã—Ö –±–æ–Ω—É—Å–∞—Ö
                        achievementBonuses: achievementBonuses
                    };
                });
                players = newPlayers;
                console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${playersData.length} –∏–≥—Ä–æ–∫–æ–≤`);
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –º–∞—Ç—á–∏
            const { data: matchesData, error: matchesError } = await supabaseClient
                .from('matches')
                .select('*')
                .order('date', { ascending: false });
            
            if (matchesError && !matchesError.message.includes('does not exist')) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–∞—Ç—á–µ–π:', matchesError);
            } else if (matchesData) {
                matches = matchesData.map(match => ({
                    id: match.id,
                    date: new Date(match.date),
                    player1: match.player1,
                    player2: match.player2,
                    winner: match.winner,
                    change1: match.change1 || 0,
                    change2: match.change2 || 0,
                    score: match.score || ''
                }));
                console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${matchesData.length} –º–∞—Ç—á–µ–π`);
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —à—Ç—Ä–∞—Ñ—ã
            const { data: penaltiesData, error: penaltiesError } = await supabaseClient
                .from('penalties')
                .select('*')
                .order('date', { ascending: false });
            
            if (penaltiesError && !penaltiesError.message.includes('does not exist')) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —à—Ç—Ä–∞—Ñ–æ–≤:', penaltiesError);
            } else if (penaltiesData) {
                penaltyLog = penaltiesData.map(penalty => ({
                    id: penalty.id,
                    date: new Date(penalty.date),
                    player: penalty.player,
                    amount: penalty.amount || 0,
                    daysInactive: penalty.days_inactive || 0,
                    manual: penalty.manual || false
                }));
                console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${penaltiesData.length} —à—Ç—Ä–∞—Ñ–æ–≤`);
            }
            
            console.log('‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ Supabase');
            updateSupabaseStatus('‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ');
            updateSupabaseTime();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            updateAllDisplays();
            
        } catch (error) {
            console.error('‚ùå –û–±—â–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
            updateSupabaseStatus('‚ùå –û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏');
        } finally {
            document.getElementById('refreshBtn').disabled = false;
            document.getElementById('refreshBtn').classList.remove('loading');
        }
    }
    
    // 2. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–≥—Ä–æ–∫–∞ - –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø
    async function savePlayerToSupabase(name, playerData) {
        if (!supabaseClient) return;
        
        try {
            // –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
            const playerToSave = {
                name: name,
                rating: playerData.rating,
                matches: playerData.matches,
                wins: playerData.wins,
                last_game: playerData.lastGame ? playerData.lastGame.toISOString() : null,
                join_date: playerData.joinDate ? playerData.joinDate.toISOString() : new Date().toISOString(),
                penalties: playerData.penalties || 0,
                avatar: playerData.avatar,
                // –í–ê–ñ–ù–û: –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—ã–¥–∞–Ω–Ω—ã—Ö –±–æ–Ω—É—Å–∞—Ö
                achievement_bonuses: playerData.achievementBonuses || {},
                updated_at: new Date().toISOString()
            };
            
            const { error } = await supabaseClient
                .from('players')
                .upsert(playerToSave, {
                    onConflict: 'name'
                });
            
            if (error) throw error;
            console.log(`‚úÖ –ò–≥—Ä–æ–∫ ${name} —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ Supabase`);
        } catch (error) {
            console.error(`‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞ ${name}:`, error);
        }
    }
    
    // 3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–∞—Ç—á
    async function saveMatchToSupabase(match) {
        if (!supabaseClient) return;
        
        try {
            const { error } = await supabaseClient
                .from('matches')
                .insert({
                    date: match.date.toISOString(),
                    player1: match.player1,
                    player2: match.player2,
                    winner: match.winner,
                    change1: match.change1,
                    change2: match.change2,
                    score: match.score
                });
            
            if (error) throw error;
            console.log('‚úÖ –ú–∞—Ç—á —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ Supabase');
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –º–∞—Ç—á–∞:', error);
        }
    }
    
    // 4. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —à—Ç—Ä–∞—Ñ
    async function savePenaltyToSupabase(penalty) {
        if (!supabaseClient) return;
        
        try {
            const { error } = await supabaseClient
                .from('penalties')
                .insert({
                    date: penalty.date.toISOString(),
                    player: penalty.player,
                    amount: penalty.amount,
                    days_inactive: penalty.daysInactive,
                    manual: penalty.manual || false
                });
            
            if (error) throw error;
            console.log('‚úÖ –®—Ç—Ä–∞—Ñ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ Supabase');
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —à—Ç—Ä–∞—Ñ–∞:', error);
        }
    }
    
    // 5. –£–¥–∞–ª–∏—Ç—å –º–∞—Ç—á –∏–∑ Supabase
    async function deleteMatchFromSupabase(matchId) {
        if (!supabaseClient) return;
        
        try {
            const { error } = await supabaseClient
                .from('matches')
                .delete()
                .eq('id', matchId);
            
            if (error) throw error;
            console.log(`‚úÖ –ú–∞—Ç—á —É–¥–∞–ª–µ–Ω –∏–∑ Supabase`);
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –º–∞—Ç—á–∞:', error);
        }
    }
    
    // 6. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å Supabase
    function updateSupabaseStatus(status) {
        const statusElement = document.getElementById('supabaseStatus');
        if (statusElement) {
            statusElement.textContent = status;
            statusElement.className = status.includes('‚úÖ') ? 'status-connected' : 
                                      status.includes('‚ùå') ? 'status-error' : 
                                      'status-loading';
        }
    }
    
    function updateSupabaseTime() {
        const timeElement = document.getElementById('supabaseTime');
        if (timeElement) {
            const now = new Date();
            timeElement.textContent = now.toLocaleTimeString();
        }
    }
    
    // ============================================
    // –§–£–ù–ö–¶–ò–ò –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–ê - –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï
    // ============================================
    
    function loginAdmin() {
        const password = document.getElementById('adminPassword').value;
        
        if (password === ADMIN_PASSWORD) {
            isAdmin = true;
            document.getElementById('appContainer').classList.add('admin-active');
            document.getElementById('loginPanel').style.display = 'none';
            document.getElementById('adminPassword').value = '';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–¥–º–∏–Ω-–∫–æ–Ω—Ç—Ä–æ–ª—ã
            document.getElementById('ratingAdminControls').style.display = 'block';
            document.getElementById('matchesAdminControls').style.display = 'block';
            document.getElementById('penaltiesAdminControls').style.display = 'block';
            document.getElementById('playersAdminControls').style.display = 'block';
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            localStorage.setItem('tennisAdmin', 'true');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            updateAllDisplays();
            
            // –£–ë–ï–†–ê–ï–ú –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –ü–†–ò–ú–ï–ù–ï–ù–ò–ï –ë–û–ù–£–°–û–í
            // –¢–µ–ø–µ—Ä—å –±–æ–Ω—É—Å—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ –Ω–∞–∂–∞—Ç–∏—é –∫–Ω–æ–ø–∫–∏
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            showNotification('‚úÖ –í—ã –≤–æ—à–ª–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä!', 'success');
        } else {
            showNotification('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!', 'error');
        }
    }
    
    // ============================================
    // –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤ –∑–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è - –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø
    // ============================================
    
    async function applyAchievementBonuses() {
        if (!isAdmin) {
            showNotification('‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å –±–æ–Ω—É—Å—ã!', 'error');
            return;
        }
        
        if (!supabaseClient) {
            showNotification('‚ùå Supabase –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω!', 'error');
            return;
        }
        
        if (!confirm('–ü—Ä–∏–º–µ–Ω–∏—Ç—å –±–æ–Ω—É—Å—ã –∑–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –≤—Å–µ–º –∏–≥—Ä–æ–∫–∞–º?\n\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑!\n–ë–æ–Ω—É—Å—ã –±—É–¥—É—Ç –Ω–∞—á–∏—Å–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ –∑–∞ —É—Ä–æ–≤–Ω–∏, –∫–æ—Ç–æ—Ä—ã–µ –µ—â–µ –Ω–µ –±—ã–ª–∏ –Ω–∞–≥—Ä–∞–∂–¥–µ–Ω—ã.')) {
            return;
        }
        
        // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
        const applyBtn = document.getElementById('applyBonusesBtn');
        const originalText = applyBtn.innerHTML;
        applyBtn.innerHTML = '‚è≥ –û–±—Ä–∞–±–æ—Ç–∫–∞...';
        applyBtn.disabled = true;
        
        let anyBonusesApplied = false;
        const appliedBonuses = [];
        
        try {
            for (const [playerName, playerData] of Object.entries(players)) {
                const rating = playerData.rating;
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ–ª–µ –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
                if (!playerData.achievementBonuses) {
                    playerData.achievementBonuses = {};
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–π —É—Ä–æ–≤–µ–Ω—å
                for (const level of ACHIEVEMENT_LEVELS) {
                    if (rating >= level.threshold) {
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –ø–æ–ª—É—á–∞–ª –ª–∏ —É–∂–µ –∏–≥—Ä–æ–∫ —ç—Ç–æ—Ç –±–æ–Ω—É—Å
                        if (!playerData.achievementBonuses[level.threshold]) {
                            // –í—ã–¥–∞–µ–º –±–æ–Ω—É—Å
                            const originalRating = playerData.rating;
                            playerData.rating += level.bonus;
                            playerData.achievementBonuses[level.threshold] = {
                                awarded: true,
                                date: new Date().toISOString(),
                                bonus: level.bonus,
                                levelName: level.name,
                                originalRating: originalRating,
                                newRating: playerData.rating
                            };
                            anyBonusesApplied = true;
                            
                            appliedBonuses.push({
                                player: playerName,
                                level: level.name,
                                bonus: level.bonus,
                                originalRating: originalRating,
                                newRating: playerData.rating
                            });
                            
                            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Supabase
                            await savePlayerToSupabase(playerName, playerData);
                            
                            console.log(`üéÅ –ò–≥—Ä–æ–∫ ${playerName} –ø–æ–ª—É—á–∏–ª –±–æ–Ω—É—Å ${level.bonus} –æ—á–∫–æ–≤ –∑–∞ —É—Ä–æ–≤–µ–Ω—å ${level.name}`);
                        }
                    }
                }
            }
            
            if (anyBonusesApplied) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                updateAllDisplays();
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç
                let message = "‚úÖ –ë–æ–Ω—É—Å—ã –∑–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã:\n\n";
                appliedBonuses.forEach(b => {
                    message += `‚Ä¢ ${b.player}: +${b.bonus} –∑–∞ ${b.level} (${b.originalRating} ‚Üí ${b.newRating})\n`;
                });
                
                message += `\n–í—Å–µ–≥–æ –Ω–∞—á–∏—Å–ª–µ–Ω–æ –±–æ–Ω—É—Å–æ–≤: ${appliedBonuses.length}`;
                
                alert(message);
                showNotification(`‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω—ã –±–æ–Ω—É—Å—ã –¥–ª—è ${appliedBonuses.length} –∏–≥—Ä–æ–∫–æ–≤`, 'success');
            } else {
                showNotification('‚úÖ –í—Å–µ –±–æ–Ω—É—Å—ã —É–∂–µ –±—ã–ª–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã —Ä–∞–Ω–µ–µ', 'info');
            }
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –±–æ–Ω—É—Å–æ–≤:', error);
            showNotification('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –±–æ–Ω—É—Å–æ–≤', 'error');
        } finally {
            // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
            applyBtn.innerHTML = originalText;
            applyBtn.disabled = false;
        }
    }
    
    // ============================================
    // –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò –î–õ–Ø –°–ò–°–¢–ï–ú–´ –î–û–°–¢–ò–ñ–ï–ù–ò–ô
    // ============================================
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —ç–º–æ–¥–∑–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É
    function getAchievementEmojis(rating) {
        const achievements = [
            { threshold: 1100, emoji: 'ü•â' },
            { threshold: 1300, emoji: 'ü•à' },
            { threshold: 1500, emoji: 'ü•á' },
            { threshold: 2000, emoji: 'üëë' }
        ];
        
        let emojis = '';
        achievements.forEach(achievement => {
            if (rating >= achievement.threshold) {
                emojis += `<span class="achievement-emoji">${achievement.emoji}</span>`;
            }
        });
        
        return emojis;
    }
    
    // –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞
    function getPlayerAchievements(playerName, playerData) {
        const achievements = [];
        const rating = playerData.rating;
        
        // –°–æ—Ä—Ç–∏—Ä—É–µ–º —É—Ä–æ–≤–Ω–∏ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–ª–µ–¥—É—é—â–µ–π —Ü–µ–ª–∏
        const sortedLevels = [...ACHIEVEMENT_LEVELS].sort((a, b) => a.threshold - b.threshold);
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–µ —É—Ä–æ–≤–Ω–∏
        sortedLevels.forEach(level => {
            if (rating >= level.threshold) {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ —É–∂–µ –Ω–∞—á–∏—Å–ª–µ–Ω –±–æ–Ω—É—Å –∑–∞ —ç—Ç–æ—Ç —É—Ä–æ–≤–µ–Ω—å
                const bonusAwarded = playerData.achievementBonuses && playerData.achievementBonuses[level.threshold];
                
                achievements.push({
                    ...level,
                    achieved: true,
                    bonusAwarded: bonusAwarded,
                    playerName: playerName,
                    playerData: playerData
                });
            }
        });
        
        // –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å (–ø–µ—Ä–≤—ã–π –ù–ï –¥–æ—Å—Ç–∏–≥–Ω—É—Ç—ã–π)
        const nextLevel = sortedLevels.find(level => rating < level.threshold);
        if (nextLevel) {
            achievements.push({
                ...nextLevel,
                achieved: false,
                bonusAwarded: false,
                playerName: playerName,
                playerData: playerData,
                pointsNeeded: nextLevel.threshold - rating
            });
        }
        
        return achievements;
    }
    
    // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤ —Å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º–∏
    function getAllAchievements() {
        const allAchievements = [];
        
        Object.entries(players).forEach(([name, data]) => {
            const playerAchievements = getPlayerAchievements(name, data);
            if (playerAchievements.length > 0) {
                allAchievements.push({
                    playerName: name,
                    playerData: data,
                    achievements: playerAchievements
                });
            }
        });
        
        // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —Å–∞–º–æ–º—É –≤—ã—Å–æ–∫–æ–º—É –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—é
        allAchievements.sort((a, b) => {
            const aMax = Math.max(...a.achievements.filter(ach => ach.achieved).map(ach => ach.threshold));
            const bMax = Math.max(...b.achievements.filter(ach => ach.achieved).map(ach => ach.threshold));
            return bMax - aMax;
        });
        
        return allAchievements;
    }
    
    // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
    function updateAchievementsDisplay() {
        const container = document.getElementById('achievementsContent');
        if (!container) return;
        
        const allAchievements = getAllAchievements();
        
        if (allAchievements.length === 0) {
            container.innerHTML = `
                <p style="text-align: center; padding: 20px; font-size: 1.1em;">
                    üéæ –ò–≥—Ä–æ–∫–∏ –µ—â–µ –Ω–µ –¥–æ—Å—Ç–∏–≥–ª–∏ —É—Ä–æ–≤–Ω–µ–π –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–∞. 
                    –ò–≥—Ä–∞–π—Ç–µ –±–æ–ª—å—à–µ –º–∞—Ç—á–µ–π –∏ –ø–æ–≤—ã—à–∞–π—Ç–µ —Ä–µ–π—Ç–∏–Ω–≥!
                </p>
            `;
            return;
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∏–≥—Ä–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø–æ–ª—É—á–∏—Ç—å –±–æ–Ω—É—Å—ã
        let playersWithPendingBonuses = 0;
        allAchievements.forEach(playerAchievement => {
            const pendingBonuses = playerAchievement.achievements.filter(
                ach => ach.achieved && !ach.bonusAwarded
            ).length;
            if (pendingBonuses > 0) {
                playersWithPendingBonuses++;
            }
        });
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –±–æ–Ω—É—Å–∞—Ö
        let html = '';
        if (playersWithPendingBonuses > 0 && isAdmin) {
            html += `
                <div style="background: rgba(255, 215, 0, 0.2); padding: 15px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #FFD700;">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                        <div style="font-size: 1.5em;">üéÅ</div>
                        <div style="font-weight: bold;">–î–æ—Å—Ç—É–ø–Ω—ã –±–æ–Ω—É—Å—ã –¥–ª—è ${playersWithPendingBonuses} –∏–≥—Ä–æ–∫–æ–≤!</div>
                    </div>
                    <p style="margin: 0; font-size: 0.95em;">
                        –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ü—Ä–∏–º–µ–Ω–∏—Ç—å –±–æ–Ω—É—Å—ã –∑–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è", —á—Ç–æ–±—ã –Ω–∞—á–∏—Å–ª–∏—Ç—å –±–æ–Ω—É—Å–Ω—ã–µ –æ—á–∫–∏ –∏–≥—Ä–æ–∫–∞–º.
                        –ë–æ–Ω—É—Å—ã –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –∑–∞ –∫–∞–∂–¥—ã–π —É—Ä–æ–≤–µ–Ω—å.
                    </p>
                </div>
            `;
        }
        
        html += '<div class="achievements-grid">';
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ —Ç–æ–ø–æ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è (–ø–µ—Ä–≤—ã–µ 4)
        const topAchievements = allAchievements.slice(0, 4);
        
        topAchievements.forEach(playerAchievement => {
            const highestAchieved = playerAchievement.achievements
                .filter(ach => ach.achieved)
                .sort((a, b) => b.threshold - a.threshold)[0];
            
            const nextToAchieve = playerAchievement.achievements
                .filter(ach => !ach.achieved)[0];
            
            if (highestAchieved) {
                html += `
                    <div class="achievement-card">
                        <div class="achievement-player">
                            <img src="${playerAchievement.playerData.avatar}" 
                                 class="achievement-avatar" 
                                 onerror="this.src='https://i.pravatar.cc/150?img=3'}">
                            <div class="achievement-player-info">
                                <div class="achievement-player-name" onclick="showPlayerProfile('${playerAchievement.playerName}')">
                                    ${playerAchievement.playerName}
                                </div>
                                <div class="achievement-player-rating">–†–µ–π—Ç–∏–Ω–≥: ${playerAchievement.playerData.rating} –æ—á–∫–æ–≤</div>
                            </div>
                        </div>
                        
                        <div class="achievement-level">
                            <div class="level-icon" style="color: ${highestAchieved.color}">${highestAchieved.icon}</div>
                            <div class="level-title" style="color: ${highestAchieved.color}">
                                ${highestAchieved.name} (${highestAchieved.threshold}+)
                            </div>
                        </div>
                        
                        <div class="level-description">
                            ${highestAchieved.description}
                            ${highestAchieved.bonus ? `
                                <div style="margin-top: 8px; padding: 5px 10px; background: rgba(255,255,255,0.2); border-radius: 5px; font-size: 0.85em;">
                                    üéÅ –ë–æ–Ω—É—Å: ${highestAchieved.pointsText}
                                    ${highestAchieved.bonusAwarded ? 
                                        '<br><span style="color: #4CAF50;">‚úÖ –ë–æ–Ω—É—Å —É–∂–µ –Ω–∞—á–∏—Å–ª–µ–Ω</span>' : 
                                        '<br><span style="color: #FFD700;">‚è≥ –ë–æ–Ω—É—Å –æ–∂–∏–¥–∞–µ—Ç –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è</span>'
                                    }
                                </div>
                            ` : ''}
                        </div>
                        
                        ${nextToAchieve ? `
                            <div class="achievement-congrats">
                                <strong>–°–ª–µ–¥—É—é—â–∞—è —Ü–µ–ª—å:</strong> ${nextToAchieve.name} (${nextToAchieve.threshold} –æ—á–∫–æ–≤)
                                <br>–û—Å—Ç–∞–ª–æ—Å—å –Ω–∞–±—Ä–∞—Ç—å: ${nextToAchieve.pointsNeeded} –æ—á–∫–æ–≤
                            </div>
                        ` : `
                            <div class="achievement-congrats">
                                <strong>üèÜ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç!</strong>
                                <br>–¢—ã –¥–æ—Å—Ç–∏–≥ –≤–µ—Ä—à–∏–Ω—ã –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–∞ –≤ –Ω–∞—à–µ–π –ª–∏–≥–µ!
                            </div>
                        `}
                    </div>
                `;
            }
        });
        
        html += '</div>';
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        const totalPlayers = Object.keys(players).length;
        const playersWithAchievements = allAchievements.filter(p => 
            p.achievements.some(a => a.achieved)
        ).length;
        
        if (totalPlayers > 0) {
            html += `
                <div style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                    <h4>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π</h4>
                    <p>–ò–≥—Ä–æ–∫–æ–≤ —Å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º–∏: ${playersWithAchievements} –∏–∑ ${totalPlayers} (${Math.round(playersWithAchievements/totalPlayers*100)}%)</p>
                    <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px;">
            `;
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º —É—Ä–æ–≤–Ω–∏ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
            const sortedLevelsForDisplay = [...ACHIEVEMENT_LEVELS].sort((a, b) => a.threshold - b.threshold);
            
            sortedLevelsForDisplay.forEach(level => {
                const playersAtLevel = allAchievements.filter(p => 
                    p.achievements.some(a => a.achieved && a.threshold === level.threshold)
                ).length;
                
                const playersWithBonus = allAchievements.filter(p => 
                    p.achievements.some(a => a.achieved && a.threshold === level.threshold && a.bonusAwarded)
                ).length;
                
                if (playersAtLevel > 0) {
                    html += `
                        <div style="background: ${level.color}20; padding: 5px 10px; border-radius: 15px; border: 1px solid ${level.color}50;">
                            ${level.icon} ${level.name}: ${playersAtLevel} –∏–≥—Ä–æ–∫–æ–≤
                            ${playersWithBonus > 0 ? `<br><small>${playersWithBonus} –ø–æ–ª—É—á–∏–ª–∏ –±–æ–Ω—É—Å</small>` : ''}
                        </div>
                    `;
                }
            });
            
            html += `</div></div>`;
        }
        
        container.innerHTML = html;
    }
    
    // ============================================
    // –û–°–¢–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò (–ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô)
    // ============================================
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–≥—Ä–æ–∫–∞
    function showPlayerProfile(playerName) {
        if (!players[playerName]) {
            showNotification('–ò–≥—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
            return;
        }
        
        const playerData = players[playerName];
        
        // –°–∫—Ä—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–≥—Ä–æ–∫–∞
        document.getElementById('appContainer').style.display = 'none';
        document.getElementById('playerProfileContainer').style.display = 'block';
        
        // –ó–∞–ø–æ–ª–Ω—è–µ–º –æ—Å–Ω–æ–≤–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
        document.getElementById('playerProfileName').textContent = playerName;
        document.getElementById('playerProfileAvatar').src = playerData.avatar;
        document.getElementById('playerProfileRating').textContent = `–†–µ–π—Ç–∏–Ω–≥: ${playerData.rating} –æ—á–∫–æ–≤`;
        
        // –î–æ–±–∞–≤–ª—è–µ–º —ç–º–æ–¥–∑–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        const emojisContainer = document.getElementById('playerProfileEmojis');
        emojisContainer.innerHTML = getAchievementEmojis(playerData.rating);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        updatePlayerStats(playerName);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
        updatePlayerAchievements(playerName);
        
        // –°—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫ —Ñ–æ—Ä–º—ã
        renderPlayerFormChart(playerName);
        
        // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–≤–µ—Ä—Ö —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.scrollTo(0, 0);
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
    function returnToMain() {
        document.getElementById('appContainer').style.display = 'block';
        document.getElementById('playerProfileContainer').style.display = 'none';
        
        // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–≤–µ—Ä—Ö —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.scrollTo(0, 0);
        return false;
    }
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Supabase
    async function initSupabase() {
        console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Supabase –∫–ª–∏–µ–Ω—Ç–∞...');
        updateSupabaseStatus('üîÑ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...');
        
        try {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
            if (!window.supabase) {
                console.log('üì¶ –ó–∞–≥—Ä—É–∂–∞—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É Supabase...');
                await loadSupabaseLibrary();
            }
            
            if (!window.supabase || !window.supabase.createClient) {
                throw new Error('–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ Supabase –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            }
            
            // –°–æ–∑–¥–∞–µ–º –∫–ª–∏–µ–Ω—Ç
            supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
            isSupabaseInitialized = true;
            
            console.log('‚úÖ Supabase –∫–ª–∏–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω');
            updateSupabaseStatus('‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            await loadAllData();
            
            // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            setInterval(loadAllData, 30000);
            
            return supabaseClient;
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Supabase:', error);
            updateSupabaseStatus('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è');
            return null;
        }
    }
    
    async function loadSupabaseLibrary() {
        return new Promise((resolve, reject) => {
            if (window.supabase) {
                console.log('‚úÖ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ Supabase —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
                resolve();
                return;
            }
            
            const script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js';
            script.async = true;
            
            script.onload = () => {
                console.log('‚úÖ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ Supabase –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
                resolve();
            };
            
            script.onerror = (error) => {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Supabase:', error);
                updateSupabaseStatus('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏');
                reject(error);
            };
            
            document.head.appendChild(script);
        });
    }
    
    // ============================================
    // –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò –ò–ù–¢–ï–†–§–ï–ô–°–ê
    // ============================================
    
    // 1. –û–±–Ω–æ–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É —Ä–µ–π—Ç–∏–Ω–≥–∞
    function updateRatingTable() {
        const tbody = document.getElementById('ratingBody');
        if (!tbody) return;
        
        tbody.innerHTML = '';
        
        const sortedPlayers = Object.entries(players)
            .sort(([,a], [,b]) => b.rating - a.rating);
        
        if (sortedPlayers.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="8" style="text-align: center; padding: 25px;">
                        <h3 style="font-size: 16px; margin-bottom: 10px;">üòï –ò–≥—Ä–æ–∫–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</h3>
                        <p style="font-size: 14px;">–í–æ–π–¥–∏—Ç–µ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∏ –¥–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞</p>
                    </td>
                </tr>
            `;
            return;
        }
        
        sortedPlayers.forEach(([name, data], index) => {
            const daysInactive = data.lastGame ? 
                Math.floor((new Date() - data.lastGame) / (1000 * 60 * 60 * 24)) : 
                Math.floor((new Date() - data.joinDate) / (1000 * 60 * 60 * 24));
            
            let status = "";
            let statusClass = "";
            if (daysInactive >= 14) {
                status = `‚ö†Ô∏è -${Math.floor(daysInactive / 14) * 60}`;
                statusClass = "danger";
            } else if (daysInactive >= 10) {
                status = `‚è≥ ${14 - daysInactive} –¥–Ω.`;
                statusClass = "warning";
            } else if (data.lastGame) {
                status = "‚úÖ –ê–∫—Ç–∏–≤–µ–Ω";
                statusClass = "success";
            } else {
                status = "üÜï –ù–æ–≤–∏—á–æ–∫";
                statusClass = "info";
            }
            
            const row = document.createElement('tr');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–ª–∏–Ω—É –∏–º–µ–Ω–∏ –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ —à—Ä–∏—Ñ—Ç–∞
            const nameLength = name.length;
            const nameClass = nameLength > 20 ? 'long-name' : '';
            
            // –ü–æ–ª—É—á–∞–µ–º —ç–º–æ–¥–∑–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –¥–ª—è –∏–≥—Ä–æ–∫–∞
            const emojis = getAchievementEmojis(data.rating);
            
            if (isAdmin) {
                row.innerHTML = `
                    <td><strong>${index + 1}</strong></td>
                    <td>
                        <div class="player-cell-with-emojis" onclick="showPlayerProfile('${name}')" style="cursor: pointer;">
                            <img src="${data.avatar}" class="avatar" 
                                 onerror="this.src='https://i.pravatar.cc/150?img=3'}">
                            <span class="${nameClass}">${name}</span>
                            <div class="player-emojis">${emojis}</div>
                        </div>
                    </td>
                    <td>
                        <input type="number" class="rating-input" 
                               value="${data.rating}" 
                               data-player="${name}"
                               min="0" max="3000">
                    </td>
                    <td>${data.matches}</td>
                    <td>${data.wins} (${data.matches ? Math.round(data.wins/data.matches*100) : 0}%)</td>
                    <td>${data.lastGame ? data.lastGame.toLocaleDateString('ru-RU') : '–ù–∏–∫–æ–≥–¥–∞'}</td>
                    <td>${daysInactive} –¥–Ω–µ–π</td>
                    <td>
                        <button class="penalty-btn action-btn" onclick="applyManualPenalty('${name}')" title="–ü—Ä–∏–º–µ–Ω–∏—Ç—å —à—Ç—Ä–∞—Ñ -60">
                            -60
                        </button>
                    </td>
                `;
            } else {
                row.innerHTML = `
                    <td><strong>${index + 1}</strong></td>
                    <td>
                        <div class="player-cell-with-emojis" onclick="showPlayerProfile('${name}')" style="cursor: pointer;">
                            <img src="${data.avatar}" class="avatar" 
                                 onerror="this.src='https://i.pravatar.cc/150?img=3'}">
                            <span class="${nameClass}">${name}</span>
                            <div class="player-emojis">${emojis}</div>
                        </div>
                    </td>
                    <td><span class="rating-badge">${data.rating}</span></td>
                    <td>${data.matches}</td>
                    <td>${data.wins} (${data.matches ? Math.round(data.wins/data.matches*100) : 0}%)</td>
                    <td>${data.lastGame ? data.lastGame.toLocaleDateString('ru-RU') : '–ù–∏–∫–æ–≥–¥–∞'}</td>
                    <td>${daysInactive} –¥–Ω–µ–π</td>
                    <td><span class="${statusClass}">${status}</span></td>
                `;
            }
            tbody.appendChild(row);
        });
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –±–ª–æ–∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã
        updateAchievementsDisplay();
    }
    
    // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π...
    
    // ============================================
    // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
    // ============================================
    async function init() {
        console.log('üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ-–ª–æ–≥–∏–Ω
        checkAutoLogin();
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–µ–≥–æ–¥–Ω—è—à–Ω—é—é –¥–∞—Ç—É
        setMatchDateToToday();
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Supabase
        await initSupabase();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–µ–ª–µ–∫—Ç–æ—Ä—ã
        updatePlayerSelects();
        
        console.log('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ');
    }
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
    } else {
        init();
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–∫—Ä–∞—Ç–∫–∏–µ –≤–µ—Ä—Å–∏–∏ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞)
    function logoutAdmin() {
        isAdmin = false;
        document.getElementById('appContainer').classList.remove('admin-active');
        document.getElementById('loginPanel').style.display = 'block';
        document.getElementById('ratingAdminControls').style.display = 'none';
        document.getElementById('matchesAdminControls').style.display = 'none';
        document.getElementById('penaltiesAdminControls').style.display = 'none';
        document.getElementById('playersAdminControls').style.display = 'none';
        localStorage.removeItem('tennisAdmin');
        updateAllDisplays();
        showNotification('üëã –í—ã –≤—ã—à–ª–∏ –∏–∑ —Ä–µ–∂–∏–º–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞', 'info');
    }
    
    function checkAutoLogin() {
        const saved = localStorage.getItem('tennisAdmin');
        if (saved === 'true') {
            isAdmin = true;
            document.getElementById('appContainer').classList.add('admin-active');
            document.getElementById('loginPanel').style.display = 'none';
            document.getElementById('ratingAdminControls').style.display = 'block';
            document.getElementById('matchesAdminControls').style.display = 'block';
            document.getElementById('penaltiesAdminControls').style.display = 'block';
            document.getElementById('playersAdminControls').style.display = 'block';
        }
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º CSS –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    const style = document.createElement('style');
    style.textContent = `
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
    `;
    document.head.appendChild(style);
    </script>
</body>
</html>
