<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>–†–µ–π—Ç–∏–Ω–≥ —Ç–µ–Ω–Ω–∏—Å–∞</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 8px;
            -webkit-text-size-adjust: 100%;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #4CAF50 0%, #2E7D32 100%);
            color: white;
            padding: 18px 12px;
            text-align: center;
        }
        
        header h1 {
            font-size: 1.6em;
            margin-bottom: 6px;
            word-break: break-word;
            line-height: 1.3;
        }
        
        .header-subtitle {
            font-size: 0.95em;
            opacity: 0.9;
            padding: 0 8px;
            line-height: 1.4;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–≥—Ä–æ–∫–∞ */
        .player-profile-container {
            padding: 20px 15px;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .player-profile-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        @media (min-width: 768px) {
            .player-profile-header {
                flex-direction: row;
                text-align: left;
                gap: 25px;
            }
        }
        
        .player-avatar-large {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 5px solid #4CAF50;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            flex-shrink: 0;
        }
        
        .player-info-large {
            flex: 1;
        }
        
        .player-name-large {
            font-size: 2.2em;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }
        
        .player-rating-large {
            font-size: 1.8em;
            color: #4CAF50;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .achievement-emojis {
            display: flex;
            gap: 5px;
            margin: 10px 0;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        @media (min-width: 768px) {
            .achievement-emojis {
                justify-content: flex-start;
            }
        }
        
        .achievement-emoji {
            font-size: 1.2em;
            margin-right: 2px;
            opacity: 0.9;
        }
        
        .back-button {
            display: inline-block;
            padding: 10px 20px;
            background: #4CAF50;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: bold;
            margin-top: 20px;
            transition: all 0.3s ease;
        }
        
        .back-button:hover {
            background: #45a049;
            transform: translateY(-2px);
        }
        
        .player-stats-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin: 30px 0;
        }
        
        @media (min-width: 768px) {
            .player-stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        .stat-period-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #e0e0e0;
            transition: transform 0.3s ease;
        }
        
        .stat-period-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .stat-period-box h3 {
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 3px solid #4CAF50;
            font-size: 1.4em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .stat-period-box p {
            margin: 8px 0;
            font-size: 1.1em;
        }
        
        .stat-value {
            font-weight: bold;
            color: #4CAF50;
        }
        
        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #e0e0e0;
            margin: 30px 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        
        .chart-container h3 {
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #4CAF50;
            font-size: 1.4em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .chart-canvas {
            width: 100%;
            height: 300px;
            margin-top: 20px;
        }
        
        .player-achievements-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin: 30px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .player-achievements-section h3 {
            font-size: 1.6em;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .achievements-list {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        @media (min-width: 768px) {
            .achievements-list {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        .achievement-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .achievement-icon {
            font-size: 2.5em;
            flex-shrink: 0;
        }
        
        .achievement-details {
            flex: 1;
        }
        
        .achievement-title {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 5px;
        }
        
        .achievement-description {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —ç–º–æ–¥–∑–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ */
        .player-cell-with-emojis {
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 0;
        }
        
        .player-emojis {
            display: flex;
            gap: 2px;
            font-size: 0.9em;
            line-height: 1;
            margin-left: 5px;
            opacity: 0.9;
        }
        
        .player-emoji {
            font-size: 0.9em;
            line-height: 1;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –±–ª–æ–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π */
        .achievements-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .achievements-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            gap: 10px;
        }
        
        .achievements-header h3 {
            font-size: 1.4em;
            margin: 0;
        }
        
        .achievements-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        @media (min-width: 768px) {
            .achievements-grid {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        .achievement-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease;
        }
        
        .achievement-card:hover {
            transform: translateY(-3px);
            background: rgba(255, 255, 255, 0.15);
        }
        
        .achievement-player {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }
        
        .achievement-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid white;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }
        
        .achievement-player-info {
            flex: 1;
        }
        
        .achievement-player-name {
            font-weight: bold;
            font-size: 1.1em;
            cursor: pointer;
            text-decoration: underline;
            text-decoration-color: rgba(255, 255, 255, 0.5);
        }
        
        .achievement-player-name:hover {
            text-decoration-color: white;
        }
        
        .achievement-player-rating {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .achievement-level {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 10px 0;
        }
        
        .level-icon {
            font-size: 1.8em;
        }
        
        .level-title {
            font-weight: bold;
            font-size: 1.1em;
        }
        
        .level-description {
            font-size: 0.9em;
            opacity: 0.9;
            margin-top: 8px;
            padding: 8px 0;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .achievement-congrats {
            background: rgba(76, 175, 80, 0.2);
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            border-left: 4px solid #4CAF50;
            font-style: italic;
        }
        
        .levels-info {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .levels-info h4 {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .levels-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .level-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        /* –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
        .bottom-panels {
            padding: 15px;
            background: #f8f9fa;
            border-top: 2px solid #e0e0e0;
            margin-top: 20px;
        }
        
        .supabase-panel {
            background: #e8f5e9;
            padding: 12px 15px;
            margin-bottom: 15px;
            border-radius: 10px;
            border-left: 5px solid #4CAF50;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .supabase-status {
            display: flex;
            flex-direction: column;
            gap: 5px;
            font-size: 0.9em;
        }
        
        .supabase-panel .action-btn {
            width: 100%;
            padding: 10px;
            font-size: 14px;
            height: 44px;
        }
        
        .status-connected { color: #2E7D32; font-weight: bold; }
        .status-error { color: #d32f2f; font-weight: bold; }
        .status-loading { color: #ff9800; font-weight: bold; }
        
        .admin-panel {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 10px;
            display: none;
        }
        
        .admin-active .admin-panel {
            display: block;
        }
        
        .login-panel {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .password-input {
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            width: 100%;
            margin-bottom: 10px;
            font-size: 16px;
            -webkit-appearance: none;
            height: 48px;
        }
        
        .login-btn, .logout-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            height: 48px;
        }
        
        .login-btn {
            background: #4CAF50;
            color: white;
        }
        
        .login-btn:active, .logout-btn:active {
            transform: translateY(1px);
        }
        
        .logout-btn {
            background: #f44336;
            color: white;
            margin-top: 10px;
        }
        
        .tabs {
            display: flex;
            background: #f5f5f5;
            border-bottom: 2px solid #ddd;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .tabs::-webkit-scrollbar {
            display: none;
        }
        
        .tab-btn {
            padding: 14px 16px;
            background: none;
            border: none;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s ease;
            position: relative;
            flex-shrink: 0;
            min-width: fit-content;
        }
        
        .tab-btn.active {
            background: white;
            color: #4CAF50;
            border-bottom: 3px solid #4CAF50;
        }
        
        .tab-content {
            display: none;
            padding: 15px 12px;
            animation: fadeIn 0.3s ease;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* –£–ª—É—á—à–µ–Ω–∏—è –¥–ª—è —Ç–∞–±–ª–∏—Ü */
        .table-container {
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            margin: 12px 0;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
            background: white;
        }
        
        th {
            background: #4CAF50;
            color: white;
            padding: 12px 8px;
            text-align: left;
            font-weight: 600;
            font-size: 13px;
            white-space: nowrap;
        }
        
        td {
            padding: 10px 8px;
            border-bottom: 1px solid #eee;
            font-size: 13px;
            vertical-align: middle;
            white-space: nowrap;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã —Ä–µ–π—Ç–∏–Ω–≥–∞ - –∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ */
        #ratingBody td {
            padding: 8px 6px;
        }
        
        #ratingBody .player-cell {
            min-width: 0;
            cursor: pointer;
        }
        
        #ratingBody .player-cell span {
            font-size: 13px;
            white-space: normal;
            word-break: break-word;
            line-height: 1.3;
            max-width: 120px;
        }
        
        .avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #4CAF50;
            flex-shrink: 0;
        }
        
        .player-cell {
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 0;
        }
        
        .player-cell span {
            font-size: 14px;
            white-space: normal;
            word-break: break-word;
            line-height: 1.3;
            flex: 1;
            min-width: 0;
        }
        
        .rating-badge {
            background: #4CAF50;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-weight: bold;
            font-size: 12px;
            display: inline-block;
        }
        
        .action-btn {
            padding: 6px 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
            min-height: 32px;
            white-space: nowrap;
        }
        
        .delete-btn {
            background: #f44336;
            color: white;
        }
        
        .penalty-btn {
            background: #ff9800;
            color: white;
        }
        
        .add-btn {
            background: #4CAF50;
            color: white;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–∞–Ω–µ–ª–µ–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ */
        .admin-controls-panel {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #4CAF50;
        }
        
        .admin-controls-panel h4 {
            color: #333;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 15px;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö –∞–¥–º–∏–Ω-–∫–æ–Ω—Ç—Ä–æ–ª–æ–≤ –≤ –∫–æ–Ω—Ç–µ–Ω—Ç–µ */
        .admin-controls {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #4CAF50;
        }
        
        .admin-controls h4 {
            color: #333;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 15px;
        }
        
        .form-group {
            margin-bottom: 12px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #555;
            font-size: 14px;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 15px;
            -webkit-appearance: none;
            height: 44px;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #4CAF50;
        }
        
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        .period-stats {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin: 15px 0;
        }
        
        .period-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
        }
        
        .period-box h3 {
            color: #333;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 2px solid #4CAF50;
            font-size: 15px;
        }
        
        .comparison-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        .player-comparison {
            background: white;
            border: 2px solid #4CAF50;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
        }
        
        .player-comparison img {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            margin-bottom: 12px;
            border: 3px solid #4CAF50;
        }
        
        .vs-badge {
            background: #333;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: bold;
            margin: 0 auto;
        }
        
        .year-progress {
            height: 160px;
            background: #f5f5f5;
            border-radius: 10px;
            padding: 12px;
            margin: 15px 0;
            display: flex;
            align-items: flex-end;
            gap: 6px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .progress-bar {
            flex: 1;
            min-width: 35px;
            background: linear-gradient(to top, #4CAF50, #8BC34A);
            border-radius: 8px 8px 0 0;
            position: relative;
            transition: height 0.5s ease;
        }
        
        .progress-label {
            position: absolute;
            bottom: -25px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 11px;
            font-weight: bold;
            white-space: nowrap;
        }
        
        .progress-count {
            position: absolute;
            top: -25px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–ª–µ–π –≤–≤–æ–¥–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞ */
        .rating-input {
            width: 70px !important;
            padding: 6px !important;
            font-size: 14px !important;
            height: 36px;
            text-align: center;
        }
        
        /* –ù–û–í–´–ï –°–¢–ò–õ–ò –î–õ–Ø –†–ê–ó–î–ï–õ–ï–ù–ò–Ø –ú–ê–¢–ß–ï–ô –ü–û –î–ù–Ø–ú –° –í–û–ó–ú–û–ñ–ù–û–°–¢–¨–Æ –°–í–û–†–ê–ß–ò–í–ê–ù–ò–Ø */
        .match-day-header {
            background-color: #1976d2;
            color: white;
            font-weight: bold;
            font-size: 14px;
            padding: 10px 12px;
            margin: 10px 0 0 0;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .match-day-header:hover {
            background-color: #1565c0;
            box-shadow: 0 3px 6px rgba(0,0,0,0.15);
        }
        
        .match-day-header.collapsed {
            background-color: #e0f2f1;
            color: #00796b;
            margin-bottom: 8px;
        }
        
        .match-day-header.collapsed:hover {
            background-color: #b2dfdb;
        }
        
        .match-day-header .day-info {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .match-day-header .day-date {
            font-weight: 600;
            font-size: 14px;
        }
        
        .match-day-header .match-count {
            background: rgba(255, 255, 255, 0.9);
            color: #1976d2;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .match-day-header.collapsed .match-count {
            background: #00796b;
            color: white;
        }
        
        .match-day-header .toggle-icon {
            font-size: 16px;
            transition: transform 0.3s ease;
        }
        
        .match-day-header.collapsed .toggle-icon {
            transform: rotate(-90deg);
        }
        
        .match-day-group {
            margin-bottom: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
            max-height: 1000px;
            opacity: 1;
        }
        
        .match-day-group.collapsed {
            max-height: 0;
            opacity: 0;
            margin-bottom: 0;
            border: none;
            overflow: hidden;
        }
        
        .match-day-group table {
            margin: 0;
            border-radius: 0;
            min-width: 600px;
        }
        
        .match-day-group table tr:first-child td {
            border-top: none;
        }
        
        .match-day-group table tr:last-child td {
            border-bottom: none;
        }
        
        /* –ú–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ */
        @media (min-width: 481px) {
            body {
                padding: 10px;
            }
            
            .container {
                border-radius: 15px;
            }
            
            header {
                padding: 20px 15px;
            }
            
            header h1 {
                font-size: 1.8em;
            }
            
            .supabase-panel {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
            
            .supabase-panel .action-btn {
                width: auto;
                min-width: 160px;
            }
            
            .grid-2 {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .period-stats {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .tabs {
                justify-content: center;
            }
            
            #ratingBody .player-cell span {
                max-width: 150px;
            }
        }
        
        @media (min-width: 769px) {
            .tab-content {
                padding: 20px 15px;
            }
            
            table {
                min-width: 800px;
            }
            
            th, td {
                padding: 12px 10px;
                font-size: 14px;
            }
            
            #ratingBody .player-cell span {
                max-width: 200px;
            }
            
            .player-cell span {
                font-size: 15px;
            }
            
            .avatar {
                width: 40px;
                height: 40px;
            }
            
            .bottom-panels {
                padding: 20px;
            }
        }
        
        @media (max-width: 480px) {
            /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
            body {
                padding: 5px;
            }
            
            .container {
                border-radius: 8px;
            }
            
            header {
                padding: 15px 10px;
            }
            
            header h1 {
                font-size: 1.4em;
            }
            
            .header-subtitle {
                font-size: 0.85em;
            }
            
            .tab-content {
                padding: 12px 10px;
            }
            
            .tab-btn {
                padding: 12px 14px;
                font-size: 13px;
            }
            
            th {
                padding: 10px 6px;
                font-size: 12px;
            }
            
            td {
                padding: 8px 6px;
                font-size: 12px;
            }
            
            .avatar {
                width: 32px;
                height: 32px;
            }
            
            #ratingBody .player-cell span {
                font-size: 12px;
                max-width: 100px;
            }
            
            .rating-input {
                width: 65px !important;
                padding: 5px !important;
                font-size: 13px !important;
                height: 34px;
            }
            
            .action-btn {
                padding: 5px 8px;
                font-size: 11px;
                min-height: 30px;
            }
            
            .password-input,
            .login-btn,
            .logout-btn {
                padding: 10px 15px;
                font-size: 15px;
                height: 44px;
            }
            
            .year-progress {
                height: 140px;
                padding: 10px;
            }
            
            .progress-bar {
                min-width: 30px;
            }
            
            .bottom-panels {
                padding: 12px;
            }
            
            .achievements-grid {
                grid-template-columns: 1fr;
            }
            
            /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –º–∞—Ç—á–µ–π –ø–æ –¥–Ω—è–º –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
            .match-day-header {
                padding: 8px 10px;
                font-size: 13px;
            }
            
            .match-day-header .day-date {
                font-size: 13px;
            }
            
            .match-day-header .match-count {
                font-size: 11px;
                padding: 1px 6px;
            }
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
        .mobile-optimized-table table {
            font-size: 12px;
        }
        
        .mobile-optimized-table th,
        .mobile-optimized-table td {
            padding: 6px 4px;
        }
        
        /* –£–ª—É—á—à–µ–Ω–∏—è –¥–ª—è iOS */
        @supports (-webkit-touch-callout: none) {
            input, select, textarea, button {
                font-size: 16px !important;
            }
            
            .tabs {
                -webkit-overflow-scrolling: touch;
            }
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏–π –∑–∞–≥—Ä—É–∑–∫–∏ */
        .loading {
            opacity: 0.7;
            pointer-events: none;
        }
        
        /* –•–æ–≤–µ—Ä-—ç—Ñ—Ñ–µ–∫—Ç—ã —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ */
        @media (hover: hover) and (pointer: fine) {
            .login-btn:hover {
                background: #45a049;
            }
            
            .action-btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            }
            
            tr:hover {
                background: #f9f9f9;
            }
        }
        
        /* –§–∏–∫—Å –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –∏–º–µ–Ω –≤ —Ç–∞–±–ª–∏—Ü–µ –∏–≥—Ä–æ–∫–æ–≤ */
        #playersBody .player-cell span {
            font-size: 13px;
            white-space: normal;
            word-break: break-word;
            line-height: 1.3;
            max-width: 150px;
        }
        
        /* –ö–æ–º–ø–∞–∫—Ç–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
        .compact-table td:nth-child(1) { width: 60px; }
        .compact-table td:nth-child(2) { min-width: 140px; }
        .compact-table td:nth-child(3) { width: 80px; }
        .compact-table td:nth-child(4) { width: 70px; }
        .compact-table td:nth-child(5) { width: 90px; }
        .compact-table td:nth-child(6) { width: 100px; }
        .compact-table td:nth-child(7) { width: 90px; }
        .compact-table td:nth-child(8) { width: 70px; }
        
        /* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è –æ—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã—Ö –∏–º–µ–Ω */
        .long-name {
            font-size: 11px !important;
            line-height: 1.2 !important;
        }
        
        /* –ù–û–í–´–ï –°–¢–ò–õ–ò –î–õ–Ø –¢–£–†–ù–ò–†–û–í */
        .tournament-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .tournament-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            border-color: #4CAF50;
        }
        
        .tournament-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .tournament-title {
            font-size: 1.4em;
            font-weight: bold;
            color: #333;
        }
        
        .tournament-date {
            color: #666;
            font-size: 0.9em;
            background: #f5f5f5;
            padding: 5px 10px;
            border-radius: 20px;
        }
        
        .tournament-winner {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .tournament-winner-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid gold;
        }
        
        .tournament-participants {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 15px;
        }
        
        .participant-badge {
            background: #e3f2fd;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.85em;
            border: 1px solid #bbdefb;
        }
        
        .tournament-photos {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }
        
        .tournament-photo {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .tournament-photo:hover {
            transform: scale(1.05);
        }
        
        .tournament-matches {
            margin-top: 20px;
            border-top: 2px solid #eee;
            padding-top: 15px;
        }
        
        .tournament-match {
            padding: 10px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .match-players {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .match-result {
            font-weight: bold;
            color: #4CAF50;
        }
        
        .tournament-page {
            padding: 20px;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .tournament-page-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .tournament-page-info {
            flex: 1;
        }
        
        .tournament-page-title {
            font-size: 2.5em;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        
        .tournament-winner-large {
            display: flex;
            align-items: center;
            gap: 20px;
            margin: 30px 0;
            padding: 20px;
            background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%);
            border-radius: 12px;
            border: 3px solid gold;
        }
        
        .winner-avatar-large {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 5px solid gold;
            object-fit: cover;
        }
        
        .winner-info {
            flex: 1;
        }
        
        .winner-name {
            font-size: 1.8em;
            font-weight: bold;
            color: #333;
        }
        
        .winner-trophy {
            font-size: 3em;
            margin-right: 20px;
        }
        
        .photo-upload-area {
            border: 3px dashed #4CAF50;
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            margin: 30px 0;
            background: #f9f9f9;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .photo-upload-area:hover {
            background: #f0f9f0;
            border-color: #45a049;
        }
        
        .photo-upload-icon {
            font-size: 3em;
            margin-bottom: 15px;
            color: #4CAF50;
        }
        
        .tournament-round {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }
        
        .round-title {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .create-tournament-btn {
            background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .create-tournament-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.3);
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
        }
        
        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 30px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-title {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            color: #666;
        }
        
        .participants-select {
            max-height: 200px;
            overflow-y: auto;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 20px;
        }
        
        .participant-checkbox {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px;
            border-radius: 5px;
            transition: background 0.3s ease;
        }
        
        .participant-checkbox:hover {
            background: #f5f5f5;
        }
        
        .tournament-bracket {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 20px;
            margin: 30px 0;
        }
        
        .bracket-round {
            flex: 1;
            min-width: 250px;
        }
        
        .bracket-match {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        
        .bracket-match:hover {
            border-color: #4CAF50;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .match-player {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px;
            border-radius: 5px;
            margin-bottom: 5px;
        }
        
        .match-player.winner {
            background: #e8f5e9;
            font-weight: bold;
        }
        
        .match-score-input {
            width: 50px;
            padding: 5px;
            text-align: center;
            border: 2px solid #ddd;
            border-radius: 5px;
            margin: 0 5px;
        }
        
        .save-match-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
            font-size: 0.9em;
        }
        
        .round-robin-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .round-robin-table th {
            background: #4CAF50;
            color: white;
            padding: 12px;
            text-align: left;
        }
        
        .round-robin-table td {
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .player-standing {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .standing-avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
        }
        
        .uploaded-photos {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .uploaded-photo {
            position: relative;
        }
        
        .delete-photo-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(244, 67, 54, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            cursor: pointer;
            display: none;
        }
        
        .uploaded-photo:hover .delete-photo-btn {
            display: block;
        }
        
        @media (max-width: 768px) {
            .tournament-page-header {
                flex-direction: column;
            }
            
            .tournament-winner-large {
                flex-direction: column;
                text-align: center;
            }
            
            .winner-avatar-large {
                width: 100px;
                height: 100px;
            }
            
            .tournament-bracket {
                flex-direction: column;
            }
            
            .bracket-round {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∏–≥—Ä–æ–∫–∞ -->
    <div class="container" id="playerProfileContainer" style="display: none;">
        <div class="player-profile-container">
            <div class="player-profile-header">
                <img id="playerProfileAvatar" src="" class="player-avatar-large" onerror="this.src='https://i.pravatar.cc/150?img=3'">
                <div class="player-info-large">
                    <h1 id="playerProfileName" class="player-name-large"></h1>
                    <div id="playerProfileRating" class="player-rating-large"></div>
                    <div id="playerProfileEmojis" class="achievement-emojis"></div>
                    <div id="playerProfileStats" class="player-profile-stats"></div>
                </div>
            </div>
            
            <div class="player-stats-grid">
                <div class="stat-period-box">
                    <h3>üìÖ –ó–∞ –Ω–µ–¥–µ–ª—é</h3>
                    <div id="playerWeekStats">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                </div>
                <div class="stat-period-box">
                    <h3>üìÖ –ó–∞ –º–µ—Å—è—Ü</h3>
                    <div id="playerMonthStats">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                </div>
                <div class="stat-period-box">
                    <h3>üìÖ –ó–∞ –≥–æ–¥</h3>
                    <div id="playerYearStats">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                </div>
                <div class="stat-period-box">
                    <h3>üìÖ –ó–∞ –≤—Å—ë –≤—Ä–µ–º—è</h3>
                    <div id="playerAllTimeStats">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                </div>
            </div>
            
            <div class="chart-container">
                <h3>üìà –ì—Ä–∞—Ñ–∏–∫ —Ñ–æ—Ä–º—ã (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –º–∞—Ç—á–µ–π)</h3>
                <canvas id="playerFormChart" class="chart-canvas"></canvas>
            </div>
            
            <div class="player-achievements-section">
                <h3>üèÜ –í—Å–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞</h3>
                <div id="playerAllAchievements" class="achievements-list">
                    <!-- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>
            
            <a href="#" class="back-button" onclick="returnToMain()">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ä–µ–π—Ç–∏–Ω–≥—É</a>
        </div>
    </div>
    
    <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç—É—Ä–Ω–∏—Ä–∞ -->
    <div class="container" id="tournamentContainer" style="display: none;">
        <div class="tournament-page">
            <div class="tournament-page-header">
                <div class="tournament-page-info">
                    <h1 id="tournamentName" class="tournament-page-title"></h1>
                    <div id="tournamentDate" class="tournament-date"></div>
                    <div id="tournamentStatus" class="tournament-status"></div>
                </div>
                <button class="back-button" onclick="returnToMainFromTournament()">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É</button>
            </div>
            
            <!-- –ü–æ–±–µ–¥–∏—Ç–µ–ª—å -->
            <div id="tournamentWinnerSection" class="tournament-winner-large" style="display: none;">
                <div class="winner-trophy">üèÜ</div>
                <img id="winnerAvatar" src="" class="winner-avatar-large" onerror="this.src='https://i.pravatar.cc/150?img=3'">
                <div class="winner-info">
                    <div class="winner-name" id="winnerName"></div>
                    <div id="winnerStats"></div>
                    <div id="finalScore"></div>
                </div>
            </div>
            
            <!-- –°–µ—Ç–∫–∞ —Ç—É—Ä–Ω–∏—Ä–∞ -->
            <div id="tournamentBracket"></div>
            
            <!-- –ö—Ä—É–≥–æ–≤–æ–π —Ç—É—Ä–Ω–∏—Ä -->
            <div id="roundRobinSection" style="display: none;">
                <h3 class="round-title">üîÅ –ö—Ä—É–≥–æ–≤–æ–π —ç—Ç–∞–ø</h3>
                <div id="roundRobinTable"></div>
            </div>
            
            <!-- –£—á–∞—Å—Ç–Ω–∏–∫–∏ -->
            <div class="tournament-round">
                <h3 class="round-title">üë• –£—á–∞—Å—Ç–Ω–∏–∫–∏ —Ç—É—Ä–Ω–∏—Ä–∞</h3>
                <div id="tournamentParticipants" class="tournament-participants"></div>
            </div>
            
            <!-- –ú–∞—Ç—á–∏ -->
            <div class="tournament-matches">
                <h3 class="round-title">üéÆ –í—Å–µ –º–∞—Ç—á–∏ —Ç—É—Ä–Ω–∏—Ä–∞</h3>
                <div id="tournamentMatchesList"></div>
            </div>
            
            <!-- –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ -->
            <div class="tournament-round" id="photoUploadSection">
                <h3 class="round-title">üì∏ –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —Å —Ç—É—Ä–Ω–∏—Ä–∞</h3>
                <div class="photo-upload-area" onclick="document.getElementById('photoUpload').click()" id="uploadArea">
                    <div class="photo-upload-icon">üì∑</div>
                    <div>–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π</div>
                    <div style="font-size: 0.9em; color: #666; margin-top: 10px;">
                        –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è JPG, PNG. –ú–∞–∫—Å. —Ä–∞–∑–º–µ—Ä: 5MB
                    </div>
                </div>
                <input type="file" id="photoUpload" accept="image/*" multiple style="display: none;" onchange="uploadTournamentPhotos(this.files)">
                
                <div id="uploadedPhotos" class="uploaded-photos"></div>
            </div>
            
            <!-- –ê–¥–º–∏–Ω-–∫–æ–Ω—Ç—Ä–æ–ª—ã -->
            <div id="tournamentAdminControls" class="admin-controls" style="display: none;">
                <h4>‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–æ–º</h4>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="action-btn add-btn" onclick="addTournamentMatch()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç—á</button>
                    <button class="action-btn penalty-btn" onclick="simulateTournament()">üéÆ –°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —Ç—É—Ä–Ω–∏—Ä</button>
                    <button class="action-btn" style="background: #9C27B0; color: white;" onclick="editTournament()">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                    <button class="action-btn delete-btn" onclick="deleteTournament()">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å —Ç—É—Ä–Ω–∏—Ä</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
    <div class="container" id="appContainer">
        <!-- –®–∞–ø–∫–∞ -->
        <header>
            <h1>üèì –†–µ–π—Ç–∏–Ω–≥ –õ–õ–ù–¢</h1>
            <div class="header-subtitle">–ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –õ–∏–≥–∏ –õ—é–±–∏—Ç–µ–ª–µ–π –ù–∞—Å—Ç–æ–ª—å–Ω–æ–≥–æ –¢–µ–Ω–Ω–∏—Å–∞</div>
        </header>
        
        <!-- –í–∫–ª–∞–¥–∫–∏ -->
        <div class="tabs">
            <button class="tab-btn active" onclick="openTab('rating')">üèÜ –†–µ–π—Ç–∏–Ω–≥</button>
            <button class="tab-btn" onclick="openTab('matches')">üéÆ –ú–∞—Ç—á–∏</button>
            <button class="tab-btn" onclick="openTab('players')">üë• –ò–≥—Ä–æ–∫–∏</button>
            <button class="tab-btn" onclick="openTab('stats')">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
            <button class="tab-btn" onclick="openTab('penalties')">‚ö†Ô∏è –®—Ç—Ä–∞—Ñ—ã</button>
            <button class="tab-btn" onclick="openTab('tournaments')">üèÖ –¢—É—Ä–Ω–∏—Ä—ã</button>
        </div>
        
        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–æ–∫ -->
        <div class="tab-content active" id="rating">
            <h2>üèÜ –¢–µ–∫—É—â–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∏–≥—Ä–æ–∫–æ–≤</h2>
            <div class="table-container">
                <table class="compact-table">
                    <thead>
                        <tr>
                            <th>–ú–µ—Å—Ç–æ</th>
                            <th>–ò–≥—Ä–æ–∫</th>
                            <th>–û—á–∫–∏</th>
                            <th>–ú–∞—Ç—á–∏</th>
                            <th>–ü–æ–±–µ–¥</th>
                            <th>–ü–æ—Å–ª–µ–¥–Ω—è—è –∏–≥—Ä–∞</th>
                            <th>–ù–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="ratingBody"></tbody>
                </table>
            </div>
            
            <!-- –ë–õ–û–ö –î–û–°–¢–ò–ñ–ï–ù–ò–ô –ò –ü–û–û–©–†–ï–ù–ò–ô -->
            <div class="achievements-container" id="achievementsContainer">
                <div class="achievements-header">
                    <div class="level-icon">üèÜ</div>
                    <h3>–°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π</h3>
                </div>
                
                <div id="achievementsContent">
                    <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫–æ–Ω—Ç–µ–Ω—Ç -->
                    <p>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –∏–≥—Ä–æ–∫–æ–≤...</p>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="matches">
            <h2>üéÆ –ò—Å—Ç–æ—Ä–∏—è –º–∞—Ç—á–µ–π</h2>
            <div id="matchesContainer">
                <!-- –ú–∞—Ç—á–∏ –±—É–¥—É—Ç —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –¥–Ω—è–º –∑–¥–µ—Å—å -->
            </div>
            
            <!-- –ë–ª–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–∞—Ç—á–∞ -->
            <div class="admin-controls" id="matchesAdminControls">
                <h4>‚öôÔ∏è –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –º–∞—Ç—á–∞ (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)</h4>
                <div class="grid-2">
                    <div>
                        <div class="form-group">
                            <label>–î–∞—Ç–∞ –º–∞—Ç—á–∞:</label>
                            <input type="date" id="matchDate">
                        </div>
                        <div class="form-group">
                            <label>–ò–≥—Ä–æ–∫ 1:</label>
                            <select id="player1"></select>
                        </div>
                        <div class="form-group">
                            <label>–ò–≥—Ä–æ–∫ 2:</label>
                            <select id="player2"></select>
                        </div>
                    </div>
                    <div>
                        <div class="form-group">
                            <label>–ü–æ–±–µ–¥–∏—Ç–µ–ª—å:</label>
                            <select id="winner">
                                <option value="player1">–ò–≥—Ä–æ–∫ 1</option>
                                <option value="player2">–ò–≥—Ä–æ–∫ 2</option>
                                <option value="draw">–ù–∏—á—å—è</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>–°—á–µ—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
                            <input type="text" id="score" placeholder="3:2">
                        </div>
                        <button class="add-btn action-btn" onclick="addMatch()" style="margin-top: 20px; width: 100%;">
                            ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ç—á
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="players">
            <h2>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞–º–∏</h2>
            <div class="admin-controls" id="playersAdminControls">
                <h4>‚öôÔ∏è –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞ (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)</h4>
                <div class="grid-2">
                    <div>
                        <div class="form-group">
                            <label>–ò–º—è –∏–≥—Ä–æ–∫–∞:</label>
                            <input type="text" id="newPlayerName" placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω">
                        </div>
                        <div class="form-group">
                            <label>–°—Å—ã–ª–∫–∞ –Ω–∞ –∞–≤–∞—Ç–∞—Ä (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
                            <input type="text" id="newPlayerAvatar" placeholder="https://example.com/avatar.jpg">
                        </div>
                        <div class="form-group">
                            <label>–ù–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥:</label>
                            <input type="number" id="newPlayerRating" value="1000">
                        </div>
                        <button class="add-btn action-btn" onclick="addPlayer()" style="width: 100%;">
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞
                        </button>
                    </div>
                    <div>
                        <p><strong>–°–æ–≤–µ—Ç—ã:</strong></p>
                        <ul style="list-style: none; padding: 0;">
                            <li>‚Ä¢ –î–ª—è –∞–≤–∞—Ç–∞—Ä–æ–≤ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å <a href="https://pravatar.cc" target="_blank">pravatar.cc</a></li>
                            <li>‚Ä¢ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥: 1000</li>
                            <li>‚Ä¢ –ò–º—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>–ê–≤–∞—Ç–∞—Ä</th>
                            <th>–ò–º—è</th>
                            <th>–†–µ–π—Ç–∏–Ω–≥</th>
                            <th>–ú–∞—Ç—á–∏</th>
                            <th>–ü–æ–±–µ–¥</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="playersBody"></tbody>
                </table>
            </div>
        </div>
        
        <div class="tab-content" id="stats">
            <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</h2>
            <div class="form-group" style="max-width: 400px;">
                <label>–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</label>
                <select id="statsPlayerSelect" onchange="updatePeriodStats()"></select>
            </div>
            
            <div class="period-stats">
                <div class="period-box">
                    <h3>üìÖ –ó–∞ –Ω–µ–¥–µ–ª—é</h3>
                    <div id="weekStats">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞</div>
                </div>
                <div class="period-box">
                    <h3>üìÖ –ó–∞ –º–µ—Å—è—Ü</h3>
                    <div id="monthStats">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞</div>
                </div>
                <div class="period-box">
                    <h3>üìÖ –ó–∞ –≥–æ–¥</h3>
                    <div id="yearStats">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞</div>
                </div>
                <div class="period-box">
                    <h3>üìÖ –ó–∞ –≤—Å—ë –≤—Ä–µ–º—è</h3>
                    <div id="allTimeStats">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞</div>
                </div>
            </div>
            
            <h3>üìà –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –º–µ—Å—è—Ü–∞–º</h3>
            <div class="year-progress" id="yearProgress"></div>
            
            <h3>üî• –¢–æ–ø-5 –∏–≥—Ä–æ–∫–æ–≤ –≥–æ–¥–∞</h3>
            <div id="topYearPlayers"></div>
            
            <h3>‚öñÔ∏è –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤</h3>
            <div class="comparison-container">
                <div>
                    <div class="form-group">
                        <label>–ò–≥—Ä–æ–∫ 1:</label>
                        <select id="comparePlayer1"></select>
                    </div>
                    <div class="form-group">
                        <label>–ò–≥—Ä–æ–∫ 2:</label>
                        <select id="comparePlayer2"></select>
                    </div>
                    <button class="add-btn action-btn" onclick="comparePlayers()" style="width: 100%;">
                        üîç –°—Ä–∞–≤–Ω–∏—Ç—å –∏–≥—Ä–æ–∫–æ–≤
                    </button>
                </div>
                <div id="comparisonResult" style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <p>–í—ã–±–µ—Ä–∏—Ç–µ –¥–≤—É—Ö –∏–≥—Ä–æ–∫–æ–≤ –∏ –Ω–∞–∂–º–∏—Ç–µ "–°—Ä–∞–≤–Ω–∏—Ç—å"</p>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="penalties">
            <h2>‚ö†Ô∏è –°–∏—Å—Ç–µ–º–∞ —à—Ç—Ä–∞—Ñ–æ–≤ –∑–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h2>
            <div class="admin-controls" id="penaltiesAdminControls">
                <h4>‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —à—Ç—Ä–∞—Ñ–æ–≤ (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)</h4>
                <button class="penalty-btn action-btn" onclick="checkAndApplyPenalties()">
                    üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∞–≤—Ç–æ-—à—Ç—Ä–∞—Ñ—ã
                </button>
                <p><small>–®—Ç—Ä–∞—Ñ: -60 –æ—á–∫–æ–≤ –∑–∞ –∫–∞–∂–¥—ã–µ 14+ –¥–Ω–µ–π –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</small></p>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>–î–∞—Ç–∞</th>
                            <th>–ò–≥—Ä–æ–∫</th>
                            <th>–®—Ç—Ä–∞—Ñ</th>
                            <th>–î–Ω–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</th>
                            <th>–¢–∏–ø</th>
                        </tr>
                    </thead>
                    <tbody id="penaltiesHistoryBody"></tbody>
                </table>
            </div>
        </div>
        
        <!-- –ù–û–í–ê–Ø –í–ö–õ–ê–î–ö–ê –¢–£–†–ù–ò–†–û–í -->
        <div class="tab-content" id="tournaments">
            <h2>üèÖ –¢—É—Ä–Ω–∏—Ä—ã –∏ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è</h2>
            
            <div id="tournamentsAdminControls" class="admin-controls" style="display: none;">
                <h4>‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞–º–∏ (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)</h4>
                <button class="create-tournament-btn" onclick="showCreateTournamentModal()">
                    ‚ûï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç—É—Ä–Ω–∏—Ä
                </button>
                <p><small>–°–æ–∑–¥–∞–≤–∞–π—Ç–µ —Ç—É—Ä–Ω–∏—Ä—ã —Å –∫—Ä—É–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π –∏–ª–∏ –ø–ª–µ–π-–æ—Ñ—Ñ</small></p>
            </div>
            
            <div id="tournamentsList">
                <p style="text-align: center; padding: 40px;">–ó–∞–≥—Ä—É–∑–∫–∞ —Ç—É—Ä–Ω–∏—Ä–æ–≤...</p>
            </div>
            
            <div id="noTournaments" style="display: none; text-align: center; padding: 40px;">
                <h3 style="font-size: 16px; margin-bottom: 10px;">üéæ –¢—É—Ä–Ω–∏—Ä–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</h3>
                <p style="font-size: 14px;">–í–æ–π–¥–∏—Ç–µ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∏ —Å–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π —Ç—É—Ä–Ω–∏—Ä</p>
            </div>
        </div>
        
        <!-- –ü–∞–Ω–µ–ª–∏ –≤–Ω–∏–∑—É —Å–∞–π—Ç–∞ -->
        <div class="bottom-panels">
            <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–π—Ç–∏–Ω–≥–æ–º (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä) -->
            <div class="admin-controls-panel" id="ratingAdminControls">
                <h4>‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–º (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)</h4>
                <button class="penalty-btn action-btn" onclick="checkAndApplyPenalties()">
                    ‚ö†Ô∏è –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∞–≤—Ç–æ-—à—Ç—Ä–∞—Ñ—ã (14+ –¥–Ω–µ–π = -60)
                </button>
                <button class="add-btn action-btn" onclick="saveManualRatings()">
                    üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—á–∫–æ–≤
                </button>
                <p><small>–ò–∑–º–µ–Ω–∏—Ç–µ –æ—á–∫–∏ –≤ –ø–æ–ª—è—Ö –≤–≤–æ–¥–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ —Ä–µ–π—Ç–∏–Ω–≥–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—á–∫–æ–≤"</small></p>
            </div>
            
            <!-- –ü–∞–Ω–µ–ª—å Supabase -->
            <div class="supabase-panel">
                <div class="supabase-status">
                    <strong>‚òÅÔ∏è Supabase Cloud Sync</strong>
                    <div>–°—Ç–∞—Ç—É—Å: <span id="supabaseStatus" class="status-loading">‚è≥ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</span></div>
                    <div>–û–±–Ω–æ–≤–ª–µ–Ω–æ: <span id="supabaseTime">--:--:--</span></div>
                </div>
                <button class="action-btn add-btn" onclick="loadAllData()" id="refreshBtn">
                    üîÑ –û–±–Ω–æ–≤–∏—Ç—å
                </button>
            </div>
            
            <!-- –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ -->
            <div class="admin-panel" id="adminPanel">
                <h3>‚öôÔ∏è –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h3>
                <p>–í—ã –≤–æ—à–ª–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä. –î–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.</p>
                <button class="logout-btn" onclick="logoutAdmin()">üö™ –í—ã–π—Ç–∏ –∏–∑ –∞–¥–º–∏–Ω-—Ä–µ–∂–∏–º–∞</button>
            </div>
            
            <!-- –ü–∞–Ω–µ–ª—å –≤—Ö–æ–¥–∞ -->
            <div class="login-panel" id="loginPanel">
                <h3>üîê –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π</h3>
                <p>–î–ª—è –≤–Ω–µ—Å–µ–Ω–∏—è –º–∞—Ç—á–µ–π –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤–æ–π–¥–∏—Ç–µ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:</p>
                <input type="password" id="adminPassword" class="password-input" placeholder="–ü–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞">
                <button class="login-btn" onclick="loginAdmin()">–í–æ–π—Ç–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</button>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–∞ -->
    <div class="modal-overlay" id="createTournamentModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">üèÖ –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç—É—Ä–Ω–∏—Ä–∞</div>
                <button class="close-modal" onclick="closeCreateTournamentModal()">√ó</button>
            </div>
            
            <div class="form-group">
                <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞:</label>
                <input type="text" id="tournamentNameInput" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ö—É–±–æ–∫ –í–µ—Å–Ω—ã 2024">
            </div>
            
            <div class="form-group">
                <label>–î–∞—Ç–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è:</label>
                <input type="date" id="tournamentDateInput">
            </div>
            
            <div class="form-group">
                <label>–¢–∏–ø —Ç—É—Ä–Ω–∏—Ä–∞:</label>
                <select id="tournamentType">
                    <option value="round-robin">–ö—Ä—É–≥–æ–≤–æ–π (–∫–∞–∂–¥—ã–π —Å –∫–∞–∂–¥—ã–º)</option>
                    <option value="knockout">–ü–ª–µ–π-–æ—Ñ—Ñ (–≤—ã–±—ã–≤–∞–Ω–∏–µ)</option>
                    <option value="mixed">–°–º–µ—à–∞–Ω–Ω—ã–π (–≥—Ä—É–ø–ø—ã + –ø–ª–µ–π-–æ—Ñ—Ñ)</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤ —Ñ–∏–Ω–∞–ª–µ:</label>
                <select id="finalParticipants">
                    <option value="2">2 (—Ñ–∏–Ω–∞–ª)</option>
                    <option value="4">4 (–ø–æ–ª—É—Ñ–∏–Ω–∞–ª—ã)</option>
                    <option value="8">8 (—á–µ—Ç–≤–µ—Ä—Ç—å—Ñ–∏–Ω–∞–ª—ã)</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>–£—á–∞—Å—Ç–Ω–∏–∫–∏:</label>
                <div class="participants-select" id="tournamentParticipantsSelect">
                    <!-- –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
                <div style="margin-top: 10px;">
                    <button class="action-btn" onclick="selectAllPlayers()" style="background: #2196F3; margin-right: 10px;">–í—ã–±—Ä–∞—Ç—å –≤—Å–µ—Ö</button>
                    <button class="action-btn" onclick="deselectAllPlayers()" style="background: #9E9E9E;">–°–Ω—è—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ</button>
                </div>
            </div>
            
            <div class="form-group">
                <label>–§–æ—Ä–º–∞—Ç –º–∞—Ç—á–µ–π:</label>
                <select id="matchFormat">
                    <option value="bo3">–î–æ 2 –ø–æ–±–µ–¥ (best of 3)</option>
                    <option value="bo5">–î–æ 3 –ø–æ–±–µ–¥ (best of 5)</option>
                    <option value="single">–û–¥–Ω–∞ –ø–∞—Ä—Ç–∏—è</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>–û–ø–∏—Å–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
                <textarea id="tournamentDescription" rows="3" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç—É—Ä–Ω–∏—Ä–µ..."></textarea>
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="action-btn add-btn" style="flex: 1;" onclick="createTournament()">‚úÖ –°–æ–∑–¥–∞—Ç—å —Ç—É—Ä–Ω–∏—Ä</button>
                <button class="action-btn" style="flex: 1; background: #9E9E9E;" onclick="closeCreateTournamentModal()">‚ùå –û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <script>
    // ============================================
    // –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø SUPABASE
    // ============================================
    const SUPABASE_URL = 'https://bqycjfcjtdawyrysgrbw.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJxeWNqZmNqdGRhd3lyeXNncmJ3Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2NjYwMTk3MCwiZXhwIjoyMDgyMTc3OTcwfQ.lHA_79fw8PSj9ZHMExBpSEIpkonkCYOni7HniGGqadY';
    
    let supabaseClient = null;
    let isSupabaseInitialized = false;
    
    // ============================================
    // –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï
    // ============================================
    let players = {};
    let matches = [];
    let penaltyLog = [];
    let tournaments = [];
    let currentTournament = null;
    let isAdmin = false;
    const ADMIN_PASSWORD = "admin123";
    
    // ============================================
    // –§–£–ù–ö–¶–ò–ò –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–ê (–ü–†–û–ü–£–©–ï–ù–ù–´–ï)
    // ============================================
    
    function checkAutoLogin() {
        const saved = localStorage.getItem('tennisAdmin');
        if (saved === 'true') {
            isAdmin = true;
            document.getElementById('appContainer').classList.add('admin-active');
            document.getElementById('loginPanel').style.display = 'none';
            document.getElementById('ratingAdminControls').style.display = 'block';
            document.getElementById('matchesAdminControls').style.display = 'block';
            document.getElementById('penaltiesAdminControls').style.display = 'block';
            document.getElementById('playersAdminControls').style.display = 'block';
            document.getElementById('tournamentsAdminControls').style.display = 'block';
        }
    }
    
    function loginAdmin() {
        const password = document.getElementById('adminPassword').value;
        if (password === ADMIN_PASSWORD) {
            isAdmin = true;
            document.getElementById('appContainer').classList.add('admin-active');
            document.getElementById('loginPanel').style.display = 'none';
            document.getElementById('adminPassword').value = '';
            
            document.getElementById('ratingAdminControls').style.display = 'block';
            document.getElementById('matchesAdminControls').style.display = 'block';
            document.getElementById('penaltiesAdminControls').style.display = 'block';
            document.getElementById('playersAdminControls').style.display = 'block';
            document.getElementById('tournamentsAdminControls').style.display = 'block';
            
            localStorage.setItem('tennisAdmin', 'true');
            
            updateAllDisplays();
            showNotification('‚úÖ –í—ã –≤–æ—à–ª–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä!', 'success');
        } else {
            showNotification('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!', 'error');
        }
    }
    
    function logoutAdmin() {
        isAdmin = false;
        document.getElementById('appContainer').classList.remove('admin-active');
        document.getElementById('loginPanel').style.display = 'block';
        
        document.getElementById('ratingAdminControls').style.display = 'none';
        document.getElementById('matchesAdminControls').style.display = 'none';
        document.getElementById('penaltiesAdminControls').style.display = 'none';
        document.getElementById('playersAdminControls').style.display = 'none';
        document.getElementById('tournamentsAdminControls').style.display = 'none';
        
        localStorage.removeItem('tennisAdmin');
        
        updateAllDisplays();
        showNotification('üëã –í—ã –≤—ã—à–ª–∏ –∏–∑ —Ä–µ–∂–∏–º–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞', 'info');
    }
    
    // ============================================
    // –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò
    // ============================================
    
    async function initSupabase() {
        console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Supabase –∫–ª–∏–µ–Ω—Ç–∞...');
        updateSupabaseStatus('üîÑ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...');
        
        try {
            if (!window.supabase) {
                console.log('üì¶ –ó–∞–≥—Ä—É–∂–∞—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É Supabase...');
                await loadSupabaseLibrary();
            }
            
            if (!window.supabase || !window.supabase.createClient) {
                throw new Error('–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ Supabase –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            }
            
            supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
            isSupabaseInitialized = true;
            
            console.log('‚úÖ Supabase –∫–ª–∏–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω');
            updateSupabaseStatus('‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ');
            
            await loadAllData();
            
            setInterval(loadAllData, 30000);
            
            return supabaseClient;
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Supabase:', error);
            updateSupabaseStatus('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è');
            return null;
        }
    }
    
    async function loadSupabaseLibrary() {
        return new Promise((resolve, reject) => {
            if (window.supabase) {
                console.log('‚úÖ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ Supabase —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
                resolve();
                return;
            }
            
            const script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js';
            script.async = true;
            
            script.onload = () => {
                console.log('‚úÖ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ Supabase –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
                resolve();
            };
            
            script.onerror = (error) => {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Supabase:', error);
                updateSupabaseStatus('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏');
                reject(error);
            };
            
            document.head.appendChild(script);
        });
    }
    
    // ============================================
    // –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–•
    // ============================================
    
    async function loadAllData() {
        if (!supabaseClient) {
            console.log('üîÑ Supabase –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω, –ø—Ä–æ–±—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å...');
            await initSupabase();
            return;
        }
        
        try {
            console.log('üîÑ –ó–∞–≥—Ä—É–∂–∞—é –¥–∞–Ω–Ω—ã–µ –∏–∑ Supabase...');
            updateSupabaseStatus('üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è...');
            document.getElementById('refreshBtn').disabled = true;
            document.getElementById('refreshBtn').classList.add('loading');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–≥—Ä–æ–∫–æ–≤
            const { data: playersData, error: playersError } = await supabaseClient
                .from('players')
                .select('*')
                .order('rating', { ascending: false });
            
            if (playersError) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä–æ–∫–æ–≤:', playersError);
            } else if (playersData) {
                const newPlayers = {};
                playersData.forEach(player => {
                    newPlayers[player.name] = {
                        id: player.id,
                        rating: player.rating || 1000,
                        matches: player.matches || 0,
                        wins: player.wins || 0,
                        lastGame: player.last_game ? new Date(player.last_game) : null,
                        joinDate: player.join_date ? new Date(player.join_date) : new Date(),
                        penalties: player.penalties || 0,
                        avatar: player.avatar || `https://i.pravatar.cc/150?img=${Math.floor(Math.random() * 70) + 1}`,
                        achievement_bonuses: player.achievement_bonuses || {},
                        created_at: player.created_at
                    };
                });
                players = newPlayers;
                console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${playersData.length} –∏–≥—Ä–æ–∫–æ–≤`);
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –º–∞—Ç—á–∏
            const { data: matchesData, error: matchesError } = await supabaseClient
                .from('matches')
                .select('*')
                .order('date', { ascending: false });
            
            if (matchesError) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–∞—Ç—á–µ–π:', matchesError);
            } else if (matchesData) {
                matches = matchesData.map(match => ({
                    id: match.id,
                    date: new Date(match.date),
                    player1: match.player1,
                    player2: match.player2,
                    winner: match.winner,
                    change1: match.change1 || 0,
                    change2: match.change2 || 0,
                    score: match.score || ''
                }));
                console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${matchesData.length} –º–∞—Ç—á–µ–π`);
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —à—Ç—Ä–∞—Ñ—ã
            const { data: penaltiesData, error: penaltiesError } = await supabaseClient
                .from('penalties')
                .select('*')
                .order('date', { ascending: false });
            
            if (penaltiesError) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —à—Ç—Ä–∞—Ñ–æ–≤:', penaltiesError);
            } else if (penaltiesData) {
                penaltyLog = penaltiesData.map(penalty => ({
                    id: penalty.id,
                    date: new Date(penalty.date),
                    player: penalty.player,
                    amount: penalty.amount || 0,
                    daysInactive: penalty.days_inactive || 0,
                    manual: penalty.manual || false
                }));
                console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${penaltiesData.length} —à—Ç—Ä–∞—Ñ–æ–≤`);
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç—É—Ä–Ω–∏—Ä—ã
            const { data: tournamentsData, error: tournamentsError } = await supabaseClient
                .from('tournaments')
                .select('*')
                .order('date', { ascending: false });
            
            if (tournamentsError) {
                console.log('‚ö†Ô∏è –¢—É—Ä–Ω–∏—Ä—ã –µ—â–µ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã:', tournamentsError);
            } else if (tournamentsData) {
                tournaments = tournamentsData;
                console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${tournamentsData.length} —Ç—É—Ä–Ω–∏—Ä–æ–≤`);
            }
            
            console.log('‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ Supabase');
            updateSupabaseStatus('‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ');
            updateSupabaseTime();
            
            updateAllDisplays();
            
        } catch (error) {
            console.error('‚ùå –û–±—â–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
            updateSupabaseStatus('‚ùå –û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏');
        } finally {
            document.getElementById('refreshBtn').disabled = false;
            document.getElementById('refreshBtn').classList.remove('loading');
        }
    }
    
    // ============================================
    // –§–£–ù–ö–¶–ò–ò –î–õ–Ø –¢–£–†–ù–ò–†–û–í
    // ============================================
    
    function updateTournamentsDisplay() {
        const container = document.getElementById('tournamentsList');
        const noTournaments = document.getElementById('noTournaments');
        
        if (!container) return;
        
        if (tournaments.length === 0) {
            container.style.display = 'none';
            noTournaments.style.display = 'block';
            return;
        }
        
        container.style.display = 'block';
        noTournaments.style.display = 'none';
        
        container.innerHTML = tournaments.map(tournament => `
            <div class="tournament-card" onclick="showTournament('${tournament.id}')">
                <div class="tournament-header">
                    <div class="tournament-title">${tournament.name}</div>
                    <div class="tournament-date">
                        ${new Date(tournament.date).toLocaleDateString('ru-RU')}
                    </div>
                </div>
                
                <div style="color: #666; margin-bottom: 10px;">
                    ${tournament.description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'}
                </div>
                
                ${tournament.winner ? `
                    <div class="tournament-winner">
                        <img src="${players[tournament.winner]?.avatar || 'https://i.pravatar.cc/150?img=3'}" 
                             class="tournament-winner-avatar">
                        <div>
                            <div style="font-weight: bold;">üèÜ –ü–æ–±–µ–¥–∏—Ç–µ–ª—å: ${tournament.winner}</div>
                            <div style="font-size: 0.85em;">–†–µ–π—Ç–∏–Ω–≥: ${players[tournament.winner]?.rating || '0'} –æ—á–∫–æ–≤</div>
                        </div>
                    </div>
                ` : `
                    <div style="color: #FF9800; font-weight: bold;">
                        ${tournament.status === 'ongoing' ? 'üéÆ –í –ø—Ä–æ—Ü–µ—Å—Å–µ' : 'üìÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω'}
                    </div>
                `}
                
                <div class="tournament-participants">
                    ${tournament.participants ? tournament.participants.slice(0, 5).map(player => `
                        <div class="participant-badge">${player}</div>
                    `).join('') : ''}
                    ${tournament.participants && tournament.participants.length > 5 ? 
                        `<div class="participant-badge">+${tournament.participants.length - 5}</div>` : ''}
                </div>
                
                <div style="margin-top: 15px; font-size: 0.85em; color: #666;">
                    –£—á–∞—Å—Ç–Ω–∏–∫–æ–≤: ${tournament.participants?.length || 0} ‚Ä¢ 
                    –¢–∏–ø: ${getTournamentTypeName(tournament.type)}
                </div>
            </div>
        `).join('');
        
        document.getElementById('tournamentsAdminControls').style.display = isAdmin ? 'block' : 'none';
    }
    
    function getTournamentTypeName(type) {
        const types = {
            'round-robin': '–ö—Ä—É–≥–æ–≤–æ–π',
            'knockout': '–ü–ª–µ–π-–æ—Ñ—Ñ',
            'mixed': '–°–º–µ—à–∞–Ω–Ω—ã–π'
        };
        return types[type] || type;
    }
    
    // ============================================
    // –°–û–ó–î–ê–ù–ò–ï –¢–£–†–ù–ò–†–ê
    // ============================================
    
    function showCreateTournamentModal() {
        if (!isAdmin) {
            showNotification('‚ùå –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç—É—Ä–Ω–∏—Ä—ã!', 'error');
            return;
        }
        
        const modal = document.getElementById('createTournamentModal');
        modal.style.display = 'flex';
        
        document.getElementById('tournamentDateInput').value = new Date().toISOString().split('T')[0];
        
        const participantsContainer = document.getElementById('tournamentParticipantsSelect');
        participantsContainer.innerHTML = '';
        
        Object.keys(players).forEach(playerName => {
            const div = document.createElement('div');
            div.className = 'participant-checkbox';
            div.innerHTML = `
                <input type="checkbox" id="player_${playerName}" value="${playerName}">
                <label for="player_${playerName}">${playerName}</label>
            `;
            participantsContainer.appendChild(div);
        });
    }
    
    function closeCreateTournamentModal() {
        document.getElementById('createTournamentModal').style.display = 'none';
    }
    
    function selectAllPlayers() {
        document.querySelectorAll('#tournamentParticipantsSelect input[type="checkbox"]').forEach(checkbox => {
            checkbox.checked = true;
        });
    }
    
    function deselectAllPlayers() {
        document.querySelectorAll('#tournamentParticipantsSelect input[type="checkbox"]').forEach(checkbox => {
            checkbox.checked = false;
        });
    }
    
    async function createTournament() {
        if (!isAdmin) return;
        
        const name = document.getElementById('tournamentNameInput').value.trim();
        const date = document.getElementById('tournamentDateInput').value;
        const type = document.getElementById('tournamentType').value;
        const description = document.getElementById('tournamentDescription').value.trim();
        
        if (!name) {
            showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞!', 'error');
            return;
        }
        
        if (!date) {
            showNotification('–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É —Ç—É—Ä–Ω–∏—Ä–∞!', 'error');
            return;
        }
        
        const selectedPlayers = [];
        document.querySelectorAll('#tournamentParticipantsSelect input[type="checkbox"]:checked').forEach(checkbox => {
            selectedPlayers.push(checkbox.value);
        });
        
        if (selectedPlayers.length < 2) {
            showNotification('–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã 2 —É—á–∞—Å—Ç–Ω–∏–∫–∞!', 'error');
            return;
        }
        
        try {
            const { data: tournament, error } = await supabaseClient
                .from('tournaments')
                .insert({
                    name,
                    date,
                    type,
                    status: 'planned',
                    participants: selectedPlayers,
                    description,
                    created_at: new Date().toISOString()
                })
                .select()
                .single();
            
            if (error) throw error;
            
            // –î–ª—è –∫—Ä—É–≥–æ–≤–æ–≥–æ —Ç—É—Ä–Ω–∏—Ä–∞ –∏–∑ 3 –∏–≥—Ä–æ–∫–æ–≤ —Å–æ–∑–¥–∞–µ–º –º–∞—Ç—á–∏
            if (type === 'round-robin' && selectedPlayers.length === 3) {
                const matchesToCreate = [];
                for (let i = 0; i < selectedPlayers.length; i++) {
                    for (let j = i + 1; j < selectedPlayers.length; j++) {
                        matchesToCreate.push({
                            tournament_id: tournament.id,
                            player1: selectedPlayers[i],
                            player2: selectedPlayers[j],
                            round: 'group',
                            status: 'scheduled',
                            date: new Date().toISOString()
                        });
                    }
                }
                
                await supabaseClient
                    .from('tournament_matches')
                    .insert(matchesToCreate);
            }
            
            await loadAllData();
            closeCreateTournamentModal();
            
            showNotification(`‚úÖ –¢—É—Ä–Ω–∏—Ä "${name}" —Å–æ–∑–¥–∞–Ω!`, 'success');
            
            setTimeout(() => showTournament(tournament.id), 500);
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–∞:', error);
            showNotification('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–∞', 'error');
        }
    }
    
    // ============================================
    // –ü–û–ö–ê–ó –¢–£–†–ù–ò–†–ê
    // ============================================
    
    async function showTournament(tournamentId) {
        const tournament = tournaments.find(t => t.id === tournamentId);
        if (!tournament) {
            showNotification('–¢—É—Ä–Ω–∏—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
            return;
        }
        
        currentTournament = tournament;
        
        document.getElementById('appContainer').style.display = 'none';
        document.getElementById('tournamentContainer').style.display = 'block';
        
        document.getElementById('tournamentName').textContent = tournament.name;
        document.getElementById('tournamentDate').textContent = 
            `–î–∞—Ç–∞: ${new Date(tournament.date).toLocaleDateString('ru-RU')}`;
        
        const statusElement = document.getElementById('tournamentStatus');
        if (tournament.status === 'completed') {
            statusElement.innerHTML = '<span style="color: #4CAF50; font-weight: bold;">‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω</span>';
        } else if (tournament.status === 'ongoing') {
            statusElement.innerHTML = '<span style="color: #FF9800; font-weight: bold;">üéÆ –í –ø—Ä–æ—Ü–µ—Å—Å–µ</span>';
        } else {
            statusElement.innerHTML = '<span style="color: #2196F3; font-weight: bold;">üìÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω</span>';
        }
        
        await loadTournamentDetails(tournamentId);
        window.scrollTo(0, 0);
    }
    
    async function loadTournamentDetails(tournamentId) {
        try {
            const { data: matchesData } = await supabaseClient
                .from('tournament_matches')
                .select('*')
                .eq('tournament_id', tournamentId)
                .order('round')
                .order('date');
            
            const { data: photosData } = await supabaseClient
                .from('tournament_photos')
                .select('*')
                .eq('tournament_id', tournamentId)
                .order('uploaded_at', { ascending: false });
            
            updateTournamentPage(matchesData || [], photosData || []);
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–µ—Ç–∞–ª–µ–π —Ç—É—Ä–Ω–∏—Ä–∞:', error);
        }
    }
    
    function updateTournamentPage(matches, photos) {
        // –£—á–∞—Å—Ç–Ω–∏–∫–∏
        const participantsContainer = document.getElementById('tournamentParticipants');
        if (currentTournament.participants && Array.isArray(currentTournament.participants)) {
            participantsContainer.innerHTML = currentTournament.participants.map(player => `
                <div class="participant-badge">${player}</div>
            `).join('');
        }
        
        // –ü–æ–±–µ–¥–∏—Ç–µ–ª—å
        if (currentTournament.winner) {
            document.getElementById('tournamentWinnerSection').style.display = 'flex';
            document.getElementById('winnerName').textContent = currentTournament.winner;
            
            const winnerAvatar = players[currentTournament.winner]?.avatar || 'https://i.pravatar.cc/150?img=3';
            document.getElementById('winnerAvatar').src = winnerAvatar;
            
            const winnerStats = players[currentTournament.winner];
            if (winnerStats) {
                document.getElementById('winnerStats').innerHTML = `
                    <div>–†–µ–π—Ç–∏–Ω–≥: ${winnerStats.rating} –æ—á–∫–æ–≤</div>
                    <div>–ü–æ–±–µ–¥: ${winnerStats.wins} –∏–∑ ${winnerStats.matches}</div>
                `;
            }
        }
        
        // –ú–∞—Ç—á–∏
        const matchesContainer = document.getElementById('tournamentMatchesList');
        if (matches.length > 0) {
            matchesContainer.innerHTML = matches.map(match => `
                <div class="tournament-match">
                    <div class="match-players">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <img src="${players[match.player1]?.avatar || 'https://i.pravatar.cc/150?img=3'}" 
                                 style="width: 30px; height: 30px; border-radius: 50%;">
                            <span>${match.player1}</span>
                        </div>
                        <div class="match-result">${match.score || (match.winner === match.player1 ? '–ü–æ–±–µ–¥–∞' : match.winner === match.player2 ? '–ü–æ—Ä–∞–∂–µ–Ω–∏–µ' : '–ù–∏—á—å—è')}</div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span>${match.player2}</span>
                            <img src="${players[match.player2]?.avatar || 'https://i.pravatar.cc/150?img=3'}" 
                                 style="width: 30px; height: 30px; border-radius: 50%;">
                        </div>
                    </div>
                    <div style="font-size: 0.85em; color: #666; margin-top: 5px;">
                        ${match.round} ‚Ä¢ ${new Date(match.date).toLocaleDateString('ru-RU')}
                    </div>
                </div>
            `).join('');
        } else {
            matchesContainer.innerHTML = '<p style="text-align: center; padding: 20px;">–ú–∞—Ç—á–∏ –µ—â–µ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã</p>';
        }
        
        // –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
        const photosContainer = document.getElementById('uploadedPhotos');
        if (photos.length > 0) {
            photosContainer.innerHTML = photos.map(photo => `
                <div class="uploaded-photo">
                    <img src="${photo.url}" class="tournament-photo" onclick="openPhotoModal('${photo.url}')">
                    ${isAdmin ? `<button class="delete-photo-btn" onclick="deleteTournamentPhoto('${photo.id}')">√ó</button>` : ''}
                </div>
            `).join('');
        } else {
            photosContainer.innerHTML = '<p style="text-align: center; color: #666;">–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –ø–æ–∫–∞ –Ω–µ—Ç</p>';
        }
        
        // –°–µ—Ç–∫–∞ —Ç—É—Ä–Ω–∏—Ä–∞
        updateTournamentBracket(matches);
        
        // –ê–¥–º–∏–Ω-–∫–æ–Ω—Ç—Ä–æ–ª—ã
        document.getElementById('tournamentAdminControls').style.display = isAdmin ? 'block' : 'none';
    }
    
    function updateTournamentBracket(matches) {
        const bracketContainer = document.getElementById('tournamentBracket');
        
        if (currentTournament.type === 'round-robin' && currentTournament.participants.length === 3) {
            document.getElementById('roundRobinSection').style.display = 'block';
            
            const participants = currentTournament.participants;
            let standings = [];
            
            participants.forEach(player => {
                const playerMatches = matches.filter(m => 
                    m.player1 === player || m.player2 === player
                );
                
                const wins = playerMatches.filter(m => m.winner === player).length;
                const losses = playerMatches.filter(m => 
                    m.winner && m.winner !== player && m.winner !== 'draw'
                ).length;
                const draws = playerMatches.filter(m => m.winner === 'draw').length;
                
                let pointsDiff = 0;
                playerMatches.forEach(match => {
                    if (match.score) {
                        const [score1, score2] = match.score.split(':').map(Number);
                        if (match.player1 === player) {
                            pointsDiff += (score1 - score2);
                        } else {
                            pointsDiff += (score2 - score1);
                        }
                    }
                });
                
                standings.push({
                    player,
                    matches: playerMatches.length,
                    wins,
                    losses,
                    draws,
                    points: wins * 2 + draws,
                    pointsDiff
                });
            });
            
            standings.sort((a, b) => {
                if (b.points !== a.points) return b.points - a.points;
                return b.pointsDiff - a.pointsDiff;
            });
            
            const tableHTML = `
                <table class="round-robin-table">
                    <thead>
                        <tr>
                            <th>–ú–µ—Å—Ç–æ</th>
                            <th>–ò–≥—Ä–æ–∫</th>
                            <th>–ú–∞—Ç—á–∏</th>
                            <th>–ü–æ–±–µ–¥—ã</th>
                            <th>–ü–æ—Ä–∞–∂–µ–Ω–∏—è</th>
                            <th>–ù–∏—á—å–∏</th>
                            <th>–û—á–∫–∏</th>
                            <th>+/-</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${standings.map((standing, index) => `
                            <tr>
                                <td>${index + 1}</td>
                                <td class="player-standing">
                                    <img src="${players[standing.player]?.avatar || 'https://i.pravatar.cc/150?img=3'}" 
                                         class="standing-avatar">
                                    ${standing.player}
                                </td>
                                <td>${standing.matches}</td>
                                <td>${standing.wins}</td>
                                <td>${standing.losses}</td>
                                <td>${standing.draws}</td>
                                <td><strong>${standing.points}</strong></td>
                                <td>${standing.pointsDiff > 0 ? '+' : ''}${standing.pointsDiff}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
            
            document.getElementById('roundRobinTable').innerHTML = tableHTML;
            
            if (matches.length >= 3) {
                const finalists = standings.slice(0, 2).map(s => s.player);
                bracketContainer.innerHTML = `
                    <h3 class="round-title">üèÜ –§–∏–Ω–∞–ª</h3>
                    <div class="bracket-match">
                        <div class="match-player ${currentTournament.winner === finalists[0] ? 'winner' : ''}">
                            <img src="${players[finalists[0]]?.avatar || 'https://i.pravatar.cc/150?img=3'}" 
                                 style="width: 30px; height: 30px; border-radius: 50%;">
                            ${finalists[0]}
                        </div>
                        <div style="text-align: center; padding: 10px; font-weight: bold;">VS</div>
                        <div class="match-player ${currentTournament.winner === finalists[1] ? 'winner' : ''}">
                            <img src="${players[finalists[1]]?.avatar || 'https://i.pravatar.cc/150?img=3'}" 
                                 style="width: 30px; height: 30px; border-radius: 50%;">
                            ${finalists[1]}
                        </div>
                        ${currentTournament.winner ? `
                            <div style="text-align: center; margin-top: 10px; color: #4CAF50; font-weight: bold;">
                                üèÜ –ü–æ–±–µ–¥–∏—Ç–µ–ª—å: ${currentTournament.winner}
                            </div>
                        ` : ''}
                    </div>
                `;
            }
            
        } else {
            document.getElementById('roundRobinSection').style.display = 'none';
            bracketContainer.innerHTML = createTournamentBracket(matches);
        }
    }
    
    function createTournamentBracket(matches) {
        const rounds = {};
        matches.forEach(match => {
            if (!rounds[match.round]) rounds[match.round] = [];
            rounds[match.round].push(match);
        });
        
        let bracketHTML = '<div class="tournament-bracket">';
        
        Object.keys(rounds).forEach(roundName => {
            bracketHTML += `
                <div class="bracket-round">
                    <h4 class="round-title">${getRoundName(roundName)}</h4>
                    ${rounds[roundName].map(match => `
                        <div class="bracket-match">
                            <div class="match-player ${match.winner === match.player1 ? 'winner' : ''}">
                                ${match.player1}
                                ${match.score ? `<span style="float: right;">${getPlayerScore(match.score, 1)}</span>` : ''}
                            </div>
                            <div class="match-player ${match.winner === match.player2 ? 'winner' : ''}">
                                ${match.player2}
                                ${match.score ? `<span style="float: right;">${getPlayerScore(match.score, 2)}</span>` : ''}
                            </div>
                            ${isAdmin && !match.winner ? `
                                <div style="margin-top: 10px;">
                                    <input type="text" class="match-score-input" placeholder="3:2" id="score_${match.id}">
                                    <button class="save-match-btn" onclick="saveMatchResult('${match.id}')">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                                </div>
                            ` : ''}
                        </div>
                    `).join('')}
                </div>
            `;
        });
        
        bracketHTML += '</div>';
        return bracketHTML;
    }
    
    function getRoundName(round) {
        const roundNames = {
            'final': 'üèÜ –§–∏–Ω–∞–ª',
            'semifinal': 'ü•à –ü–æ–ª—É—Ñ–∏–Ω–∞–ª',
            'quarterfinal': 'ü•â –ß–µ—Ç–≤–µ—Ä—Ç—å—Ñ–∏–Ω–∞–ª',
            'qualifying': 'üéØ –ö–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è',
            'group': 'üîÅ –ì—Ä—É–ø–ø–æ–≤–æ–π —ç—Ç–∞–ø'
        };
        return roundNames[round] || round;
    }
    
    function getPlayerScore(score, playerNumber) {
        if (!score) return '';
        const scores = score.split(':');
        return scores[playerNumber - 1];
    }
    
    // ============================================
    // –£–ü–†–ê–í–õ–ï–ù–ò–ï –¢–£–†–ù–ò–†–û–ú
    // ============================================
    
    function returnToMainFromTournament() {
        document.getElementById('appContainer').style.display = 'block';
        document.getElementById('tournamentContainer').style.display = 'none';
        currentTournament = null;
        window.scrollTo(0, 0);
    }
    
    async function addTournamentMatch() {
        if (!isAdmin || !currentTournament) return;
        
        const player1 = prompt('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–µ—Ä–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞:');
        const player2 = prompt('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –≤—Ç–æ—Ä–æ–≥–æ –∏–≥—Ä–æ–∫–∞:');
        const round = prompt('–í–≤–µ–¥–∏—Ç–µ —Ä–∞—É–Ω–¥ (final, semifinal, group –∏ —Ç.–¥.):', 'group');
        
        if (!player1 || !player2 || !round) return;
        
        if (!players[player1] || !players[player2]) {
            showNotification('–û–¥–∏–Ω –∏–∑ –∏–≥—Ä–æ–∫–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
            return;
        }
        
        try {
            const { error } = await supabaseClient
                .from('tournament_matches')
                .insert({
                    tournament_id: currentTournament.id,
                    player1,
                    player2,
                    round,
                    status: 'scheduled',
                    date: new Date().toISOString()
                });
            
            if (error) throw error;
            
            await loadTournamentDetails(currentTournament.id);
            showNotification('‚úÖ –ú–∞—Ç—á –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Ç—É—Ä–Ω–∏—Ä!', 'success');
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–∞—Ç—á–∞:', error);
            showNotification('‚ùå –û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–∞—Ç—á–∞', 'error');
        }
    }
    
    async function saveMatchResult(matchId) {
        if (!isAdmin) return;
        
        const scoreInput = document.getElementById(`score_${matchId}`);
        if (!scoreInput) return;
        
        const score = scoreInput.value.trim();
        if (!score || !score.includes(':')) {
            showNotification('–í–≤–µ–¥–∏—Ç–µ —Å—á–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ 3:2', 'error');
            return;
        }
        
        const [score1, score2] = score.split(':').map(Number);
        if (isNaN(score1) || isNaN(score2)) {
            showNotification('–°—á–µ—Ç –¥–æ–ª–∂–µ–Ω —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ —á–∏—Å–µ–ª!', 'error');
            return;
        }
        
        let winner;
        if (score1 > score2) {
            const match = await getTournamentMatch(matchId);
            winner = match?.player1;
        } else if (score2 > score1) {
            const match = await getTournamentMatch(matchId);
            winner = match?.player2;
        } else {
            winner = 'draw';
        }
        
        try {
            const { error } = await supabaseClient
                .from('tournament_matches')
                .update({
                    score,
                    winner,
                    status: 'completed',
                    updated_at: new Date().toISOString()
                })
                .eq('id', matchId);
            
            if (error) throw error;
            
            const match = await getTournamentMatch(matchId);
            if (match && match.round === 'final' && winner && winner !== 'draw') {
                await supabaseClient
                    .from('tournaments')
                    .update({
                        winner,
                        status: 'completed',
                        updated_at: new Date().toISOString()
                    })
                    .eq('id', currentTournament.id);
            }
            
            await loadTournamentDetails(currentTournament.id);
            showNotification('‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç –º–∞—Ç—á–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω!', 'success');
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:', error);
            showNotification('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞', 'error');
        }
    }
    
    async function getTournamentMatch(matchId) {
        const { data } = await supabaseClient
            .from('tournament_matches')
            .select('*')
            .eq('id', matchId)
            .single();
        return data;
    }
    
    async function simulateTournament() {
        if (!isAdmin || !currentTournament) return;
        
        if (!confirm('–ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏–º—É–ª—è—Ü–∏—é —Ç—É—Ä–Ω–∏—Ä–∞? –ë—É–¥—É—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—Å–µ—Ö –º–∞—Ç—á–µ–π.')) {
            return;
        }
        
        showNotification('üéÆ –°–∏–º—É–ª—è—Ü–∏—è —Ç—É—Ä–Ω–∏—Ä–∞...', 'info');
        
        try {
            const { data: matches } = await supabaseClient
                .from('tournament_matches')
                .select('*')
                .eq('tournament_id', currentTournament.id);
            
            for (const match of matches) {
                if (match.status !== 'completed') {
                    const score1 = Math.floor(Math.random() * 3) + 1;
                    const score2 = Math.floor(Math.random() * 3);
                    const score = `${score1}:${score2}`;
                    const winner = score1 > score2 ? match.player1 : match.player2;
                    
                    await supabaseClient
                        .from('tournament_matches')
                        .update({
                            score,
                            winner,
                            status: 'completed'
                        })
                        .eq('id', match.id);
                }
            }
            
            await loadTournamentDetails(currentTournament.id);
            showNotification('‚úÖ –¢—É—Ä–Ω–∏—Ä —Å–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω!', 'success');
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ —Å–∏–º—É–ª—è—Ü–∏–∏:', error);
            showNotification('‚ùå –û—à–∏–±–∫–∞ —Å–∏–º—É–ª—è—Ü–∏–∏ —Ç—É—Ä–Ω–∏—Ä–∞', 'error');
        }
    }
    
    function editTournament() {
        if (!isAdmin || !currentTournament) return;
        
        const newName = prompt('–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞:', currentTournament.name);
        if (!newName) return;
        
        const newDescription = prompt('–ù–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ:', currentTournament.description || '');
        
        updateTournamentInfo(newName, newDescription);
    }
    
    async function updateTournamentInfo(name, description) {
        try {
            await supabaseClient
                .from('tournaments')
                .update({
                    name,
                    description,
                    updated_at: new Date().toISOString()
                })
                .eq('id', currentTournament.id);
            
            currentTournament.name = name;
            currentTournament.description = description;
            
            document.getElementById('tournamentName').textContent = name;
            showNotification('‚úÖ –¢—É—Ä–Ω–∏—Ä –æ–±–Ω–æ–≤–ª–µ–Ω!', 'success');
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–∞:', error);
            showNotification('‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–∞', 'error');
        }
    }
    
    async function deleteTournament() {
        if (!isAdmin || !currentTournament) return;
        
        if (!confirm(`–£–¥–∞–ª–∏—Ç—å —Ç—É—Ä–Ω–∏—Ä "${currentTournament.name}"? –í—Å–µ –º–∞—Ç—á–∏ –∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —Ç–∞–∫–∂–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.`)) {
            return;
        }
        
        try {
            await supabaseClient
                .from('tournament_photos')
                .delete()
                .eq('tournament_id', currentTournament.id);
            
            await supabaseClient
                .from('tournament_matches')
                .delete()
                .eq('tournament_id', currentTournament.id);
            
            await supabaseClient
                .from('tournaments')
                .delete()
                .eq('id', currentTournament.id);
            
            await loadAllData();
            returnToMainFromTournament();
            
            showNotification(`‚úÖ –¢—É—Ä–Ω–∏—Ä "${currentTournament.name}" —É–¥–∞–ª–µ–Ω!`, 'success');
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–∞:', error);
            showNotification('‚ùå –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–∞', 'error');
        }
    }
    
    // ============================================
    // –ó–ê–ì–†–£–ó–ö–ê –§–û–¢–û–ì–†–ê–§–ò–ô
    // ============================================
    
    async function uploadTournamentPhotos(files) {
        if (!isAdmin || !currentTournament) {
            showNotification('–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏!', 'error');
            return;
        }
        
        if (files.length === 0) return;
        
        showNotification('–í –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ', 'info');
        
        // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∫–æ–¥ –∑–∞–≥—Ä—É–∑–∫–∏ –≤ Supabase Storage
        // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞–∫ data URL
        
        const uploadPromises = [];
        const filesToUpload = Array.from(files).slice(0, 5);
        
        for (const file of filesToUpload) {
            if (file.size > 5 * 1024 * 1024) {
                showNotification(`–§–∞–π–ª ${file.name} —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π (–º–∞–∫—Å. 5MB)`, 'error');
                continue;
            }
            
            const reader = new FileReader();
            const promise = new Promise((resolve) => {
                reader.onload = function(e) {
                    // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–∞–≥—Ä—É–∂–∞–µ–º –≤ Supabase Storage
                    // const fileName = `${currentTournament.id}/${Date.now()}_${file.name}`;
                    // const { data, error } = await supabaseClient.storage
                    //     .from('tournament-photos')
                    //     .upload(fileName, file);
                    
                    resolve({
                        url: e.target.result,
                        name: file.name
                    });
                };
                reader.readAsDataURL(file);
            });
            
            uploadPromises.push(promise);
        }
        
        const uploadedFiles = await Promise.all(uploadPromises);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        const photosContainer = document.getElementById('uploadedPhotos');
        const existingPhotos = photosContainer.innerHTML;
        
        let newPhotosHTML = '';
        uploadedFiles.forEach(photo => {
            newPhotosHTML += `
                <div class="uploaded-photo">
                    <img src="${photo.url}" class="tournament-photo" onclick="openPhotoModal('${photo.url}')">
                    <button class="delete-photo-btn" onclick="this.parentElement.remove()">√ó</button>
                </div>
            `;
        });
        
        photosContainer.innerHTML = newPhotosHTML + existingPhotos;
        
        showNotification(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${uploadedFiles.length} —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π!`, 'success');
    }
    
    async function deleteTournamentPhoto(photoId) {
        if (!isAdmin) return;
        
        if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é?')) return;
        
        try {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —É–¥–∞–ª—è–µ–º –∏–∑ Supabase Storage –∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
            // await supabaseClient.storage
            //     .from('tournament-photos')
            //     .remove([fileName]);
            // 
            // await supabaseClient
            //     .from('tournament_photos')
            //     .delete()
            //     .eq('id', photoId);
            
            // –î–ª—è –¥–µ–º–æ –ø—Ä–æ—Å—Ç–æ —É–¥–∞–ª—è–µ–º –∏–∑ DOM
            const photoElement = document.querySelector(`[data-photo-id="${photoId}"]`);
            if (photoElement) {
                photoElement.remove();
            }
            
            showNotification('‚úÖ –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è —É–¥–∞–ª–µ–Ω–∞!', 'success');
            
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏:', error);
            showNotification('‚ùå –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏', 'error');
        }
    }
    
    function openPhotoModal(photoUrl) {
        const modal = document.createElement('div');
        modal.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            padding: 20px;
        `;
        
        modal.innerHTML = `
            <img src="${photoUrl}" style="max-width: 100%; max-height: 100%; object-fit: contain;">
            <button onclick="this.parentElement.remove()" style="
                position: absolute;
                top: 20px;
                right: 20px;
                background: none;
                border: none;
                color: white;
                font-size: 2em;
                cursor: pointer;
            ">√ó</button>
        `;
        
        document.body.appendChild(modal);
    }
    
    // ============================================
    // –û–°–¢–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò (–°–£–©–ï–°–¢–í–£–Æ–©–ò–ï)
    // ============================================
    
    // –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ –≤–∞—à–µ–≥–æ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞:
    // updateRatingTable, updateMatchesTable, updatePlayersTable, updatePenaltiesHistory,
    // addMatch, saveManualRatings, applyManualPenalty, checkAndApplyPenalties,
    // addPlayer, removePlayer, deleteMatch, changeAvatar, updatePlayerSelects,
    // updatePeriodStats, getActiveMonths, updateTopYearPlayers, updateYearProgressChart,
    // comparePlayers, showNotification, setMatchDateToToday, openTab, updateAllDisplays,
    // updateSupabaseStatus, updateSupabaseTime, savePlayerToSupabase, saveMatchToSupabase,
    // savePenaltyToSupabase, deleteMatchFromSupabase, showPlayerProfile, returnToMain,
    // getAchievementEmojis, updatePlayerStats, updatePlayerAchievements, renderPlayerFormChart,
    // getPlayerAchievements, getAllAchievements, applyAchievementBonuses, updateAchievementsDisplay
    
    // –Ø –Ω–µ –∫–æ–ø–∏—Ä—É—é –∏—Ö –≤—Å–µ –∑–¥–µ—Å—å –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ç–∏, –Ω–æ –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –≤–∞—à–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º –∫–æ–¥–µ
    
    // ============================================
    // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
    // ============================================
    
    async function init() {
        console.log('üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
        
        checkAutoLogin();
        setMatchDateToToday();
        await initSupabase();
        updatePlayerSelects();
        
        console.log('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ');
    }
    
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
    } else {
        init();
    }
    </script>
</body>
</html>
